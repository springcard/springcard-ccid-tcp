2014-06-11  Ludovic Rousseau

	* [r6915] README, configure.ac: Release 1.4.17

2014-06-03  Ludovic Rousseau

	* [r6908] readers/GemProxDU.txt: Update firmware from 1.04 to 1.08
	  
	  Update tool is available at
	  http://support.gemalto.com/index.php?id=prox-du_prox-su

2014-05-31  Ludovic Rousseau

	* [r6904] readers/Feitian_R502.txt, readers/supported_readers.txt:
	  Add Feitian R502

2014-05-23  Ludovic Rousseau

	* [r6902] readers/supported_readers.txt, readers/udea_MILKO_V1.txt:
	  Add udea MILKO V1.

2014-05-14  Ludovic Rousseau

	* [r6901] readers/Free_Software_Initiative_of_Japan_Gnuk_Token.txt,
	  readers/supported_readers.txt: Add Free Software Initiative of
	  Japan Gnuk Token
	* [r6900] readers/German_Privacy_Foundation_Crypto_Stick_v2.0.txt,
	  readers/supported_readers.txt: Add German Privacy Foundation
	  Crypto Stick v2.0

2014-05-07  Ludovic Rousseau

	* [r6899]
	  readers/Identive_Technologies_Multi-ISO_HF_Reader_USB.txt,
	  readers/supported_readers.txt: Add Identive Technologies
	  Multi-ISO HF Reader - USB

2014-05-03  Ludovic Rousseau

	* [r6897] readers/OMNIKEY_5421.txt, readers/supported_readers.txt:
	  Add OMNIKEY 5421
	* [r6896] readers/OMNIKEY_AG_3121.txt,
	  readers/supported_readers.txt: Add OMNIKEY AG 3121 USB
	* [r6894] readers/HID_OMNIKEY_5025-CL.txt,
	  readers/supported_readers.txt: Add HID OMNIKEY 5025-CL

2014-04-24  Ludovic Rousseau

	* [r6892] readers/HID_Global_veriCLASS_Reader.txt,
	  readers/supported_readers.txt: Add HID Global veriCLASS Reader
	* [r6890] src/ccid_usb.c: OpenUSBByName(): add a 100 ms delay on
	  Mac OS X
	  
	  The USB device may be detected by the Mac OS X USB layer (used by
	  pcscd) but not yet by libusb (used by libccid).
	  
	  We must give some time (100 ms) before listing the USB devices
	  seen by libusb. Noticed on OS X Mavericks using libusb 1.0.18.
	* [r6889] src/ccid_usb.c: OpenUSBByName(): log an error if the USB
	  device is not found
	  
	  If we exit the function without finding the (new) device then we
	  log an error ""Device not found?".
	  
	  This could happen if the device is found by Mac OS X USB layer
	  but not yet by libusb. Noticed on OS X Mavericks using libusb
	  1.0.18.

2014-04-11  Ludovic Rousseau

	* [r6885] src/ccid.c: The O2 Micro Oz776 reader only supports 9600
	  bps
	  
	  The reader returns bNumDataRatesSupported: 0 and a list with only
	  1 value: 9600 bps. bNumDataRatesSupported: 0 should indicate that
	  all the speeds between dwDataRate: 9600 bps and dwMaxDataRate:
	  307200 bps are available. But it looks like this is not the case.
	  
	  The driver behavior changed with revision 6801 "Do not get the
	  data rates if bNumDataRatesSupported = 0".
	  
	  This patch just set dwMaxDataRate to 9600 so only this speed is
	  used. The O2 Micro Oz776 reader was already in the unsupported
	  list.

2014-03-23  Ludovic Rousseau

	* [r6880] README, configure.ac: Release 1.4.16
	* [r6879] src/commands.c: Fix compiler warning
	  
	  commands.c: In function `SecurePINVerify': commands.c:529:9:
	  warning: variable `n' set but not used
	  [-Wunused-but-set-variable] int n, oldReadTimeout; ^
	* [r6878] src/commands.c: Fix compiler warning
	  
	  commands.c:511:19: warning: | has lower precedence than ==; ==
	  will be evaluated first [-Wparentheses] if (T1_S_BLOCK | T1_S_WTX
	  == RxBuffer[PCB]) ^~~~~~~~~~~~~~~~~~~~~~~~~~~ commands.c:511:19:
	  note: place parentheses around the '==' expression to silence
	  this warning if (T1_S_BLOCK | T1_S_WTX == RxBuffer[PCB]) ^
	  ~~~~~~~~~~~~~~~~~~~~~~~~~ commands.c:511:19: note: place
	  parentheses around the | expression to evaluate it first if
	  (T1_S_BLOCK | T1_S_WTX == RxBuffer[PCB]) ~~~~~~~~~~~^~~~~~~~~~ 1
	  warning generated.
	* [r6877] src/commands.c: SecurePINVerify: add support of WTX
	  received before SW
	  
	  The Swiss health care card sends a WTX request before returning
	  the SW code. If the reader is in TPDU and the card is in T=1 the
	  driver must manage the request itself.
	* [r6876] src/ccid_ifdhandler.h: Add
	  DRIVER_OPTION_DISABLE_PIN_RETRIES definition
	  
	  This is a missing for revision 6875

2014-03-22  Ludovic Rousseau

	* [r6875] src/Info.plist.src, src/ccid.c: Add support of
	  DRIVER_OPTION_DISABLE_PIN_RETRIES
	  
	  The Gemalto pinpad reader sends a VERIFY command with no PIN
	  value in order to retreive the remaining retries from the card.
	  Some cards (like the OpenPGP card) do not support this.
	  
	  It is now possible to disable this behavior from the Gemalto
	  Pinpad and Covadis Véga Alpha.
	  
	  Closes Alioth bug
	  https://alioth.debian.org/tracker/index.php?func=detail&aid=314005&group_id=30105&atid=410088
	* [r6874] src/ccid_usb.c: InterruptRead(): log the libusb errors
	  
	  Allow an easier debug

2014-03-11  Ludovic Rousseau

	* [r6873] readers/IID_AT90S064_CCID_READER.txt,
	  readers/supported_readers.txt: Add IID AT90S064 CCID READER

2014-03-09  Ludovic Rousseau

	* [r6871] readers/Watchdata_W5181.txt,
	  readers/supported_readers.txt: Add Watchdata W5181

2014-03-08  Ludovic Rousseau

	* [r6869] src/openct/proto-t1.c: t1_transceive(): add a new test on
	  retries
	  
	  The driver should not send R-blocks infinitely.
	  
	  The problem was detected by a T=1 card on a TPDU pinpad reader
	  with a VERIFY command that send a WTX request before returning
	  the SW code.
	* [r6868] src/openct/proto-t1.c: t1_transceive(): check retries is
	  is positive
	  
	  The test was "retries == 0" but it may happen that retries
	  becomes negative. Then the counter will be decreasing
	  "indefinitely".
	  
	  The new test is "retries <= 0" to also get the negative values
	  and resync if needed.
	  
	  The problem was detected by a T=1 card on a TPDU pinpad reader
	  with a VERIFY command that send a WTX request before returning
	  the SW code.

2014-03-07  Ludovic Rousseau

	* [r6866] readers/INSIDE_Secure_VaultIC_441_Smart_Object.txt,
	  readers/supported_readers.txt: Add INSIDE Secure VaultIC 441
	  Smart Object
	* [r6865] readers/INSIDE_Secure_VaultIC_405_Smart_Object.txt,
	  readers/supported_readers.txt: Add INSIDE Secure VaultIC 405
	  Smart Object
	* [r6864] readers/supported_readers.txt: Replace HP by Hewlett
	  Packard

2014-02-26  Ludovic Rousseau

	* [r6862] NEWS: Indicates the changes are in README.

2014-02-23  Ludovic Rousseau

	* [r6860] readers/Chicony_HP_USB_Smartcard_CCID_Keyboard.txt,
	  readers/supported_readers.txt: Add HP USB Smartcard CCID Keyboard

2014-02-18  Ludovic Rousseau

	* [r6857] readers/Microchip_SEC1210.txt,
	  readers/supported_readers.txt: Add Microchip SEC1210
	* [r6856] readers/Microchip_SEC1110.txt,
	  readers/supported_readers.txt: Add Microchip SEC1110
	* [r6855] readers/Crypto_Stick_Crypto_Stick_v1.4.txt,
	  readers/supported_readers.txt: Add Crypto Stick Crypto Stick v1.4

2014-02-14  Ludovic Rousseau

	* [r6846] README, configure.ac: Release 1.4.15
	* [r6845] src/ccid.c, src/ccid.h: Disable pinpad for Fujitsu
	  SmartCase KB SCR eSIG
	  
	  Thanks to Maarten for the bug report and patch.

2014-02-08  Ludovic Rousseau

	* [r6839] readers/Feitian_bR301.txt, readers/supported_readers.txt:
	  Add Feitian bR301

2014-02-03  Ludovic Rousseau

	* [r6835] readers/Gemalto_Ezio_Shield_Pro_SC.txt,
	  readers/supported_readers.txt: Add Gemalto Ezio Shield Pro SC

2014-01-28  Ludovic Rousseau

	* [r6833] src/reader.conf.in: Remove the optional CHANNELID
	  
	  Use DEVICENAME only instead.
	* [r6832] src/ccid.h, src/ccid_serial.c, src/reader.conf.in: Add
	  support of Gemalto CR30 reader in serial communication
	  
	  The Gemalto CR30 reader is a dual slot reader. The reader can be
	  connected with a USB cable (normal CCID protocol) or using a
	  serial cable.
	  
	  The serial configuration is made using a special name in
	  /etc/reader.conf DEVICENAME field like: DEVICENAME
	  /dev/ttyS0:GemCoreSIMPro2
	* [r6831] src/ccid_serial.c: set_ccid_descriptor(): initialize
	  .ccid.readTimeout
	  
	  The read timeout was not initialized. I don't know how it was
	  working.

2014-01-21  Ludovic Rousseau

	* [r6829] readers/Vasco_DIGIPASS_870.txt,
	  readers/supported_readers.txt: Add VASCO DIGIPASS 870
	* [r6828] src/ccid_usb.c: get_end_points(): be more strict for
	  bInterfaceClass = 255
	  
	  If the bInterfaceClass is 255 (proprietary) and then not, but
	  possibly, a CCID interface (on an old reader) we also check the
	  extra_length is valid for a CCID device.
	  
	  The problem was with a composite device with 2 interfaces: one
	  non-CCID interface with bInterfaceClass = 255 and a CCID
	  interface with bInterfaceClass = 11. The first non-CCID interface
	  must be skipped.
	* [r6827] readers/Aladdin_eToken_PRO_USB_72K_Java.txt: Small update

2014-01-07  Ludovic Rousseau

	* [r6820] src/ccid.c: ccid_open_hack_post(): use default read
	  timeout for CmdEscape
	  
	  Use the default read timeout (DEFAULT_COM_READ_TIMEOUT at 3
	  seconds) instead of the current value of 100 ms (set in
	  CreateChannelByNameOrChannel) that is too short to load the l10n
	  strings in a pinpad reader.
	* [r6819] src/ifdhandler.c: Support Gemalto features for pinpad
	  readers
	  
	  MinimumPINSize, MaximumPINSize and bEntryValidationCondition are
	  fetched from the reader firmware. No need to hardcode specific
	  values anymore.
	* [r6818] examples/scardcontrol.c: Fix typo in text
	* [r6817] src/ifdhandler.c: Set specific value of
	  bEntryValidationCondition for known readers
	  
	  Gemalto Pinpad, Covadis Véga-Alpha and Cherry ST2000 readers only
	  support validation by key pressed.
	* [r6816] examples/scardcontrol.c: Retrieve
	  bEntryValidationCondition from the driver
	  
	  Use PCSCv2_PART10_PROPERTY_bEntryValidationCondition to know what
	  validation conditions aer supported by the pinpad.
	  
	  Default value is 7 (as before).
	* [r6815] examples/scardcontrol.c: Check value returned by gets(3)
	  
	  Fix compiler warning: scardcontrol.c:649:4: warning: ignoring
	  return value of ‘fgets’, declared with attribute
	  warn_unused_result [-Wunused-result]
	* [r6814] examples/scardcontrol.c: Retrieve min and max PIN sizes
	  from the driver
	  
	  Use PCSCv2_PART10_PROPERTY_bMinPINSize and
	  PCSCv2_PART10_PROPERTY_bMaxPINSize to know the min and max PIN
	  sizes.
	  
	  If not defined by the driver the default values are 4 for min and
	  8 for max (as before).
	* [r6813] examples/scardcontrol.c: Do a PIN verify instead of PIN
	  modify

2014-01-06  Ludovic Rousseau

	* [r6812] examples/scardcontrol.c: Parse codes returned by a pinpad
	  (as SW1/SW2).
	  
	  Known codes for now are: 0x9000: Success 0x6400: Timeout 0x6401:
	  Cancelled by user 0x6402: PIN mismatch 0x6403: Too short or too
	  long PIN
	* [r6811] src/ifdhandler.c: Add specific PIN min & max sizes for
	  SmartTerminal ST-2xxx
	  
	  The Cherry GmbH SmartTerminal ST-2xxx reader has a min PIN size
	  of 0 digits and a max PIN size of 25 (0x19) digits.
	  
	  Thanks to Dominik Heidler for the bug report
	  https://github.com/OpenSC/OpenSC/issues/199

2013-12-17  Ludovic Rousseau

	* [r6809] examples/scardcontrol.c: Fix calculation of the command
	  length
	  
	  Since pcsc-lite 1.8.9 (October 2013) the structures
	  PIN_MODIFY_STRUCTURE and PIN_VERIFY_STRUCTURE are different and
	  now use a C99 flexible array member when available for abData
	  field. uint8_t abData[];
	  
	  The the sizeof(PIN_VERIFY_STRUCTURE) is one byte smaller and the
	  calculation of the complete command is now simpler.

2013-12-12  Ludovic Rousseau

	* [r6806] readers/IIT_E.Key_Almaz-1C.txt,
	  readers/supported_readers.txt: Add IIT E.Key Almaz-1C

2013-12-06  Ludovic Rousseau

	* [r6805] readers/DUALi_DRAGON_NFC_READER.txt,
	  readers/supported_readers.txt: Add DUALi DRAGON NFC READER

2013-11-26  Ludovic Rousseau

	* [r6801] src/ccid_usb.c: Do not get the data rates if
	  bNumDataRatesSupported = 0
	  
	  According to CCID spec 1.1: " If the value is 00h, all data rates
	  between the default data rate dwDataRate and the maximum data
	  rate dwMaxDataRate are supported. "
	  
	  Some readers do not support control request 0x03 GET_DATA_RATES
	  if they declare bNumDataRatesSupported = 0. That should not
	  generate a critical error.
	  
	  This change will fix bug [#314516] Do not log
	  ccid_usb.c:1142:ControlUSB() control failed (1/4): -9 Success
	  https://alioth.debian.org/tracker/index.php?func=detail&aid=314516&group_id=30105&atid=410088
	  
	  and also fix bug [#313651] Do not call get_data_rates() if
	  bNumDataRatesSupported is 0
	  https://alioth.debian.org/tracker/index.php?func=detail&aid=313651&group_id=30105&atid=410088
	* [r6800] src/ccid_usb.c: Revert revision 6799
	  
	  We will use a better way to solve the bug.
	* [r6799] src/ccid_usb.c: Failing to get the data rates from the
	  reader is not a critical error
	  
	  The reader may not respond to control request 0x03 GET_DATA_RATES
	  In such a case the CCID driver should not report a critical
	  error.
	  
	  The driver will now report a info level error.o
	  
	  Closes alioth bug [#314516] Do not log
	  ccid_usb.c:1142:ControlUSB() control failed (1/4): -9 Success
	  https://alioth.debian.org/tracker/index.php?func=detail&aid=314516&group_id=30105&atid=410088
	* [r6798] src/debug.h: Add DEBUG_INFO5() macro

2013-11-25  Ludovic Rousseau

	* [r6795] README, configure.ac: Release 1.4.14
	* [r6794] README: Reformat the list of readers in the "add support
	  for" section
	* [r6793] src/ccid_usb.c: Generalize the management of readers with
	  bDeviceClass = 0xFF
	  
	  Some early Gemalto Ezio CB+ readers have bDeviceClass,
	  bDeviceSubClass and bDeviceProtocol set to 0xFF (proprietary)
	  instead of 0x00.
	  
	  So on Mac OS X the reader configuration is not done by the
	  OS/kernel and we do it ourself.
	  
	  The code is no more limited to the GEMALTO_EZIO_CBP
	  (0x08E6/0x34C3) but to any reader with the problem, like the
	  Todos Argos Mini II CCID.
	* [r6792] MacOSX/configure: Set Xcode SDK to version 10.8
	  
	  With Xcode 5.x the minimum SDK version is 10.8 (Mountain Lion)
	  even on Mountain Lion.
	* [r6791] readers/Gemalto_Ezio_Shield_Secure_Channel.txt,
	  readers/supported_readers.txt: Add Gemalto ING Shield Pro SC
	* [r6790] src/ifdhandler.c: IFDHControl(): report
	  FEATURE_IFD_PIN_PROPERTIES only for pinpad readers
	  
	  Some (bogus) applications use the presence of
	  FEATURE_IFD_PIN_PROPERTIES to know if the reader is a pinpad
	  reader or not. The application should use
	  FEATURE_VERIFY_PIN_DIRECT and FEATURE_MODIFY_PIN_DIRECT instead.
	  
	  Reporting FEATURE_IFD_PIN_PROPERTIES for a non-pinpad reader is
	  useless so it should not harm to remove it from
	  CM_IOCTL_GET_FEATURE_REQUEST.

2013-10-24  Ludovic Rousseau

	* [r6784] src/ccid_usb.c, src/ifdhandler.c: Add support of Gemalto
	  GemCore SIM Pro firmware 2.0
	  
	  The new firmware of the Gemalto GemCore SIM Pro removes a
	  limitation of the firmware 1.0. The 2 slots now supports the same
	  data rates. The second slot is no more limited to some values
	  only.
	* [r6783] src/ccid.c, src/ccid_serial.c, src/commands.c,
	  src/commands.h, src/ifdhandler.c: Add a timeout parameter to
	  CmdEscape()
	  
	  Not all commands need the same timeout. For example the
	  CmdEscape() used in ccid_serial.c to check if the reader is alive
	  should have a short timeout. The timeout was forced to 30 seconds
	  inside CmdEscape() so it was not possible to use a different
	  value. The patch fixes this.
	* [r6782] src/ifdhandler.c: Limit GemCore SIM PRO hack to only the
	  specific reader
	  
	  If the ATR fails we should mark the card as absent only for the
	  GemCore SIM PRO. This reader do not manage slot status for the
	  second slot and a corresponding hack is present in function
	  IFDHICCPresence() around line 1713.

2013-10-19  Ludovic Rousseau

	* [r6781]
	  readers/extra_features/Gemalto_Ezio_Shield_PinPad_Martin_features.txt:
	  CT710 parse from Martin Paljak
	  
	  http://archives.neohapsis.com/archives/dev/muscle/2013-q4/0040.html
	  https://sourceforge.net/p/opensc/mailman/message/31538801/

2013-10-18  Ludovic Rousseau

	* [r6776] readers/extra_features/GemPCPinpadv2_features.txt,
	  readers/extra_features/Gemalto_Ezio_Shield_PinPad_features.txt:
	  Add reader name, Pid and Vid
	* [r6774] readers/extra_features,
	  readers/extra_features/GemPCPinpadv2_features.txt,
	  readers/extra_features/Gemalto_Ezio_Shield_PinPad_features.txt,
	  readers/extra_features/README.txt: This directory contains extra
	  information about a reader
	  
	  For example the result of the
	  PCSC/UnitaryTests/FEATURE_CCID_ESC_COMMAND_Gemalto_features.py
	  command on some Gemalto readers.

2013-10-09  Ludovic Rousseau

	* [r6766] README, configure.ac: release 1.4.13

2013-10-02  Ludovic Rousseau

	* [r6762] MacOSX/configure: Simplify the code for a NON generic
	  driver
	  
	  - do not build a class driver (not yet used by pcsc-lite on Mac
	  OS X) using --disable-class
	  
	  - use a specific bundle name to NOT overwrite the official CCID
	  driver using --enable-bundle=ifd-ccid-$BUNDLE_ID.bundle
	  
	  - differentiate each libccid library by the dynamic linker using
	  --prefix=/fake/$BUNDLE_ID
	* [r6761] MacOSX/configure: Document the use of --disable-class

2013-10-01  Ludovic Rousseau

	* [r6760] src/ccid_usb.c, src/debug.c: Use the COUNT_OF macro

2013-09-30  Ludovic Rousseau

	* [r6757] src/ccid_usb.c: Multislot support: do not crash on exit
	  
	  The field multislot_extension should be set to NULL only _after_
	  the multi-slot thread management is stopped. This entry is used
	  by the Multi_PollingProc thread.

2013-09-23  Ludovic Rousseau

	* [r6755] readers/Access_IS_ePassport_Reader.txt,
	  readers/supported_readers.txt: Add Access IS ePassport Reader
	* [r6754] ylwrap: Update from automake 1.14

2013-09-21  Ludovic Rousseau

	* [r6753] src/ifdhandler.c: CreateChannelByNameOrChannel(): reset
	  ccid_descriptor->readTimeout in all cases
	  
	  The value was not restored in the error case. So it was not a
	  bug. But the Coverity tool complained:
	  
	  CID 1090609 (#1 of 1): Failure to restore non-local value
	  (MISSING_RESTORE)20. end_of_scope: Value of non-local
	  "ccid_descriptor->readTimeout" that was saved in "oldReadTimeout"
	  is not restored as it was along other paths.

2013-09-16  Ludovic Rousseau

	* [r6752] src/Makefile.am: Revert change in revision 6735
	  
	  We can't use install-exec-local since we want to overwrite the
	  install rule. We do not want to _add_ files to install
	* [r6751] MacOSX/configure: Display the warning "No Universal
	  Binary build" in red

2013-09-05  Ludovic Rousseau

	* [r6746] configure.ac: Set LIBUSB_* even if the libusb-1.0 version
	  is too old
	  
	  If PKG_CHECK_MODULES(LIBUSB, libusb-1.0 >=
	  $LIBUSB_NEEDED_VERSION,...) fails then LIBUSB_CFLAGS and
	  LIBUSB_LIBS are not set. This is problematic since it just
	  displays a warning. So we recall PKG_CHECK_MODULES(LIBUSB,
	  libusb-1.0) with not version test
	  
	  Problem discovered with Debian GNU/kFreeBSD where libusb-1.0 is
	  at version 1.0.6 (it is not the _real_ libusb).
	  
	  ./configure failed with: [...] checking for LIBUSB... no
	  configure: WARNING: install libusb 1.0.8 or later checking
	  libusb.h usability... yes checking libusb.h presence... yes
	  checking for libusb.h... yes configure: error: libusb not found,
	  use ./configure LIBUSB_LIBS=...

2013-08-24  Ludovic Rousseau

	* [r6740] configure.ac: Use subdir-objects option
	  
	  src/Makefile.am:36: warning: source file 'towitoko/atr.c' is in a
	  subdirectory, src/Makefile.am:36: but option 'subdir-objects' is
	  disabled
	  
	  automake-1.14: warning: possible forward-incompatibility.
	  automake-1.14: At least a source file is in a subdirectory, but
	  the 'subdir-objects' automake-1.14: automake option hasn't been
	  enabled. For now, the corresponding output automake-1.14: object
	  file(s) will be placed in the top-level directory. However,
	  automake-1.14: this behaviour will change in future Automake
	  versions: they will automake-1.14: unconditionally cause object
	  files to be placed in the same subdirectory automake-1.14: of the
	  corresponding sources. automake-1.14: You are advised to start
	  using 'subdir-objects' option throughout your automake-1.14:
	  project, to avoid future incompatibilities.

2013-08-23  Ludovic Rousseau

	* [r6739] src/ifdhandler.c: IFDHControl(): Add support of Windows
	  value for CM_IOCTL_GET_FEATURE_REQUEST
	  
	  Windows uses 0x313520 for SCARD_CTL_CODE(3400) pcsc-lite uses
	  0x42000D48 for SCARD_CTL_CODE(3400)
	  
	  RDP aplications (like rdesktop) will convert SCardControl()
	  commands from a Windows application (so using 0x313520) to
	  pcsc-lite.
	* [r6738] src/commands.c: Silence a "clang --analyze" warning
	  
	  commands.c:1936:12: warning: The right operand of '==' is a
	  garbage value if (0x10 == pcbuffer[0]) ^ ~~~~~~~~~~~
	* [r6737] src/ccid_usb.c: Fix "clang --analyze" warning
	  
	  ccid_usb.c:1095:14: warning: Result of 'calloc' is converted to a
	  pointer of type 'unsigned int', which is incompatible with sizeof
	  operand type 'int' int_array = calloc(n+1, sizeof(int)); ^~~~~~
	  ~~~~~~~~~~~
	  
	  - Change variable name int_array -> uint_array since the type is
	  "unsigned int" - Use sizeof(uint_array[0]) to always get the
	  correct type of a uint_array[] element
	* [r6736] src/Makefile.am: Uninstall libccidtwin in the uninstall
	  rule
	  
	  If libccidtwin is installed in install rule we should also remove
	  it in the uninstall rule
	* [r6735] src/Makefile.am: Use the -local versions for install and
	  uninstall rules
	  
	  autoreconf: running: automake --add-missing --no-force
	  --warnings=all src/Makefile.am:76: warning: user target 'install'
	  defined here ... /usr/share/automake-1.13/am/install.am: ...
	  overrides Automake target 'install' defined here
	  src/Makefile.am:99: warning: user target 'uninstall' defined here
	  ... /usr/share/automake-1.13/am/install.am: ... overrides
	  Automake target 'uninstall' defined here src/Makefile.am:99:
	  consider using uninstall-local instead of uninstall
	  
	  See
	  http://www.gnu.org/software/automake/manual/html_node/Extending.html

2013-08-20  Ludovic Rousseau

	* [r6732] readers/Planeta_RC700-NFC_CCID.txt,
	  readers/supported_readers.txt: Add Planeta RC700-NFC CCID

2013-08-12  Ludovic Rousseau

	* [r6729] README, configure.ac: Release 1.4.12
	* [r6728] readers/SecuTech_Token.txt,
	  readers/supported_readers.txt: Add SecuTech SecuTech Token

2013-08-08  Ludovic Rousseau

	* [r6720] readers/HID_OMNIKEY_5427_CK.txt,
	  readers/supported_readers.txt: Add HID OMNIKEY 5427 CK

2013-08-05  Ludovic Rousseau

	* [r6715] readers/Ingenico_WITEO_badge.txt,
	  readers/Ingenico_WITEO_base.txt, readers/supported_readers.txt:
	  Add Ingenico WITEO USB Smart Card Reader (Base and Badge)
	* [r6714] readers/supported_readers.txt: Regenerate without the
	  duplicates as entries

2013-08-02  Ludovic Rousseau

	* [r6705] readers/Lenovo2.txt, readers/supported_readers.txt: Add
	  Lenovo Lenovo USB Smartcard Keyboard

2013-07-28  Ludovic Rousseau

	* [r6689] readers/HID_OMNIKEY_5326_DFR.txt,
	  readers/supported_readers.txt: Add HID OMNIKEY 5326 DFR

2013-07-06  Ludovic Rousseau

	* [r6688] readers/ACR122U_PICC.txt: Firmware upgrade
	* [r6686] readers/Omnikey_5127_CK.txt,
	  readers/supported_readers.txt: Add HID OMNIKEY 5127 CK

2013-07-05  Ludovic Rousseau

	* [r6685] src/ifdhandler.c: CreateChannelByNameOrChannel():
	  correctly fails if the reader disapears
	  
	  If we get the error IFD_NO_SUCH_DEVICE then we must exit using
	  the error path and not directly with a return. We need to unlock
	  a mutex and free allocated resources.
	  
	  Thanks to coverity.
	* [r6684] src/towitoko/atr.c: ATR_InitFromArray(): avoid a possible
	  buffer overflow
	  
	  Increment the protocol index _before_ checking it is too big.

2013-07-01  Ludovic Rousseau

	* [r6682] src/ccid_usb.c: Code factorisation
	* [r6681] src/ccid_usb.c: CloseUSB(): free
	  arrayOfSupportedDataRates on the last slot close
	  
	  Do free .ccid.arrayOfSupportedDataRates array only when the last
	  slot is closed.
	  
	  Multi-slot readers share the same .ccid.arrayOfSupportedDataRates
	  array.
	  
	  The GEMCOREPOSPRO and GEMCORESIMPRO are an exception and are not
	  correctly managed by this patch (memory may leak).

2013-06-30  Ludovic Rousseau

	* [r6678] src/ccid_usb.c, src/ifdhandler.c: Add support of
	  multi-slot readers
	  
	  Thanks to Johann Dantant for the initial patch
	* [r6677] src/ccid_usb.c: ReadUSB(): check libusb return value for
	  LIBUSB_ERROR_NO_DEVICE
	  
	  Same change as in revision 6676 but for ReadUSB().
	* [r6676] src/ccid_usb.c: WriteUSB(): check return value for
	  LIBUSB_ERROR_NO_DEVICE
	  
	  If the device is removed we check for ENODEV == errno and now
	  also for LIBUSB_ERROR_NO_DEVICE == rv (libusb_bulk_transfer()
	  return value)
	  
	  Only the value returned by libusb_bulk_transfer() should be used
	  in the futur.

2013-06-28  Ludovic Rousseau

	* [r6675] src/ccid_usb.c: close_libusb_if_needed(): Reset ctx value
	  to NULL
	  
	  Make sure libusb_init() will be called for the next reader.
	  
	  This was not a real problem since pcscd will unload the driver
	  when no more reader is using it.
	* [r6674] src/ccid_usb.c: Call libusb_exit() when needed
	  
	  Starting with libusbx 1.0.16 a hotplug thread is created by
	  libusb. We must cleanly stop the thread or bad thing can happen
	  (crash on Mac OS X for exampple)
	* [r6673] configure.ac: Check libusb is at least at version 1.0.8
	  
	  The driver will need to use libusb_exit() for libusbx >= 1.0.16
	  because of the libusb hotplug thread.
	  
	  libusb_exit() was not working correctly in libusb < 1.0.8.
	  
	  So we check the libusb library used will at least provide a
	  working libusb_exit() function.
	* [r6672] configure.ac: Remove libusb-config use
	  
	  libusb-config was provided by libusb-0.1. We do not use this
	  version of the libusb API since version libccid 1.4.0 (August
	  2010)

2013-06-20  Ludovic Rousseau

	* [r6667] MacOSX/configure: Update the bundle name template to
	  include the vendor name
	  
	  The bundle name template is now ifd-ccid-vendor-reader.bundle
	* [r6666] MacOSX/configure: Disable class driver on Mac OS X
	  
	  - we are building for a specific reader - pcsc-lite on Mac OS X
	  do not yet support "class" driver

2013-06-18  Ludovic Rousseau

	* [r6664] configure.ac, src/Makefile.am: Use serialconfdir from
	  pcsc-lite
	  
	  Get the serialconfdir value from pcsc-lite pkg config instead of
	  using $(DESTDIR)/$(sysconfdir)/reader.conf.d/

2013-06-12  Ludovic Rousseau

	* [r6661] ylwrap: Update from automake 1.13
	* [r6659] README, configure.ac: Release 1.4.11

2013-06-11  Ludovic Rousseau

	* [r6658] readers/supported_readers.txt: Move Gemalto IDBridge
	  K3000 from "should work" to "supported"

2013-06-10  Ludovic Rousseau

	* [r6656] readers/supported_readers.txt: Move Gemalto IDBridge CT30
	  from "unsupported" to "should work" list
	* [r6655] readers/supported_readers.txt: Add Gemalto IDBridge K30
	* [r6652] readers/Gemalto_IDBridge_K30.txt: New firmware and new
	  name of the Gemalto USB Shell Token V2
	* [r6651] readers/DellSCRK.txt: New firmware (2.0)
	* [r6650] src/ccid.c, src/ccid.h, src/ccid_serial.c,
	  src/ccid_usb.c: Add Zero Length Packet (ZLP) support for Gemalto
	  IDBridge CT30 and K30
	  
	  The Gemalto IDBridge CT30 and IDBridge K30 readers may send a ZLP
	  after some commands when connected on a USB3 bus. Only the
	  readers with firmware 2.00 have the problem.
	  
	  The solution is to use a short read before every USB write.

2013-06-03  Ludovic Rousseau

	* [r6646] src/debug.c: Reset color after time value
	  
	  Fix a bug introduced in revision 6644.
	* [r6645] src/debug.c: Do not do colorization when not available.
	  
	  Check code was missing in revision 6644.
	* [r6644] src/debug.c: Add colorization of logs
	  
	  This log API is used when pcsc-lite do not provide it i.e. on Mac
	  OS X.
	  
	  The colorization should happen only when the logs are displayed
	  on a terminal and not when sent in a log file. The main use is
	  with the handler_test application.

2013-05-31  Ludovic Rousseau

	* [r6643] src/ccid_usb.c: get_ccid_device_descriptor(): check
	  endpoint[] before access
	  
	  Some non-CCID devices with bInterfaceClass = 0xFF may make the
	  code crash because they do not have endpoints.
	  
	  This may happens using 'parse -p' to parse non CCID devices.
	* [r6641] readers/ACR122U.txt, readers/ACR122U_PICC.txt,
	  readers/ACR38U-CCID.txt, readers/ACS_ACR100.txt,
	  readers/ACS_ACR101.txt, readers/ACS_ACR38_plugin.txt,
	  readers/ACS_AET65.txt, readers/ACS_APG8201.txt,
	  readers/ACS_APG8201_v2.txt, readers/ACS_CryptoMate64.txt,
	  readers/ASEDrive_IIIe_KB.txt, readers/ASE_IIIe.txt,
	  readers/ATMEL_AT90SCR050.txt, readers/ATMEL_AT90SCR100.txt,
	  readers/ATMEL_AT91SC192192CT-USB.txt, readers/ATMEL_AT91SO.txt,
	  readers/ATMEL_AT98SC032CT.txt, readers/ATMEL_VaultIC420.txt,
	  readers/ATMEL_VaultIC440.txt, readers/ATMEL_VaultIC460.txt,
	  readers/AU9520.txt, readers/AU9540.txt, readers/ActivCardV2.txt,
	  readers/ActivCardV3.txt, readers/ActivkeySim.txt,
	  readers/Akasa_AK-CR-03.txt, readers/Aktiv_Rutoken_ECP.txt,
	  readers/Aktiv_Rutoken_Lite.txt,
	  readers/Aktiv_Rutoken_Magistra.txt,
	  readers/Aladdin_eToken_PRO_USB_72K_Java.txt,
	  readers/AlcorMicro_AU9522.txt, readers/Alcor_SCR001.txt,
	  readers/Alya.txt, readers/Ask_CPL108.txt,
	  readers/Athena_IDProtect_Key.txt,
	  readers/Avtor_SC_Reader_371.txt, readers/Avtor_SecureToken.txt,
	  readers/AxaltoV3.txt, readers/BIFIT_USB-Token_iBank2key.txt,
	  readers/BIFIT_iBank2key.txt, readers/BZH_uKeyCI800-K1.txt,
	  readers/BludriveII.txt, readers/Broadcom_5880.txt,
	  readers/Broadcom_5880v2.txt, readers/Broadcom_5880v3.txt,
	  readers/Broadcom_5880v4.txt, readers/C3PO_KBR36.txt,
	  readers/C3PO_LTC32_USBv2.txt, readers/C3PO_TLTC2USB.txt,
	  readers/CCB_eSafeLD.txt, readers/CardMan1021.txt,
	  readers/CardMan3021.txt, readers/CardMan3121.txt,
	  readers/CardMan3621.txt, readers/CardMan3821.txt,
	  readers/CardMan4321.txt, readers/CardMan5121.txt,
	  readers/CardMan5125.txt, readers/CardMan5321.txt,
	  readers/CardMan6121.txt, readers/Charismathics.txt,
	  readers/CherryST1044U.txt, readers/CherrySmartBoardXX1X.txt,
	  readers/CherrySmartTerminalST2XXX.txt,
	  readers/CherrySmartTerminalXX1X.txt,
	  readers/CherrySmartTerminalXX7X.txt, readers/CherryXX33.txt,
	  readers/CherryXX44.txt, readers/Covadis_Auriga.txt,
	  readers/CryptoIdentity.txt, readers/Dectel_CI692.txt,
	  readers/DellSCRK.txt, readers/DellSK-3106.txt,
	  readers/Eutron_CryptoIdentity.txt,
	  readers/Eutron_Digipass_860.txt,
	  readers/Eutron_SIM_Pocket_Combo_(Card_Reader).txt,
	  readers/Eutron_SIM_Pocket_Combo_(SIM_Reader).txt,
	  readers/Eutron_Smart_Pocket.txt, readers/Feitian_SCR301.txt,
	  readers/Feitian_SCR310.txt, readers/Feitian_ePass2003_PKI.txt,
	  readers/Fsij_gnuk.txt,
	  readers/FujitsuSiemens_SmartCard_Keyboard_USB_2A.txt,
	  readers/FujitsuSiemens_SmartCard_USB_2A.txt,
	  readers/FujitsuTechnologySolutions_SmartCase_KB_SCR_eSIG.txt,
	  readers/GIS_SmartMouse.txt, readers/GPFCryptoStick.txt,
	  readers/GemCorePOSPro.txt, readers/GemCoreSIMPro.txt,
	  readers/GemPC433_SL.txt, readers/GemPCKey.txt,
	  readers/GemPCPinpad.txt, readers/GemPCPinpadv2.txt,
	  readers/GemPCTwin.txt, readers/GemPC_Express.txt,
	  readers/GemProxDU.txt, readers/GemProxSU.txt,
	  readers/Gem_e-SealPro.txt,
	  readers/GemaltoSmartEnterpriseGuardian.txt,
	  readers/Gemalto_Ezio_Branch.txt, readers/Gemalto_Ezio_CB+.txt,
	  readers/Gemalto_Ezio_Shield.txt,
	  readers/Gemalto_Ezio_Shield_PinPad.txt,
	  readers/Gemalto_HybridSmartcardReader.txt,
	  readers/Gemalto_IDBridge_CT30.txt,
	  readers/Gemalto_IDBridge_K3000.txt, readers/Gemalto_PDT.txt,
	  readers/Gemalto_SA_dotNet_Dual.txt, readers/Gemalto_SG.txt,
	  readers/GnD_StarSignCardToken350.txt,
	  readers/GnD_StarSignCardToken550.txt,
	  readers/GnD_StarSign_CUT.txt, readers/GoldKey_PIV_Token.txt,
	  readers/HPUSBSmartCardKeyboard.txt,
	  readers/HPUSBSmartCardReader.txt,
	  readers/HP_MFP_SmartCardReader.txt, readers/HP_kus-0133.txt,
	  readers/Identive_CLOUD_2700_F.txt,
	  readers/Identive_CLOUD_2700_R.txt,
	  readers/Identive_CLOUD_4500_F.txt,
	  readers/Identive_CLOUD_4510_F.txt,
	  readers/Identive_CLOUD_4700_F.txt,
	  readers/Identive_CLOUD_4710_F.txt,
	  readers/Inside_Secure_AT90SCR050.txt,
	  readers/Inside_Secure_AT90SCR100.txt,
	  readers/Inside_Secure_AT90SCR200.txt,
	  readers/Inside_Secure_VaultIC_420.txt,
	  readers/Inside_Secure_VaultIC_440.txt,
	  readers/Inside_Secure_VaultIC_460_Smart_Object.txt,
	  readers/JCOP41V221.txt, readers/KAAN_Advanced.txt,
	  readers/KAAN_Base.txt, readers/KAAN_SIM_III.txt,
	  readers/KEBTechnology_KONA_USB_SmartCard.txt,
	  readers/Kingtrust_Multi-Reader.txt, readers/Kobil_EMV_CAP.txt,
	  readers/Kobil_IDToken.txt, readers/Kobil_Smart_Token.txt,
	  readers/Kobil_mIDentity_4smart.txt,
	  readers/Kobil_mIDentity_4smart_AES.txt,
	  readers/Kobil_mIDentity_fullsize.txt,
	  readers/Kobil_mIDentity_fullsize_AES.txt,
	  readers/Kobil_mIDentity_visual.txt, readers/LTC31.txt,
	  readers/LTC31v2.txt, readers/LTC36.txt, readers/Lenovo.txt,
	  readers/MSI_StarReader_SMART.txt,
	  readers/MX5_SMART_CCID_DRIVER.txt,
	  readers/Macally_NFC_CCID_eNetPad.txt, readers/Morpho_MSO1350.txt,
	  readers/Morpho_MSO350.txt, readers/MySmartPad.txt,
	  readers/NXP_PR533.txt, readers/Neowave_Weneo.txt,
	  readers/Neowave_Weneo2.txt, readers/Neowave_Weneo3.txt,
	  readers/Neowave_Weneo4.txt, readers/Oberthur-CosmoCard.txt,
	  readers/Oberthur-CosmoCard1.txt,
	  readers/Oberthur-ID-ONE_token_slim_v2.txt,
	  readers/Omnikey_6321.txt, readers/Omnikey_noname1.txt,
	  readers/Oz776S.txt, readers/Oz776_7772.txt,
	  readers/Panasonic_USB_Smart_Card_Reader_7A-Smart.txt,
	  readers/Philips_SmartMX.txt, readers/Precise_200_MC.txt,
	  readers/Precise_250_MC.txt, readers/Precise_Sense_MC.txt,
	  readers/Raritan_D2CIM-DVUSB.txt, readers/ReinerSCT.txt,
	  readers/ReinerSCT_cyberJack_RFID_basis.txt,
	  readers/ReinerSCT_cyberJack_go.txt,
	  readers/Rutoken_PINPad_ex.txt, readers/Rutoken_PINPad_in.txt,
	  readers/SCL010.txt, readers/SCL01x.txt, readers/SCM_SCL010.txt,
	  readers/SCM_SCL011.txt, readers/SCM_SDI011.txt,
	  readers/SCM_SDI011_512C.txt, readers/SCR331-DI-NTTCom.txt,
	  readers/SCR331-DI.txt, readers/SCR331.txt,
	  readers/SCR3310-NTTCom.txt, readers/SCR3310.txt,
	  readers/SCR3310_2.txt, readers/SCR3311.txt, readers/SCR3320.txt,
	  readers/SCR333.txt, readers/SCR3340.txt, readers/SCR335.txt,
	  readers/SCR3500.txt, readers/SCR355.txt, readers/SDI010.txt,
	  readers/SDS4ID_DominoKeyPro_100.txt, readers/SPR532.txt,
	  readers/SafeTech_SafeTouch.txt, readers/Sitecom_MD-010.txt,
	  readers/Smart_SBV280.txt, readers/Softforum_XecureHSM.txt,
	  readers/SpringCard_CSB6_Basic.txt,
	  readers/SpringCard_CSB6_Secure.txt,
	  readers/SpringCard_CSB6_Ultimate.txt,
	  readers/SpringCard_CrazyWriter.txt,
	  readers/SpringCard_EasyFinger_Standard.txt,
	  readers/SpringCard_EasyFinger_Ultimate.txt,
	  readers/SpringCard_H512_Series.txt,
	  readers/SpringCard_H663_Series.txt,
	  readers/SpringCard_NFC_Roll.txt,
	  readers/SpringCard_Prox_N_Roll.txt, readers/Synnix_STD200.txt,
	  readers/Teo.txt, readers/Teridian_TSC12xxFV.09.txt,
	  readers/TianYu_CCID_SmartKey.txt,
	  readers/Tianyu_Smart_Card_Reader.txt,
	  readers/Todos_AGM2_CCID.txt, readers/Todos_Cx00.txt,
	  readers/Ubisys_RFID.txt, readers/VMware_Virtual_USB_CCID.txt,
	  readers/Validy_TokenA.txt,
	  readers/Vasco_DIGIPASS_KEY_202_0120.txt,
	  readers/Vasco_DIGIPASS_KEY_202_0122.txt, readers/Vasco_DP200.txt,
	  readers/Vasco_DP855.txt, readers/Vasco_DP860.txt,
	  readers/Vasco_DP865.txt, readers/Vasco_DP905.txt,
	  readers/Vasco_DPKey101.txt, readers/Vasco_DPKey200.txt,
	  readers/Vasco_DPKey860.txt, readers/Vasco_Digipass920.txt,
	  readers/Vega-Alpha.txt,
	  readers/Verisign_secure_storage_token.txt,
	  readers/Verisign_secure_token.txt, readers/Winbond.txt,
	  readers/Xiring_Leov2.txt, readers/Xiring_MyLeo.txt,
	  readers/Xiring_XI-SIGN.txt, readers/Xiring_XI-SIGN_6000.txt,
	  readers/Yubico_Yubikey_neo.txt,
	  readers/Yubico_Yubikey_neo_otp.txt, readers/bit4id_cryptokey.txt,
	  readers/bit4id_iam.txt, readers/bit4id_key4.txt,
	  readers/bit4id_minilector-s.txt, readers/bit4id_minilector.txt,
	  readers/e-gate.txt, readers/iDream.txt, readers/iMONO.txt,
	  readers/id3_CL1356A_HID.txt, readers/id3_CL1356T.txt,
	  readers/id3_CL1356T5.txt, readers/jNet_jToken_s1.txt,
	  readers/mIDentity.txt, readers/mIDentityXL.txt,
	  readers/sid800.txt: Fix typo
	  
	  bClassEnveloppe: -> bClassEnvelope: only one 'p'

2013-05-30  Ludovic Rousseau

	* [r6640] src/ccid_usb.c: Fix typo in comment

2013-05-24  Ludovic Rousseau

	* [r6635] src/ccid_usb.c: CloseUSB(): free the
	  gemalto_firmware_features only on the last slot
	  
	  All the slots of a same reader use the same
	  gemalto_firmware_features structure. We should only free the
	  structure when the last slot is closing.
	* [r6634] src/ccid_usb.c: Replace doubles spaces by tabulations

2013-05-22  Ludovic Rousseau

	* [r6633] src/parse.c: Fix typo in field name
	  
	  bClassEnveloppe -> bClassEnvelope (only 1 'p')

2013-05-17  Ludovic Rousseau

	* [r6632] readers/SCM_SDI011_512C.txt,
	  readers/supported_readers.txt: Add SCM Microsystems Inc. SDI011
	  Contactless Reader
	  
	  This SDI011 has a new idProduct: 0x512C

2013-05-16  Ludovic Rousseau

	* [r6631] src/ccid_usb.c: ReadUSB: Zero Length Packet (ZLP) support
	  
	  The Gemalto IDBridge CT30 and IDBridge K30 readers may send a ZLP
	  after some commands when connected on a USB3 bus

2013-05-15  Ludovic Rousseau

	* [r6630] src/parse.c: Do not exit if a device with class 0xFF is
	  not accessible
	  
	  Maybe the device is NOT a CCID reader and the parsing should
	  continue.
	  
	  Thanks to Jaidev Bhattacharjee for the bug report

2013-05-13  Ludovic Rousseau

	* [r6627] src/parse.c: parse: make the use of -p argument more
	  explicit
	  
	  The error message now displays: "use ./parse -p" (or whatever the
	  program name is)

2013-05-11  Ludovic Rousseau

	* [r6626] readers/SCM_SCL010.txt, readers/supported_readers.txt,
	  src/ccid_usb.c: Add SCM Microsystems Inc. SCL010 Contactless
	  Reader
	  
	  A new firmware version 1.12 seems to make the reader usable as a
	  CCID readers in contacless mode.

2013-05-08  Ludovic Rousseau

	* [r6624] src/ifdhandler.c: CreateChannelByNameOrChannel(): fix
	  clang warning
	  
	  ifdhandler.c:142:26: warning: comparison of constant 617 with
	  expression of type 'status_t' is always false
	  [-Wtautological-constant-out-of-range-compare] if
	  (IFD_NO_SUCH_DEVICE == ret) ~~~~~~~~~~~~~~~~~~ ^ ~~~
	  
	  Do not mix ret of type status_t with CmdGetSlotStatus() returning
	  a RESPONSECODE

2013-05-07  Ludovic Rousseau

	* [r6623] src/92_pcscd_ccid.rules: udev rule file: remove support
	  of Linux kernel < 2.6.35
	  
	  USB power management is now only working on Linux kernel >=
	  2.6.35 Older kernels will just not suspend the smart card reader.
	* [r6622] src/92_pcscd_ccid.rules: udev rule file: Remove setting
	  group to pcscd
	  
	  Since pcsc-lite 1.8.0 (November 2011) the auto start of pcscd
	  from the library has been removed. Use systemd instead
	  
	  This action in the udev rule file is then useless.

2013-05-04  Ludovic Rousseau

	* [r6620] readers/supported_readers.txt: THRC Smart Card Reader
	  moved from disabled to unsupported list
	* [r6618] readers/iDream.txt, src/ccid_usb.c: New firmware of the
	  THRC reader
	  
	  This new firmware _may_ work. Firmware older than 1.02 are marked
	  as bogus.
	  
	  The reader was in the disabled list so old readers will continue
	  to _not_ work with the driver.
	* [r6617] src/commands.c: CCID_Receive(): better management of time
	  extension requests
	  
	  The driver now uses the value returned in the time extension
	  frame to multiply the timeout value. The timeout value may be
	  bigger than needed but the goal is to timeout _after_ the reader.
	  
	  Thanks to Henryk Plötz for the bug report

2013-05-03  Ludovic Rousseau

	* [r6616] readers/GemPCTwin.txt, readers/Gemalto_IDBridge_CT30.txt,
	  readers/supported_readers.txt: Add Gemalto IDBridge CT30 in the
	  Unsupported list
	  
	  This reader is an GemPC Twin with a new chipset and firmware
	  (version E)

2013-04-26  Ludovic Rousseau

	* [r6614] readers/Broadcom_5880v2.txt: Update with contactless
	  interface enabled
	  http://ridrix.wordpress.com/2009/10/13/how-to-enable-pcsc-support-for-dell-contactless-reader/

2013-04-16  Ludovic Rousseau

	* [r6609] README, configure.ac: Release 1.4.10
	* [r6608] readers/supported_readers.txt: Regenerate using composite
	  readers

2013-04-15  Ludovic Rousseau

	* [r6605] readers/CardMan3821.txt, readers/CherryXX33.txt,
	  readers/CherryXX44.txt, readers/GemPC433_SL.txt,
	  readers/SCR331-DI-NTTCom.txt, readers/Verisign_secure_token.txt,
	  readers/Winbond.txt: Normalize file
	* [r6604] readers/Identive_CLOUD_4710_F.txt,
	  readers/supported_readers.txt: Add Identive CLOUD 4710 F
	  Contactless + SAM Reader
	* [r6603] readers/Identive_CLOUD_4700_F.txt,
	  readers/supported_readers.txt: Add Identive CLOUD 4700 F Dual
	  Interface Reader
	* [r6602] readers/Identive_CLOUD_4510_F.txt,
	  readers/supported_readers.txt: Add Identive CLOUD 4510 F
	  Contactless + SAM Reader
	* [r6601] readers/Identive_CLOUD_4500_F.txt,
	  readers/supported_readers.txt: Add Identive CLOUD 4500 F Dual
	  Interface Reader
	* [r6600] readers/Identive_CLOUD_2700_R.txt,
	  readers/supported_readers.txt: Add Identive CLOUD 2700 R Smart
	  Card Reader
	* [r6599] readers/Identive_CLOUD_2700_F.txt,
	  readers/supported_readers.txt: Add Identive CLOUD 2700 F Smart
	  Card Reader
	* [r6598] readers/CherryXX33.txt, readers/CherryXX44.txt,
	  readers/GemPC433_SL.txt, readers/SCR331-DI-NTTCom.txt,
	  readers/Verisign_secure_token.txt: Normalize values in hex or
	  decimal

2013-04-12  Ludovic Rousseau

	* [r6597] readers/Inside_Secure_AT90SCR200.txt,
	  readers/supported_readers.txt: Add Inside Secure AT90SCR200
	* [r6596] readers/Inside_Secure_AT90SCR100.txt,
	  readers/supported_readers.txt: Add Inside Secure AT90SCR100
	* [r6595] readers/Inside_Secure_AT90SCR050.txt,
	  readers/supported_readers.txt: Add Inside Secure AT90SCR050

2013-04-09  Ludovic Rousseau

	* [r6590] readers/Gemalto_IDBridge_K3000.txt,
	  readers/supported_readers.txt: Add Gemalto IDBridge K3000

2013-04-05  Ludovic Rousseau

	* [r6587] src/92_pcscd_ccid.rules: Add SCR3310-NTTCom USB SmartCard
	  Reader which uses bInterfaceClass: 0xFF
	  
	  Thanks to Hiroyuki Yamamoto for the patch Closes Debian bug
	  #704673

2013-04-04  Ludovic Rousseau

	* [r6586] readers/Morpho_MSO1350.txt,
	  readers/supported_readers.txt: Add Morpho MSO1350 Fingerprint
	  Sensor & SmartCard Reader
	* [r6585] readers/Morpho_MSO350.txt, readers/supported_readers.txt:
	  Add Morpho MSO350/MSO351 Fingerprint Sensor & SmartCard Reader

2013-03-14  Ludovic Rousseau

	* [r6570] src/commands.c: Add support of time extension for Escape
	  commands
	  
	  An CCID Escape command can now use the time extension request
	  mechanism to ask for more time.
	  
	  Fixes Alioth bug [#314061] Time extension request and escape
	  command
	  
	  Thanks to Rachid HARBI-ASSYSTEM for the feature request

2013-03-12  Ludovic Rousseau

	* [r6569] readers/Yubico_Yubikey_neo.txt,
	  readers/supported_readers.txt: Add Yubico Yubikey NEO CCID
	* [r6567] readers/Yubico_Yubikey_neo.txt,
	  readers/Yubico_Yubikey_neo_otp.txt: Rename descriptor
	* [r6566] examples/scardcontrol.c: Check the value returned by
	  fgets(3)
	  
	  Fix compiler warning: ignoring return value of ‘fgets’, declared
	  with attribute warn_unused_result [-Wunused-result]

2013-03-06  Ludovic Rousseau

	* [r6565] src/openct/proto-t1.c: cppcheck: Variable 'sent_length'
	  is assigned a value that is never used.
	* [r6564] src/openct/proto-t1.c: cppcheck: The scope of the
	  variable 'm' can be reduced.
	* [r6563] src/ifdhandler.c: cppcheck: The scope of the variable 'i'
	  can be reduced.
	* [r6562] src/parse.c: cppcheck: Variable 'interface' is assigned a
	  value that is never used.
	* [r6561] src/commands.c: cppcheck: The scope of the variable
	  'voltage_code' can be reduced.
	* [r6560] src/commands.c: cppcheck: The scope of the variable
	  'count' can be reduced.

2013-03-01  Ludovic Rousseau

	* [r6548] readers/SafeTech_SafeTouch.txt,
	  readers/supported_readers.txt: Add SafeTech SafeTouch
	* [r6541] readers/SpringCard_H663_Series.txt,
	  readers/supported_readers.txt: Add SpringCard H663 Series
	* [r6540] readers/SpringCard_H512_Series.txt,
	  readers/supported_readers.txt: Add SpringCard H512 Series
	* [r6539] readers/SpringCard_NFC_Roll.txt: New firmware (1.71) for
	  SpringCard NFC'Roll

2013-02-18  Ludovic Rousseau

	* [r6533] readers/ACS_APG8201_v2.txt,
	  readers/supported_readers.txt: Add ACS APG8201 USB Reader with
	  PID 0x8202

2013-02-17  Ludovic Rousseau

	* [r6530] readers/GIS_SmartMouse.txt,
	  readers/supported_readers.txt: Add GIS Ltd SmartMouse USB

2013-02-15  Ludovic Rousseau

	* [r6528] src/create_Info_plist.pl: Add a missing "; to terminate a
	  string
	  
	  The bug was introduced in revision 6518.

2013-01-31  Ludovic Rousseau

	* [r6521] readers/Yubico_Yubikey_neo.txt,
	  readers/supported_readers.txt: Add Yubico Yubikey NEO OTP+CCID

2013-01-27  Ludovic Rousseau

	* [r6518] src/Info.plist.src, src/Makefile.am,
	  src/create_Info_plist.pl: Remove the duplicate CFBundleExecutable
	  from Info.plist
	  
	  CFBundleExecutable key was used 2 times: - The first occurence
	  stored the bundle name (ifd-ccid.bundle) - The second occurence
	  stored the executable name (libccid.so or .dylib)
	  
	  The bundle name is not usefull and has been present since
	  revision 3458 (April 2009)

2013-01-22  Ludovic Rousseau

	* [r6512] readers/SpringCard_NFC_Roll.txt,
	  readers/supported_readers.txt: Add SpringCard NFC'Roll

2013-01-16  Ludovic Rousseau

	* [r6507] README, configure.ac: Release 1.4.9

2012-11-13  Ludovic Rousseau

	* [r6482] readers/ReinerSCT_cyberJack_go.txt,
	  readers/supported_readers.txt: Add REINER SCT cyberJack go
	* [r6481] readers/supported_readers.txt: Move ATMEL VaultIC460 in
	  unsupported list See revision 6479

2012-10-31  Ludovic Rousseau

	* [r6478] src/ifdhandler.c: IFDHSetProtocolParameters(): display
	  the timeout
	  
	  If the reader has CCID_CLASS_AUTO_PPS_PROP then the negociations
	  are done by the reader itself and the default timeout
	  DEFAULT_COM_READ_TIMEOUT is used.

2012-10-12  Ludovic Rousseau

	* [r6475] readers/Rutoken_PINPad_in.txt,
	  readers/supported_readers.txt: Add Aktiv Rutoken PINPad In
	* [r6474] readers/Rutoken_PINPad_ex.txt,
	  readers/supported_readers.txt: Add Aktiv Rutoken PINPad Ex

2012-10-07  Ludovic Rousseau

	* [r6471] README: Fix typo
	* [r6470] README, configure.ac: Release 1.4.8

2012-10-04  Ludovic Rousseau

	* [r6469] configure.ac, configure.in: Rename configure.in in
	  configure.ac
	  
	  aclocal: warning: autoconf input should be named 'configure.ac',
	  not 'configure.in'

2012-09-14  Ludovic Rousseau

	* [r6465] ylwrap: Updated version from autoamake-1.12
	* [r6464] MacOSX/configure: Use pkg-config to find the libusb-1.0
	  arguments
	  
	  The libusb-1.0 path and link arguments are no more hard coded.

2012-09-13  Ludovic Rousseau

	* [r6457] readers/MX5_SMART_CCID_DRIVER.txt,
	  readers/supported_readers.txt: Add MX5 SMART CCID DRIVER in the
	  "disabled" list

2012-09-03  Ludovic Rousseau

	* [r6455] readers/Inside_Secure_VaultIC_440.txt,
	  readers/supported_readers.txt: Add Inside Secure VaultIC 440
	  Smart Object
	* [r6454] readers/Inside_Secure_VaultIC_420.txt,
	  readers/supported_readers.txt: Add Inside Secure VaultIC 420
	  Smart Object

2012-08-30  Ludovic Rousseau

	* [r6452] Makefile.am, configure.in, m4/acx_pthread.m4,
	  m4/ax_pthread.m4: Use AX_PTHREAD macro instead of ACX_PTHREAD
	  
	  Fix some "autoreconf -vis -Wall" warnings

2012-08-23  Ludovic Rousseau

	* [r6438] Makefile.am, configure.in, m4/Makefile.am: Integrate
	  m4/Makefile.am into Makefile.am
	  
	  The idea is to remove a Makefile files to speed up compilation.
	  
	  Thanks to Diego Elio Pettenò for the idea.
	* [r6437] examples/Makefile.am: Add missing PCSCv2part10.h
	* [r6436] configure.in: Add AC_CONFIG_MACRO_DIR([m4]) as suggested
	  by autoreconf
	  
	  libtoolize: Consider adding `AC_CONFIG_MACRO_DIR([m4])' to
	  configure.in and libtoolize: rerunning libtoolize, to keep the
	  correct libtool macros in-tree.

2012-08-07  Ludovic Rousseau

	* [r6406] examples/Makefile.am, examples/PCSCv2part10.c,
	  examples/PCSCv2part10.h, examples/scardcontrol.c: Use helper
	  functions from libPCSCv2part10 project
	* [r6403] examples/scardcontrol.c: Add support of new PC/SC V2 part
	  10 properties: - dwMaxAPDUDataSize - wIdVendor - wIdProduct

2012-08-02  Ludovic Rousseau

	* [r6399] src/ifdhandler.c: CreateChannelByNameOrChannel(): check
	  device exists for the first CmdGetSlotStatus()
	* [r6396] src/ifdhandler.c: CreateChannelByNameOrChannel(): Do not
	  change the default timeout for the first call to
	  CmdGetSlotStatus().
	  
	  In revision 4938 the timeout is changed from default to 100 ms to
	  avoid a 2 seconds delay if the reader needs to resynchronize.
	  
	  In revision 5389 the timeout was changed from 100 ms to 1000 ms
	  because it was too sort for the Kobil KAAN Base reader.
	  
	  The idea now is to use the default value
	  (DEFAULT_COM_READ_TIMEOUT (3*1000)) for the first
	  CmdGetSlotStatus() call. And then use a short value (100 ms) for
	  the 2 next calls.
	  
	  The reader should have enough time to start during the 3 first
	  seconds.

2012-07-26  Ludovic Rousseau

	* [r6394] readers/ActivkeySim.txt: New firmware
	* [r6393] readers/SCR3310-NTTCom.txt,
	  readers/supported_readers.txt: Add (again) SCR3310-NTTCom USB
	  SmartCard Reader
	* [r6390] readers/GemPCTwin.txt: New firmware (version E)

2012-07-05  Ludovic Rousseau

	* [r6387] readers/GemPCTwin.txt: New firmware

2012-06-23  Ludovic Rousseau

	* [r6352] readers/CherryST1044U.txt: New firmware. No other
	  changes.

2012-06-22  Ludovic Rousseau

	* [r6350] configure.in: Release 1.4.7
	* [r6349] README: Release 1.4.7

2012-06-20  Ludovic Rousseau

	* [r6348] src/ccid_usb.c: OpenUSBByName(): Add debug log message
	  when the interface found is not the one we are looking for.
	  
	  This is in particular interesting for a composite device and the
	  CCID driver compiled with --enable-composite-as-multislot

2012-06-15  Ludovic Rousseau

	* [r6337] readers/NXP_PR533.txt: New firmware

2012-06-13  Ludovic Rousseau

	* [r6331] readers/ACS_CryptoMate64.txt,
	  readers/supported_readers.txt: Add ACS CryptoMate64

2012-06-06  Ludovic Rousseau

	* [r6328] src/openct/proto-t1.c: t1_transceive(): avoids a infinite
	  retry loop
	  
	  Move the check for ISO 7816-3 Rule 7.4.2 (2 retried before
	  resynch) before the check for ISO 7816-3 Rule 7.2 (retransmission
	  of R-block)
	  
	  Thanks to Martin Vogt for the bug report and patch
	  http://archives.neohapsis.com/archives/dev/muscle/2012-q2/0077.html
	* [r6327] src/openct/proto-t1.c: t1_transceive(): avoids a infinite
	  retry loop
	  
	  Add a check for ISO 7816-3 Rule 7.4.2 (2 retried before resync)
	  in case of "wrong nr".
	  
	  " currently I have an endless loop in t1_transceive. It happens
	  from time to time with the aladdin token.
	  
	  I added some printfs to the code. I can see, that the errors are
	  detected and then a t1_build is called with a T1_OTHER_ERROR,
	  retries are decreased, but this is never evaluated in the loop
	  path and the retries counter counts and counts.... I stopped it
	  at: retries -1796. "
	  
	  Thanks to Martin Vogt for the bug report and patch
	  http://archives.neohapsis.com/archives/dev/muscle/2012-q2/0076.html
	* [r6326] src/ccid_usb.c: OpenUSBByName(): check the lists
	  vendorID, productID and friendlyNames have all the same size.
	  
	  This should prevent a crash if the parsing failed. For example it
	  would avoid a crash due to a bug similar to the one fixed in
	  revision 6325: ie a reader with [ ] in its name.

2012-05-30  Ludovic Rousseau

	* [r6313] SCARDGETATTRIB.txt: Update descriptions

2012-05-26  Ludovic Rousseau

	* [r6311] src/commands.c: Always check for STATUS_NO_SUCH_DEVICE
	  and return accordingly
	  
	  Thanks to Martin Vogt for the bug report and patch idea
	  http://archives.neohapsis.com/archives/dev/muscle/2012-q2/0057.html
	* [r6310] src/openct/proto-t1.c: t1_xcv(): always return a negative
	  value in case of error
	  
	  Thanks to Martin Vogt for the patch
	  http://archives.neohapsis.com/archives/dev/muscle/2012-q2/0057.html

2012-05-19  Ludovic Rousseau

	* [r6309] readers/supported_readers.txt: Add KOBIL Systems IDToken
	* [r6308] src/ifdhandler.c: Add Reader-Info-Commands special
	  APDU/command for the Kobil IDToken
	  
	  - Manufacturer command - Product name command - Firmware version
	  command - Driver version command
	  
	  The APDU are handled by the driver sice the reader do not support
	  them. These APDU/commands are used by the AusweisApp application
	  and a German eID card.
	* [r6307] src/ifdhandler.c: Hack for the Kobil IDToken and Geman
	  eID card
	  
	  The German eID card is bogus and need to be powered off before a
	  power on
	* [r6306] src/ccid.h: Add Kobil IDToken definition
	* [r6305] src/defs.h: Give more time (3 seconds instead of 2) to
	  the reader to answer
	  
	  The IDToken reader takes up to 2.5 seconds to answer to an
	  PC_to_RDR_GetSlotStatus command after the (contactless) card has
	  been removed.

2012-05-18  Ludovic Rousseau

	* [r6301] configure.in: warning: 'libccid.la': linking libtool
	  libraries using a non-POSIX archiver requires 'AM_PROG_AR' in
	  'configure.in'
	* [r6300] configure.in: autoupdated using autoupdate (GNU Autoconf)
	  2.69

2012-05-16  Ludovic Rousseau

	* [r6297] readers/Vasco_DP905.txt: Firmware upgrade
	  
	  The new firmware supports extended APDU and iProduct changed from
	  DP905 to DP905v1.1

2012-05-15  Ludovic Rousseau

	* [r6296] readers/ACS_ACR101.txt, readers/supported_readers.txt:
	  Add ACS ACR101 ICC Reader

2012-05-11  Ludovic Rousseau

	* [r6292] src/ccid_usb.c: OpenUSBByName(): log the Info.plist used
	  
	  On Mac OS X the CCID driver may be installed many times with
	  different names using --enable-bundle=...
	  
	  With the Info.plist file name displayed it is possible to check
	  the correct Info.plist is used.

2012-05-01  Ludovic Rousseau

	* [r6289] readers/AlcorMicro_AU9522.txt,
	  readers/supported_readers.txt: Add Alcor Micro AU9522

2012-04-18  Ludovic Rousseau

	* [r6284] readers/sid800.txt: New firmware
	* [r6283] readers/bit4id_cryptokey.txt,
	  readers/supported_readers.txt: Add Bit4id cryptokey
	* [r6282] readers/bit4id_iam.txt, readers/supported_readers.txt:
	  Add Bit4id iAM
	* [r6281] readers/bit4id_key4.txt, readers/supported_readers.txt:
	  Add Bit4id CKey4
	* [r6280] readers/bit4id_minilector-s.txt,
	  readers/supported_readers.txt: Add Bit4id miniLector-s
	* [r6279] readers/bit4id_minilector.txt,
	  readers/supported_readers.txt: Add Bit4id miniLector
	* [r6278] readers/supported_readers.txt: Sort the duplicates
	  section by vid/pid
	* [r6277] readers/NXP_PR533.txt, readers/supported_readers.txt: Add
	  NXP PR533

2012-04-17  Ludovic Rousseau

	* [r6275] src/92_pcscd_ccid.rules: Use auto suspend for CCID
	  devices only
	  
	  The rule used "*:0b0000:*" and so was used even for composite
	  devices using a CCID interface. It was problematic for a keybord
	  + CCID interface since the keyboard was also automatically
	  systended after a few seconds of inactivity.
	  
	  The new rule uses ":0b0000:" so composite devices will not be
	  configured for USB automatic suspend.
	  
	  Closes Alioth bug [#313445] "Do not activate USB suspend for
	  composite devices: keyboard"
	  https://alioth.debian.org/tracker/index.php?func=detail&aid=313445&group_id=30105&atid=410085

2012-04-13  Ludovic Rousseau

	* [r6274] src/ccid.c: Use %zd instead of %ld for size_t size
	  
	  Fix compiler warning ccid.c: In function
	  `dump_gemalto_firmware_features': ccid.c:122:2: warning: format
	  `%ld' expects argument of type `long int', but argument 6 has
	  type `unsigned int' [-Wformat]
	  
	  sizeof returns a size_t value with a variable length depending on
	  the architecture.

2012-04-12  Ludovic Rousseau

	* [r6273] readers/Gemalto_Ezio_Branch.txt,
	  readers/supported_readers.txt: Add Gemalto Ezio Shield Branch
	  Reader

2012-04-08  Ludovic Rousseau

	* [r6270] readers/CCB_eSafeLD.txt, readers/supported_readers.txt:
	  Add CCB eSafeLD

2012-04-06  Ludovic Rousseau

	* [r6266] README, configure.in: Release 1.4.6
	* [r6265] ylwrap: Update to version 2011-08-25.18
	* [r6264] MacOSX/configure: Use the new SDK path for Xcode 4
	  
	  Xcode is now a normal application downloaded from the Mac App
	  Store. All the files are now contained in /Applications/Xcode.app

2012-04-05  Ludovic Rousseau

	* [r6260] src/ccid.c: Use DWORD_D instead %ld to fix a warning on
	  Mac OS X 64-bits
	  
	  ccid.c: In function 'set_gemalto_firmware_features': ccid.c:204:
	  warning: format '%ld' expects type 'long int', but argument 6 has
	  type 'RESPONSECODE'
	* [r6259] src/defs.h, src/ifdhandler.c: Move definitions of DWORD_X
	  and DWORD_D

2012-04-04  Ludovic Rousseau

	* [r6258] src/ifdhandler.c: IFDHControl(): Add support of
	  dwMaxAPDUDataSize
	  
	  This property indicates if a reader/driver supports extended APDU
	  or not.
	  
	  From PC/SC v2 part 10 (version 2.02.09 not yet published):
	  dwMaxAPDUDataSize: Maximal size of data the reader and its driver
	  can support 0: short APDU only. 0<X<=256: forbidden values (RFU)
	  256 < X <= 0x10000: short and extended APDU of up to X bytes of
	  data 0x10000 < X: invalid values (RFU)
	* [r6255] readers/supported_readers.txt: Remove KOBIL IDToken until
	  support is complete

2012-04-02  Ludovic Rousseau

	* [r6254] configure.in: Minimal version of pcsc-lite is 1.8.3
	  
	  We now use PCSCv2_PART10_PROPERTY_wIdVendor and
	  PCSCv2_PART10_PROPERTY_wIdProduct defined in pcsc-lite 1.8.3

2012-03-27  Ludovic Rousseau

	* [r6252] src/ccid.c, src/ccid.h, src/ccid_serial.c,
	  src/ccid_usb.c, src/commands.c: Add support of Gemalto firmware
	  features
	  
	  Gemalto readers support an Escape command to report features
	  supported (or not) by the reader. The reader can also report if
	  specific bugs are fixed or not.
	  
	  One of the fixed bug (in recent readers) is the bNumberMessage
	  management used in the Secure Modify CCID command.
	  
	  Thanks to Jean Lusetti for the patch

2012-03-26  Ludovic Rousseau

	* [r6251] src/commands.c: SecurePINModify(): set the minimum
	  timeout to 90 seconds
	  
	  Some readers have a default timeout of 60 seconds. We need to use
	  a larger value to timeout _after_ the reader.
	  
	  Same change as in revision 6243 but for SecurePINModify() instead
	  of SecurePINVerify()
	* [r6250] readers/Gemalto_Ezio_Shield_PinPad.txt: Firmware update

2012-03-23  Ludovic Rousseau

	* [r6245] src/ifdhandler.c: Add support of wIdVendor and wIdProduct
	  properties
	  
	  PCSCv2_PART10_PROPERTY_wIdVendor and
	  PCSCv2_PART10_PROPERTY_wIdProduct are new in PC/SC v2 part 10
	  version 2.02.09 (not yet released as of today)
	* [r6243] src/commands.c: SecurePINVerify(): set the minimum
	  timeout to 90 seconds
	  
	  Some readers have a default timeout of 60 seconds. We need to use
	  a larger value to timeout _after_ the reader.

2012-03-19  Ludovic Rousseau

	* [r6240] src/commands.c: CCID_Receive(): ICCD type A, wait for
	  device ready
	  
	  "Here's a fix to make your driver operate in accordance with the
	  ICCD specification when using Version A control transfers. The
	  status byte is supposed to indicate when the device has a
	  response ready. So I simply added a call to CmdGetSlotStatus."
	  
	  Thanks to John Billings for the patch.

2012-03-13  Ludovic Rousseau

	* [r6239] readers/supported_readers.txt: Add KOBIL IDToken
	* [r6238] readers/Kobil_IDToken.txt: Add Kobil IDToken

2012-02-24  Ludovic Rousseau

	* [r6233] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c:
	  Some output improvements

2012-02-23  Ludovic Rousseau

	* [r6232] readers/supported_readers.txt: Move SCR335 from supported
	  to should work list since the V2.0 with a new firmware has not
	  been tested by me.
	* [r6231] src/ccid_usb.c: Remove SCR 335 from the bogus firmware
	  list
	  
	  The V2.0 model has a lower firmware version (2.04 instead of
	  5.23). The reader should be less buggy (not yet checked)
	* [r6230] readers/SCR335.txt: Firmware update for the V2.0 model

2012-02-17  Ludovic Rousseau

	* [r6227] src/ifdhandler.c: Correctly define DWORD_D on Linux

2012-02-16  Ludovic Rousseau

	* [r6226] src/ccid.h: Define GEMALTO_FIRMWARE_FEATURES structure
	  
	  Structure returned by Gemalto readers for the CCID Escape command
	  0x6A

2012-02-15  Ludovic Rousseau

	* [r6225] src/ifdhandler.c: Use DWORD_X and DWORD_D to print a
	  DWORD in hex or dec
	  
	  The definition of DWORD is uint32_t on Mac OS X and unsigned long
	  with official pcsc-lite. DWORD_X is defined as "%X" on Mac and
	  "%lX" otherwise.
	  
	  A DWORD value is now always correctly logged/displayed on Mac OS
	  X and the compiler stops complaining.

2012-02-14  Ludovic Rousseau

	* [r6224] readers/supported_readers.txt: Add Macally NFC CCID
	  eNetPad reader
	* [r6221] readers/Macally_NFC_CCID_eNetPad.txt: Add Macally NFC
	  CCID eNetPad reader

2012-02-13  Ludovic Rousseau

	* [r6220] src/ifdhandler.c: CreateChannelByNameOrChannel(): add
	  explicit braces
	  
	  Fix compiler warning: ifdhandler.c: In function
	  'CreateChannelByNameOrChannel': ifdhandler.c:81:5: warning:
	  suggest explicit braces to avoid ambiguous 'else' [-Wparentheses]
	  
	  The problem is that DEBUG_INFO3() is not a code block but a
	  "dangerous" if () macro.
	* [r6219] src/ifdhandler.c: Factorise IFDHCreateChannelByName() and
	  IFDHCreateChannel()
	  
	  The two functions were duplicates expect 2 lines. Factorisation
	  will avoid divergence of bug fixes (as it was the case for error
	  management).
	* [r6218] src/ifdhandler.c: IFDHCreateChannelByName(): favctorize
	  code
	  
	  The code used to release the allocated resources is no more
	  duplicated in two places.
	* [r6217] src/ifdhandler.c: IFDHCreateChannelByName(): check the
	  value returned by ccid_open_hack_post()
	  
	  If ccid_open_hack_post() fails (the strings could not be loaded
	  in a GEMPCPINPAD reader as in revision 6216) then we return with
	  an error instead of ignoring the issue.
	* [r6216] src/ccid.c: ccid_open_hack_post(): return an error if
	  needed
	  
	  Return IFD_COMMUNICATION_ERROR if it is not possible to load the
	  strings in a GEMPCPINPAD reader. This happens if the reader is
	  deconnected during this step.

2012-01-31  Ludovic Rousseau

	* [r6211] src/ccid.c, src/ccid.h: Disable SPE for HP USB CCID
	  Smartcard Keyboard
	  
	  The Secure Pin Entry of the HP USB CCID Smartcard Keyboard
	  idVendor: 0x03F0 idProduct: 0x0036 is bogus and can't be used on
	  Unix.
	  
	  00000033 Control TxBuffer: 1E 1E 02 00 00 10 04 02 00 00 00 00 00
	  00 00 05 00 00 00 00 20 00 81 00 00000013
	  openct/proto-t1.c:571:t1_build() more bit: 0 00000039 -> 000000
	  69 14 00 00 00 00 24 00 00 00 00 1E 02 00 00 10 04 02 00 00 00 00
	  00 40 05 00 20 00 81 00 30005454 <- 000000 80 00 00 00 00 00 24
	  40 F0 00 00000059 commands.c:1339:CCID_Receive PIN timeout
	  
	  Instead of telling the reader has SPE and failing with an obscure
	  error the driver will disable the SPE feature.
	  
	  Thanks to Jörg Grundmann for the bug report.

2012-01-27  Ludovic Rousseau

	* [r6207] readers/supported_readers.txt: Sort the readers of a same
	  manufacturer by PID
	* [r6203] readers/supported_readers.txt: Generated by
	  website/generate_supported_readers.py
	  
	  The list of supported readers is now generated from list of USB
	  descriptor files.
	  
	  Readers without a .txt file are now NO MORE supported. They are:
	  Reader(s) without a .txt description 0x08E6:0x34C1:Gemalto Ezio
	  Shield Secure Channel 0x08E6:0x34C4:Gemalto Ezio Generic
	  0x04E6:0x511A:SCM SCR 3310 NTTCom 0x0783:0x0008:C3PO LTC32 USBv2
	  with keyboard support 0x0783:0x9002:C3PO TLTC2USB
	  0x047B:0x020B:Silitek SK-3105

2012-01-23  Ludovic Rousseau

	* [r6191] readers/GemPCTwin_serial.txt: Duplicates of GemPCTwin.txt
	  
	  It is a duplicate by design since it is a symbolic link. Now that
	  supported_readers.txt is generated from the .txt file this is
	  problematic.

2012-01-16  Ludovic Rousseau

	* [r6179] src/debug.c: Log to stdout by default
	  
	  This log service is only used on Mac OS X. Using stderr is
	  problematic when other log mesages are using stdout. The order is
	  not respected if stdout and stderr are redirected to a file. For
	  example when using handler_test.
	  
	  Now the logs are sent to stdout (by default) and also flushed
	  after each line. It is possible to use tee(1).

2012-01-12  Ludovic Rousseau

	* [r6168] readers/Todos_Connectable.txt: Todos_Connectable.txt is a
	  duplicate of Todos_Cx00.txt

2012-01-03  Ludovic Rousseau

	* [r6164] readers/Teridian_TSC12xxFV.09.txt,
	  readers/supported_readers.txt: Add Teridian TSC12xxF
	* [r6162] readers/Avtor_SecureToken.txt,
	  readers/supported_readers.txt: Add Avtor SecureToken

2012-01-02  Ludovic Rousseau

	* [r6161] readers/supported_readers.txt: Update "Giesecke &
	  Devrient StarSign Crypto USB Token" name on G&D request
	* [r6159] MacOSX/configure: Build a Universal Binary driver only if
	  libusb is also a Universal Binary library
	* [r6158] MacOSX/configure: Add $Id$
	* [r6157] MacOSX/configure: Add -lobjc since
	  objc_registerThreadWithCollector() is used now in
	  libusb-1.0.8-rc3
	  
	  See libusb ticket #63 "libusb pthread usage causes error in
	  garbage collected Cocoa apps" http://libusb.org/ticket/63

2011-12-31  Ludovic Rousseau

	* [r6154] readers/Vasco_DIGIPASS_KEY_202_0120.txt,
	  readers/Vasco_DIGIPASS_KEY_202_0122.txt,
	  readers/supported_readers.txt: Add Vasco DIGIPASS KEY 202 with
	  ProductID 0x0120 and 0x0122

2011-12-16  Ludovic Rousseau

	* [r6144] readers/Vasco_DPKey101.txt,
	  readers/supported_readers.txt: Add Vasco DIGIPASS KEY 101
	* [r6141] readers/Avtor_SC_Reader_371.txt,
	  readers/supported_readers.txt: Add Avtor SC Reader 371

2011-12-06  Ludovic Rousseau

	* [r6135] src/ccid_usb.c: Fix bug from revision 6134
	  
	  The correct return value is STATUS_SUCCESS for success.
	* [r6134] src/ccid_usb.c: OpenUSBByName(): fix memory leaks
	  
	  Some memory was not released in case of errors.
	* [r6133] src/ifdhandler.c: IFDHCreateChannelByName(): fix memory
	  leak
	  
	  Memory leak if the OpenPortByName() failed

2011-12-01  Ludovic Rousseau

	* [r6125] readers/supported_readers.txt: Fix OmniKey 6321 CLi USB
	  name
	* [r6123] readers/Omnikey_6321.txt, readers/supported_readers.txt:
	  Add OmniKey 6321 USB

2011-11-03  Ludovic Rousseau

	* [r6100] readers/Xiring_MyLeo.txt: New firmware
	* [r6099] readers/Kobil_EMV_CAP.txt: New firmware
	* [r6097] readers/Feitian_SCR301.txt: New firmware release
	* [r6096] src/ccid_usb.c: ControlUSB(): return a negative value in
	  case of error instead of STATUS_UNSUCCESSFUL (0xFB)
	  
	  The calling code is checking for a negative return value so we
	  adapt the API to its usage.

2011-10-30  Ludovic Rousseau

	* [r6088] src/create_Info_plist.pl: Convert "&" in a reader name
	  into "&amp;"
	  
	  For example the name "Giesecke & Devrient" does not work on Mac
	  OS X using hotplug_macosx.c and generates the error: 00000683
	  hotplug_macosx.c:161:HPDriversGetFromDirectory() error getting
	  vendor ID from bundle

2011-10-28  Ludovic Rousseau

	* [r6085] readers/SCM_SDI011.txt, readers/supported_readers.txt:
	  Add SCM SDI 011

2011-10-24  Ludovic Rousseau

	* [r6075] examples/scardcontrol.c: Move a variable to the block it
	  is used
	* [r6074] examples/scardcontrol.c: Display PIN_PROPERTIES_STRUCTURE
	  if any

2011-10-23  Ludovic Rousseau

	* [r6066] readers/Inside_Secure_VaultIC_460_Smart_Object.txt,
	  readers/supported_readers.txt: Add Inside Secure VaultIC 460
	  Smart Object
	* [r6064]
	  readers/FujitsuTechnologySolutions_SmartCase_KB_SCR_eSIG.txt,
	  readers/supported_readers.txt: Add Fujitsu SmartCase KB SCR eSIG

2011-10-20  Ludovic Rousseau

	* [r6049] src/ccid_usb.c: InterruptStop(): Do not interrupt two
	  times (or more) the same libusb transfer
	  
	  This can happen within SCardDisconnect() on the same reader from
	  2 or more threads/processes. This is the case with
	  PCSC.work/UnitaryTests/ThreadSafeConnect.py

2011-10-14  Ludovic Rousseau

	* [r6040] readers/GnD_StarSign_CUT.txt,
	  readers/supported_readers.txt: Add Giesecke & Devrient StarSign
	  CUT

2011-10-11  Ludovic Rousseau

	* [r6032] README, configure.in: Release 1.4.5

2011-10-10  Ludovic Rousseau

	* [r6025] src/ccid_usb.c: Remove a debug log
	* [r6024] src/ccid.h: Remove a const qualifier to avoid a warning
	  on free()
	  
	  ccid_usb.c: In function 'CloseUSB': ccid_usb.c:742:4: warning:
	  passing argument 1 of 'free' discards 'const' qualifier from
	  pointer target type [enabled by default]
	* [r6023] src/ccid_usb.c: CloseUSB(): free the sIFD_iManufacturer
	  allocated resource is needed
	* [r6022] src/ifdhandler.c: Remove debug log
	* [r6021] src/ccid.h, src/ccid_serial.c, src/ccid_usb.c,
	  src/ifdhandler.c: SCARD_ATTR_VENDOR_NAME and
	  SCARD_ATTR_VENDOR_IFD_VERSION are not the vendor name and version
	  of the driver but of the IFD: InterFace Device i.e. the smart
	  card reader.
	  
	  We then return the USB iManufacturer string as
	  SCARD_ATTR_VENDOR_NAME and USB bcdDevice as
	  SCARD_ATTR_VENDOR_IFD_VERSION

2011-10-05  Ludovic Rousseau

	* [r6000] readers/ActivCardV3.txt: Firmware update

2011-10-02  Ludovic Rousseau

	* [r5991] src/ifdhandler.c: Add support of FEATURE_CCID_ESC_COMMAND
	  and bPPDUSupport
	  
	  FEATURE_CCID_ESC_COMMAND is available only if ifdDriverOptions
	  (from Info.plist config file) has bit 1 set:
	  
	  1: DRIVER_OPTION_CCID_EXCHANGE_AUTHORIZED the CCID Exchange
	  command is allowed. You can use it through SCardControl(hCard,
	  IOCTL_SMARTCARD_VENDOR_IFD_EXCHANGE, ...)
	* [r5990] examples/scardcontrol.c: Use FEATURE_CCID_ESC_COMMAND to
	  get the firmware of a GemPC reader
	* [r5989] examples/scardcontrol.c: Add support of
	  PCSCv2_PART10_PROPERTY_bPPDUSupport and FEATURE_CCID_ESC_COMMAND

2011-09-20  Ludovic Rousseau

	* [r5959] src/ccid_usb.c: ControlUSB(): log an eror if
	  libusb_control_transfer() fails
	  
	  Instead of passing a negative length to DEBUG_XXD() and make it
	  crash.

2011-09-13  Ludovic Rousseau

	* [r5952] .gitignore: Add missing files in .gitignore

2011-09-02  Ludovic Rousseau

	* [r5927] .gitignore: Create .gitignore files

2011-08-31  Ludovic Rousseau

	* [r5925] readers/SDS4ID_DominoKeyPro_100.txt,
	  readers/supported_readers.txt: Add SDS DOMINO-Key TWIN Pro
	* [r5923] readers/BIFIT_iBank2key.txt,
	  readers/supported_readers.txt: Add BIFIT iBank2Key

2011-08-30  Ludovic Rousseau

	* [r5921] readers/Gemalto_SA_dotNet_Dual.txt,
	  readers/supported_readers.txt: Add Gemalto SA .NET Dual

2011-08-27  Ludovic Rousseau

	* [r5916] src/debug.h, src/ifdhandler.c: Remove extra spaces

2011-08-25  Ludovic Rousseau

	* [r5912] examples/scardcontrol.c: Remove extra spaces
	* [r5911] readers/Precise_Sense_MC.txt: Add Precise Sense MC reader
	  (with fingerprint)

2011-08-24  Ludovic Rousseau

	* [r5909] src/Makefile.am: Do not build simclist with (unused) file
	  dump option
	  
	  Gain 5kB (or 5%) space for the binary text segment of libccid.so
	* [r5908] src/ccid_serial.c: OpenSerial(): remove useless casts
	* [r5907] src/commands.c: CCID_Transmit(): use a variable-length
	  array
	  
	  Use a VLA instead of static size of 65556 to limit stack
	  consumption
	  
	  Coverity: stack_use_local: Local variable "cmd" stack use: 65556
	  bytes -> 65572 bytes total. stack_use_overflow: The maximum stack
	  use of 32768 bytes is exceeded.
	* [r5906] src/commands.c: SecurePINModify(): use a variable-length
	  array
	  
	  Use a VLA instead of static size of 65576 to limit stack
	  consumption
	  
	  Coverity: stack_use_local: Local variable "cmd" stack use: 65576
	  bytes -> 65592 bytes total. stack_use_overflow: The maximum stack
	  use of 32768 bytes is exceeded.
	* [r5905] src/commands.c: SecurePINVerify(): use a variable-length
	  array
	  
	  Use a VLA instead of static size of 65572 to limit stack
	  consumption
	  
	  Coverity: stack_use_local: Local variable "cmd" stack use: 65572
	  bytes -> 65588 bytes total. stack_use_overflow: The maximum stack
	  use of 32768 bytes is exceeded.
	* [r5904] src/debug.c: Add a missing #include "strlcpycat.h" needed
	  on GNU/Linux
	* [r5903] src/commands.c: SetParameters(): use a variable-length
	  array
	  
	  Use a VLA instead of static size of 65556 to limit stack
	  consumption
	  
	  Coverity: Event stack_use_local: Local variable "cmd" stack use:
	  65556 bytes -> 65572 bytes total. Event stack_use_overflow: The
	  maximum stack use of 32768 bytes is exceeded.
	* [r5902] src/commands.c: Remove extra spaces

2011-08-21  Ludovic Rousseau

	* [r5897] src/debug.c: Use a variable-length array
	  
	  The debug message buffer is no more with a fixed size (around 256
	  bytes of buffer to log) but uses a variable-length array.
	  
	  This is available in GCC in C90 mode and is mandatory in C99
	  standard.

2011-08-20  Ludovic Rousseau

	* [r5895] src/Makefile.am, src/ccid.h, src/commands.c, src/parse.c:
	  Remove extra spaces and tabs

2011-08-19  Ludovic Rousseau

	* [r5893] readers/Gemalto_Ezio_Shield_PinPad.txt: Add Gemalto Ezio
	  Shield PinPad reader

2011-08-17  Ludovic Rousseau

	* [r5890] readers/BIFIT_USB-Token_iBank2key.txt,
	  readers/supported_readers.txt: Add BIFIT USB-Token iBank2key

2011-08-05  Ludovic Rousseau

	* [r5878] readers/Ubisys_RFID.txt, readers/supported_readers.txt:
	  Add Ubisys 13.56MHz RFID (CCID)

2011-07-09  Ludovic Rousseau

	* [r5871] src/ifdhandler.c: Fix compiler warnings
	  
	  ifdhandler.c: In function `IFDHCreateChannelByName':
	  ifdhandler.c:80:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 6 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHCreateChannel':
	  ifdhandler.c:201:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 6 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHCloseChannel': ifdhandler.c:294:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 7 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHPolling': ifdhandler.c:331:3:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 7 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHSleep': ifdhandler.c:346:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 7 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHStopPolling': ifdhandler.c:367:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 7 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHGetCapabilities':
	  ifdhandler.c:401:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 6 has type `DWORD' [-Wformat]
	  ifdhandler.c:401:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 8 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHSetCapabilities':
	  ifdhandler.c:660:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 6 has type `DWORD' [-Wformat]
	  ifdhandler.c:660:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 8 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHSetProtocolParameters':
	  ifdhandler.c:702:2: warning: format `%d' expects argument of type
	  `int', but argument 6 has type `DWORD' [-Wformat]
	  ifdhandler.c:702:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 8 has type `DWORD' [-Wformat]
	  ifdhandler.c:920:5: warning: format `%d' expects argument of type
	  `int', but argument 6 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHPowerICC': ifdhandler.c:1153:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 8 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHTransmitToICC':
	  ifdhandler.c:1283:2: warning: format `%X' expects argument of
	  type `unsigned int', but argument 7 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHControl': ifdhandler.c:1325:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 6 has type `DWORD' [-Wformat] ifdhandler.c:1325:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 8 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHICCPresence': ifdhandler.c:1616:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 7 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHCreateChannelByName':
	  ifdhandler.c:80:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 6 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHCreateChannel':
	  ifdhandler.c:201:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 6 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHCloseChannel': ifdhandler.c:294:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 7 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHGetCapabilities':
	  ifdhandler.c:401:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 6 has type `DWORD' [-Wformat]
	  ifdhandler.c:401:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 8 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHSetCapabilities':
	  ifdhandler.c:660:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 6 has type `DWORD' [-Wformat]
	  ifdhandler.c:660:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 8 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHSetProtocolParameters':
	  ifdhandler.c:702:2: warning: format `%d' expects argument of type
	  `int', but argument 6 has type `DWORD' [-Wformat]
	  ifdhandler.c:702:2: warning: format `%X' expects argument of type
	  `unsigned int', but argument 8 has type `DWORD' [-Wformat]
	  ifdhandler.c:920:5: warning: format `%d' expects argument of type
	  `int', but argument 6 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHPowerICC': ifdhandler.c:1153:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 8 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHTransmitToICC':
	  ifdhandler.c:1283:2: warning: format `%X' expects argument of
	  type `unsigned int', but argument 7 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHControl': ifdhandler.c:1325:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 6 has type `DWORD' [-Wformat] ifdhandler.c:1325:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 8 has type `DWORD' [-Wformat]
	  
	  ifdhandler.c: In function `IFDHICCPresence': ifdhandler.c:1616:2:
	  warning: format `%X' expects argument of type `unsigned int', but
	  argument 7 has type `DWORD' [-Wformat]
	* [r5870] src/ccid_usb.c: Fix compiler warning
	  
	  ccid_usb.c: In function `OpenUSBByName': ccid_usb.c:245:2:
	  warning: format `%s' expects argument of type `char *', but
	  argument 6 has type `void *' [-Wformat] ccid_usb.c:246:2:
	  warning: format `%s' expects argument of type `char *', but
	  argument 6 has type `void *' [-Wformat] ccid_usb.c:247:2:
	  warning: format `%s' expects argument of type `char *', but
	  argument 6 has type `void *' [-Wformat]

2011-07-06  Ludovic Rousseau

	* [r5839] src/commands.c: T0ProcSW1(): remove 2 useless variables
	  after revision 5834
	  
	  commands.c: In function 'T0ProcSW1': commands.c:1794: warning:
	  unused variable 'rcv_len_tmp' commands.c:1793: warning: unused
	  variable 'rcv_buf_tmp'
	* [r5838] src/ifdhandler.c: Fix compiler warning
	  
	  ifdhandler.c: In function ‘IFDHGetCapabilities’:
	  ifdhandler.c:612: warning: implicit declaration of function
	  ‘strlcpy’ ifdhandler.c:612: warning: nested extern declaration of
	  ‘strlcpy’
	* [r5837] src/ccid_serial.c: Add #include "strlcpycat.h"
	  
	  coverity: Event implicit_func_decl: function "strlcpy" declared
	  implicitly
	* [r5836] src/debug.c: log_xxd(): use safer snprintf() instead of
	  sprintf()
	  
	  coverity: Event secure_coding: [VERY RISKY]. Using "sprintf" can
	  cause a buffer overflow when done incorrectly. Because sprintf()
	  assumes an arbitrarily long string, callers must be careful not
	  to overflow the actual space of the destination. Use snprintf()
	  instead, or correct precision specifiers.
	* [r5835] src/commands.c: CmdEscape(): fix a memory leak
	  
	  coverity: Event leaked_storage: Variable "cmd_out" going out of
	  scope leaks the storage it points to.
	* [r5834] src/commands.c: T0ProcSW1(): remove dead code.
	  
	  The case (return_value != IFD_SUCCESS) is already treated a few
	  lines above.
	  
	  coverity: Event dead_error_begin: Execution cannot reach this
	  statement "rcv_buf_tmp[0] = rcv_buf_tm...".
	* [r5833] src/ccid_serial.c: OpenSerialByName(): use safer
	  strlcpy() instead of strncpy()
	  
	  coverity: Event buffer_size_warning: Calling strncpy with a
	  maximum size argument of 255 bytes on destination array
	  "reader_name" of size 255 bytes might leave the destination
	  string unterminated.

2011-07-05  Ludovic Rousseau

	* [r5832] src/ifdhandler.c: IFDHGetCapabilities(): use strlcpy()
	  instead of the insecure strcpy
	  
	  No problem was expected since pcsc-lite uses a big buffer.
	  
	  coverity: Event secure_coding: [VERY RISKY]. Using "strcpy" can
	  cause a buffer overflow when done incorrectly. If the destination
	  string of a strcpy() is not large enough then anything might
	  happen. Use strncpy() instead.
	* [r5829] src/commands.c: CmdXfrBlockAPDU_extended(): Initialize
	  local_rx_length
	  
	  Silence coverity: Event uninit_use_in_call: Using uninitialized
	  value "local_rx_length" when calling "CCID_Receive".
	* [r5828] src/parse.c: Fix a UNREACHABLE coverity error
	  
	  Code after the goto was dead code
	* [r5827] src/ccid_usb.c: OpenUSBByName(): readerID is also needed
	  on Mac OS X
	  
	  Partly reverting revision r5816

2011-06-30  Ludovic Rousseau

	* [r5816] src/ccid_usb.c: Fix compiler warnings
	  
	  ccid_usb.c: In function 'OpenUSBByName': ccid_usb.c:324: warning:
	  unused variable 'readerID'

2011-06-29  Ludovic Rousseau

	* [r5815] configure.in: Enable silent build by default

2011-06-16  Ludovic Rousseau

	* [r5800] readers/supported_readers.txt: Update OBERTHUR
	  TECHNOLOGIES ID-ONE TOKEN SLIM v2 reader name on request of F.
	  Bourgault
	* [r5799] readers/Oberthur-ID-ONE_token_slim_v2.txt: New firmware

2011-06-13  Ludovic Rousseau

	* [r5789] src/commands.c: SecurePINModify(): update comment for a
	  GemPC pinpad bug circumvention hack
	* [r5788] src/commands.c: Rename bNumberMessages in bNumberMessage
	  (singular) to conform to the CCID specification names

2011-06-12  Ludovic Rousseau

	* [r5787] examples/scardcontrol.c: Do not reference secoder_info
	  for properties_in_tlv_ioctl tag

2011-05-18  Ludovic Rousseau

	* [r5761] readers/AU9540.txt, readers/supported_readers.txt: Add
	  Alcor Micro AU9540

2011-05-13  Ludovic Rousseau

	* [r5746] configure.in: Use AC_LANG_SOURCE to fix a warning from
	  autoconf 2.68
	  
	  configure.in:151: warning: AC_LANG_CONFTEST: no AC_LANG_SOURCE
	  call detected in body
	* [r5742] README, configure.in: Release 1.4.4
	* [r5741] README: Some minor corrections

2011-05-12  Ludovic Rousseau

	* [r5740] src/ccid.h, src/ccid_usb.c: OpenUSBByName(): Some early
	  Gemalto Ezio CB+ readers have bDeviceClass, bDeviceSubClass and
	  bDeviceProtocol set to 0xFF (proprietary) instead of 0x00.
	  
	  So on Mac OS X the reader configuration is not done by the
	  OS/kernel and we do it ourself.
	* [r5739] src/ccid_usb.c: OpenUSBByName(): move declaration of
	  readerID outside of the USE_COMPOSITE_AS_MULTISLOT case so that
	  the variable can also be used elsewhere
	* [r5738] src/ccid_usb.c: OpenUSBByName(): remove a (useless) { }
	  block level
	* [r5737] src/ccid_usb.c: OpenUSBByName(): log the error code
	  returned by libusb_get_active_config_descriptor() if any

2011-05-09  Ludovic Rousseau

	* [r5731] readers/supported_readers.txt: Add Gemalto Ezio Shield
	  Secure Channel, Gemalto Ezio Shield PinPad and Gemalto Ezio
	  Generic
	* [r5728] readers/GemCorePOSPro.txt: Add Gemalto GemCore POS Pro
	* [r5727] src/ifdhandler.c: init_driver(): do not fail if the
	  Info.plist file is not found
	  
	  This may happen if the driver for the serial GemPC Twin is used
	  but the USB driver is NOT installed (no .bundle directory).
	  
	  Thanks to Frederic Dumas for the bug report.
	* [r5726] readers/Gemalto_Ezio_CB+.txt,
	  readers/supported_readers.txt: Add Gemalto Ezio CB+
	* [r5725] src/ifdhandler.c: Add support of TLV Properties
	  wLcdMaxCharacters and wLcdMaxLines They just duplicate wLcdLayout
	* [r5724] examples/scardcontrol.c: Add table for bMsgIndex[1-3] and
	  correctly set bMsgIndex2 and bMsgIndex3
	* [r5723] examples/scardcontrol.c: Update copyright
	* [r5722] examples/scardcontrol.c: Add table for
	  bEntryValidationCondition
	* [r5718] readers/Gemalto_Ezio_Shield.txt,
	  readers/supported_readers.txt: Add Gemalto Ezio Shield

2011-05-07  Ludovic Rousseau

	* [r5716] src/Makefile.am: Use $(sysconfdir) instead of hardcoded
	  "etc" in install_ccidtwin rule
	* [r5715] configure.in: Reuse the definition of $usbdropdir to
	  define the default value of ccidtwindir
	  
	  It is important if --enable-usbdropdir=DIR is used and
	  `$PKG_CONFIG libpcsclite --variable=usbdropdir` should then not
	  be used.

2011-04-22  Ludovic Rousseau

	* [r5706] src/92_pcscd_ccid.rules: Activate USB automatic power
	  suspend. The Linux kernel should power off the reader
	  automatically if it is not used (pcscd is not running).
	  
	  Documentation from
	  http://www.lesswatts.org/projects/devices-power-management/usb.php
	  
	  Closes: alioth bug [#311273] CCID driver: Enable USB selective
	  suspend when possible

2011-04-14  Ludovic Rousseau

	* [r5698] readers/MSI_StarReader_SMART.txt: firmware update

2011-04-08  Ludovic Rousseau

	* [r5695] src/ifdhandler.c: T0_card_timeout/T1_card_timeout: set
	  timeout to 60 seconds instead of 60 milliseconds if the ATR is
	  non ISO

2011-04-07  Ludovic Rousseau

	* [r5693] readers/HP_kus-0133.txt, readers/supported_readers.txt,
	  src/ccid_usb.c: Firmware 1.24 of the HP USB CCID Smartcard
	  Keyboard fixes the problem reported with the 1.22. But the pinpad
	  is (still) bogus.

2011-04-02  Ludovic Rousseau

	* [r5688] README, configure.in: release 1.4.3

2011-03-30  Ludovic Rousseau

	* [r5681] readers/LTC31v2.txt: firmware update

2011-03-28  Ludovic Rousseau

	* [r5678] readers/Feitian_ePass2003_PKI.txt,
	  readers/supported_readers.txt: Add Feitian ePass2003

2011-03-26  Ludovic Rousseau

	* [r5672] src/ccid_usb.c: Fix a stupid bug in the previous revision
	* [r5671] src/ccid_usb.c: OpenUSBByName(): check the value returned
	  by libusb_init()

2011-03-23  Ludovic Rousseau

	* [r5666] src/ccid.c, src/ccid.h: the Secure Pin Entry of the HP
	  USB Smart Card Keyboard is bogus so disable it
	  
	  http://martinpaljak.net/2011/03/19/insecure-hp-usb-smart-card-keyboard/

2011-03-18  Ludovic Rousseau

	* [r5660] src/ccid.c: ccid_error(): simplify code and avoids a
	  "clang --analyze" warning
	  
	  ccid.c:490:5: warning: Value stored to 'text' is never read text
	  = var_text; ^ ~~~~~~~~

2011-03-14  Ludovic Rousseau

	* [r5656] readers/SCM_SCL011.txt, readers/supported_readers.txt:
	  Add SCM SCL011

2011-03-13  Ludovic Rousseau

	* [r5654] configure.in: Use the same code as in pcsc-lite to detect
	  the plateform name (BUNDLE_HOST)

2011-03-09  Ludovic Rousseau

	* [r5651] readers/Vasco_Digipass920.txt,
	  readers/supported_readers.txt: Add Vasco DIGIPASS 920

2011-03-08  Ludovic Rousseau

	* [r5645] readers/Neowave_Weneo4.txt,
	  readers/supported_readers.txt: Add a new Neowave Weneo reader

2011-02-25  Ludovic Rousseau

	* [r5640] contrib/Kobil_mIDentity_switch/Makefile.am,
	  contrib/RSA_SecurID/Makefile.am: Do not install
	  RSA_SecurID_getpasswd and Kobil_mIDentity_switch and the
	  associated documentation.
	  
	  Only very few people need these tools. Adding them bring a
	  dependency on libpcsclite (see Debian bug #612972 "libccid:
	  circular dependency with pcscd and libpcsclite1")
	* [r5639] src/ccid_usb.c: Use the :libudev: instead of :libhal:
	  naming scheme. It is supported by pcsc-lite since revision 5638.
	  
	  It is only usefull for USB devices with more than one CCID
	  interface.
	* [r5637] src/ifdhandler.c: get_IFSC(): parse TA byte before TD
	  byte for a same iteration. So that TA3 is parsed before TD3 and
	  the IFSC is correctly parsed in an ATR like: 3B F0 12 00 FF 91 81
	  B1 7C 45 1F 03 99
	  
	  Thanks to Toshimune Konno for the bug report

2011-02-22  Ludovic Rousseau

	* [r5626] README, configure.in: release 1.4.2
	* [r5625] readers/supported_readers.txt: Add Xiring MyLeo
	* [r5622] readers/Aktiv_Rutoken_Lite.txt,
	  readers/supported_readers.txt: Add Aktiv Rutoken lite

2011-02-20  Ludovic Rousseau

	* [r5620] bootstrap: Use /bin/sh instead of bash
	  
	  bash is installed in /usr/local on FreeBSD

2011-02-16  Ludovic Rousseau

	* [r5615] readers/Broadcom_5880v4.txt: Add another Broadcom 5880
	  with PID = 0x5802 This one is a dual interface
	  contact/contactless
	* [r5614] readers/GemProxDU.txt, readers/GemProxDU_contact.txt,
	  readers/GemProxDU_contactless.txt, readers/GemProxSU.txt,
	  readers/GemProxSU_contact.txt, readers/GemProxSU_contactless.txt:
	  Concat the 2 interfaces of the GemProxDU and GemProxSU in only 1
	  .txt file each now that matrix.py can support it
	* [r5599] src/parse.c: Align the number of lines and characters per
	  line in wLcdLayout parse

2011-02-13  Ludovic Rousseau

	* [r5596] readers/ATMEL_AT91SO.txt, readers/CardMan3821.txt,
	  readers/GemPCPinpadv2.txt, readers/Kobil_EMV_CAP.txt,
	  readers/Kobil_mIDentity_visual.txt,
	  readers/Todos_Connectable.txt, readers/Todos_Cx00.txt,
	  readers/Vasco_DP855.txt, readers/Vasco_DP865.txt,
	  readers/Xiring_Leov2.txt, readers/Xiring_MyLeo.txt,
	  readers/Xiring_XI-SIGN.txt, readers/Xiring_XI-SIGN_6000.txt:
	  Correctly parse wLcdLayout (the 2 bytes were interverted)
	* [r5595] src/parse.c: The bytes for wLcdLayout were interverted
	* [r5594] examples/scardcontrol.c: Use a SCARD_SHARE_SHARED instead
	  of SCARD_SHARE_DIRECT since we are really talking to the card,
	  not just to the reader. So SCardConnect() has to power on the
	  card if needed.

2011-02-11  Ludovic Rousseau

	* [r5593] src/Makefile.am: Do not add the version to the library
	  name
	  
	  Thanks to Diego Elio Pettenò for the idea
	* [r5592] src/Makefile.am: make parse a noinst_PROGRAMS
	  
	  Thanks to Diego Elio Pettenò for the idea

2011-02-09  Ludovic Rousseau

	* [r5586] readers/Xiring_MyLeo.txt: Add Xiring MyLeo reader

2011-02-04  Ludovic Rousseau

	* [r5578] src/commands.c: CmdXfrBlockCHAR_T0(): use 'int' instead
	  of 'char' for backup_len variable since it can contain up to 256.
	  
	  Thanks to el Tuba for the patch.

2011-01-29  Ludovic Rousseau

	* [r5570] readers/supported_readers.txt: Add Xiring Leo v2
	* [r5565] readers/Xiring_Leov2.txt: New firmware release

2011-01-28  Ludovic Rousseau

	* [r5563] contrib/RSA_SecurID/RSA_SecurID_getpasswd.c: Correctly
	  display the 2 last bytes (status word) instead of potentially
	  garbage in the received buffer.
	* [r5562] contrib/RSA_SecurID/RSA_SecurID_getpasswd.c: Correctly
	  identify the command numbers in the error messages

2011-01-20  Ludovic Rousseau

	* [r5542] src/openct/proto-t1.c: t1_xcv(): remove useless
	  affectation
	  
	  openct/proto-t1.c:675:3: warning: Value stored to 'rmax' is never
	  read rmax = rmax_int; ^ ~~~~~~~~
	* [r5541] src/commands.c: SecurePINVerify() & SecurePINModify():
	  ignore the returned value of t1_build()
	  
	  commands.c:416:3: warning: Value stored to 'ret' is never read
	  ret = t1_build(&((get_ccid_slot(reader_index))->t1), ^
	  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ commands.c:653:3:
	  warning: Value stored to 'ret' is never read ret =
	  t1_build(&((get_ccid_slot(reader_index))->t1), ^
	  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	* [r5540] src/commands.c: T0ProcSW1(): remove useless affectations
	  
	  commands.c:1818:2: warning: Value stored to 'in_buf' is never
	  read in_buf++; ^~~~~~~~ commands.c:1817:2: warning: Value stored
	  to 'rcv_buf' is never read rcv_buf++; ^~~~~~~~~

2011-01-19  Ludovic Rousseau

	* [r5527] readers/iDream.txt: update

2011-01-18  Ludovic Rousseau

	* [r5516] src/openct/proto-t1.c: Add an explicit cast to avoid a
	  compiler warning
	  
	  openct/proto-t1.c:775:10: warning: comparison of integers of
	  different signs: 'int' and 'unsigned int' [-Wsign-compare] || (n
	  != 4 + t1->rc_bytes) ... ~ ^ ~~~~~~~~~~~~~~~~
	* [r5515] src/ifdhandler.c: Add an explicit cast to avoid a
	  compiler warning
	  
	  ifdhandler.c:410:16: warning: comparison of integers of different
	  signs: 'unsigned long' and 'int' [-Wsign-compare] if (*Length >=
	  CcidSlots[reader_index].nATRLength) ~~~~~~~ ^
	  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	* [r5514] src/commands.c: Add an explicit cast to avoid a compiler
	  warning
	  
	  commands.c:169:16: warning: comparison of integers of different
	  signs: 'unsigned int' and 'int' [-Wsign-compare] if (*nlength >
	  r-1) ~~~~~~~~ ^ ~~~
	* [r5513] src/commands.c: Do not redefine macro offsetof() if
	  already defined
	  
	  Thanks to clang(1) compiler commands.c:51:9: warning: 'offsetof'
	  macro redefined [-pedantic] #define offsetof(TYPE, MEMBER)
	  ((size_t) &((TYPE *)0)->MEMBER) ^ In file included from
	  commands.c:25: In file included from /usr/include/string.h:33:
	  /usr/lib/clang/1.1/include/stddef.h:41:9: note: previous
	  definition is here #define offsetof(t, d) __builtin_offsetof(t,
	  d) ^

2011-01-13  Ludovic Rousseau

	* [r5499] src/ifdhandler.c: T1_card_timeout(): This is the
	  card/reader timeout. Add 1 second for the libusb timeout so we
	  get the error from the reader.

2011-01-07  Ludovic Rousseau

	* [r5495] src/ifdhandler.c: IFDHGetCapabilities(): multi slot
	  readers does not (yet) support
	  TAG_IFD_POLLING_THREAD_WITH_TIMEOUT
	  
	  The polling function will return for a event in any slot not just
	  the slot we are interested in. And the event will be lost for the
	  real slot.
	* [r5494] src/ccid_usb.c: CloseUSB(): free the serial number string
	  only for the last slot since they all point to the same string.

2011-01-05  Ludovic Rousseau

	* [r5488] readers/Vasco_DP200.txt, readers/Vasco_DP860.txt,
	  readers/supported_readers.txt: Add Vasco DIGIPASS KEY 860 and
	  Vasco DIGIPASS KEY 200

2011-01-04  Ludovic Rousseau

	* [r5477] readers/supported_readers.txt: Sort devices by Product ID
	* [r5476] readers/supported_readers.txt: Reenable O2 Micro and
	  Blutronics "bogus" readers
	* [r5475] src/ccid.h: Reenable O2MICRO_OZ776_PATCH since a new
	  patch is now included in revision 5473
	* [r5474] src/parse.c: Use get_ccid_device_descriptor() instead of
	  using usb_interface_descriptor->extra directly to support "bogus"
	  readers
	* [r5473] src/ccid_usb.c, src/ccid_usb.h: Add and use
	  get_ccid_device_descriptor() to get the CCID descriptor including
	  a fix for bogus readers (Oz776, Reiner SCT and bludrive II)
	  
	  Thanks to Diego Elio Pettenò and Dario Leone for the patch
	* [r5472] src/parse.c: Define log level to maximum to get error
	  messages from ccid_usb.c
	* [r5471] src/parse.c: Rename variable usb_interface to
	  usb_interface_descriptor to better match the libusb type
	* [r5470] src/parse.c: Rename variable extra to device_descriptor
	* [r5465] src/.dependencies: Remove useless file

2011-01-03  Ludovic Rousseau

	* [r5463] readers/Neowave_Weneo3.txt,
	  readers/supported_readers.txt: Add a new Neowave Weneo token
	  
	  Closes Debian bug #570167 "libccid: New Neowave Weneo card
	  version with new productId"

2010-12-21  Ludovic Rousseau

	* [r5461] readers/Oberthur-ID-ONE_token_slim_v2.txt,
	  readers/supported_readers.txt: Add Oberthur ID-ONE TOKEN SLIM v2

2010-12-17  Ludovic Rousseau

	* [r5458] src/ccid_usb.c: OpenUSBByName(): return STATUS_COMM_ERROR
	  instead of STATUS_NO_SUCH_DEVICE if the cause of the failure is
	  libusb_claim_interface(). The main cause if the use of OpenCT.
	  
	  The OpenCT detection code in pcsc-lite is not triggered if the
	  driver returns STATUS_NO_SUCH_DEVICE. So the driver must return
	  someting else in that case.

2010-12-16  Ludovic Rousseau

	* [r5457] readers/GemPCPinpadv2.txt: new firmware
	* [r5455] readers/ACS_APG8201.txt, readers/supported_readers.txt:
	  Add ACS APG8201 PINhandy 1

2010-12-15  Ludovic Rousseau

	* [r5451] readers/Eutron_SIM_Pocket_Combo_(Card_Reader).txt,
	  readers/Eutron_SIM_Pocket_Combo_(SIM_Reader).txt: regenerate
	* [r5450] readers/Eutron_SIM_Pocket_Combo_(Card_Reader).txt,
	  readers/Eutron_SIM_Pocket_Combo_(SIM_Reader).txt,
	  readers/SIM_Pocket_Combo.txt: Rename and split
	  SIM_Pocket_Combo.txt in Eutron_SIM_Pocket_Combo_(Card_Reader).txt
	  and Eutron_SIM_Pocket_Combo_(SIM_Reader).txt
	  
	  The device contains a hub with 3 devices: 2 CCID card readers and
	  a USB Mass storage

2010-12-12  Ludovic Rousseau

	* [r5445] readers/supported_readers.txt: Add Feitian SCR310
	* [r5444] readers/Feitian_SCR310.txt: Feitian SCR310 reader (also
	  labeled Rokey 301)

2010-12-10  Ludovic Rousseau

	* [r5437] src/ccid_usb.c: OpenUSBByName(): use the correct type to
	  fix compiler warning
	  
	  ccid_usb.c: In function `OpenUSBByName': ccid_usb.c:294: warning:
	  comparison between signed and unsigned integer expressions
	* [r5436] readers/Todos_Connectable.txt: Todos Connectable reader

2010-12-03  Ludovic Rousseau

	* [r5430] README, configure.in: release 1.4.1

2010-12-01  Ludovic Rousseau

	* [r5425] readers/Fsij_gnuk.txt, readers/supported_readers.txt: Add
	  Free Software Initiative of Japan Gnuk token

2010-11-20  Ludovic Rousseau

	* [r5409] readers/SpringCard_CSB6_Ultimate.txt: new firmware

2010-11-17  Ludovic Rousseau

	* [r5404] readers/Xiring_Leov2.txt: Add Xiring Leo v2
	* [r5403] src/parse.c: define DISPLAY_EXTRA_VALUES to display the
	  extra (invalid) values returned by bNumClockSupported and
	  bNumDataRatesSupported

2010-11-12  Ludovic Rousseau

	* [r5397] readers/Athena_IDProtect_Key.txt,
	  readers/supported_readers.txt, src/ccid_usb.c: Athena IDProtect
	  Key v1 was bogus. The v2 should work.
	* [r5396] readers/CardMan6121.txt: Regenerate

2010-11-08  Ludovic Rousseau

	* [r5389] src/ifdhandler.c: IFDHCreateChannelByName(): increase the
	  timeout from 100ms to 1000ms to give more time to the reader to
	  setup and answer.
	  
	  100ms is too short for the Kobil KAAN Base for example.

2010-11-05  Ludovic Rousseau

	* [r5382] src/ccid_serial.c: ReadSerial(): further improve check
	  from revision 5381
	* [r5381] src/ccid_serial.c: ReadSerial(): avoids a possible
	  integer overflow if the CCID frame is corrupted or malign.
	  
	  Thanks to Rafael Dominguez Vega for the bug report

2010-10-27  Ludovic Rousseau

	* [r5365] readers/BZH_uKeyCI800-K1.txt,
	  readers/supported_readers.txt: Add BZH uKeyCI800-K18

2010-10-26  Ludovic Rousseau

	* [r5363] readers/supported_readers.txt: Normalize the Vid and Pid
	  hex values
	* [r5361] readers/SCR3310_2.txt, readers/supported_readers.txt: Add
	  a new model of SCM SCR 3310
	* [r5360] readers/Akasa_AK-CR-03.txt: Add Akasa AK-CR-03 reader

2010-10-21  Ludovic Rousseau

	* [r5330] src/ifdhandler.c: Use TAG_IFD_POLLING_THREAD_WITH_TIMEOUT
	  instead of TAG_IFD_POLLING_THREAD to support the auto power off
	  feature introduced in pcsc-lite revision 5328
	* [r5329] src/ifdhandler.c: Remove two useless static function
	  declarations

2010-10-19  Ludovic Rousseau

	* [r5325] src/ifdhandler.c: get_IFSC(): 0xFF is not a valid value
	  for IFSC according to ISO 7816-3, CCID and MasterCard standards.
	  The maximum value is 0xFE.
	  
	  The "TIVU SAT" from ITALY www.tivu.tv card has such an IFSC in
	  its ATR: 3F FF 95 00 FF 91 81 71 FF 47 00 54 49 47 45 52 30 30 33
	  20 52 65 76 32 35 30 64

2010-10-14  Ludovic Rousseau

	* [r5320] src/Makefile.am: src/pcscd_ccid.rules has been renamed to
	  src/92_pcscd_ccid.rules in revision 5263. So update the name in
	  INSTALL_UDEV_RULE_FILE
	* [r5319] src/Makefile.am: Use /bin/echo instead of the echo shell
	  version to use color escape codes
	  
	  Thanks to Martin Paljak for the patch
	* [r5318] configure.in, src/Info.plist.src, src/Makefile.am,
	  src/create_Info_plist.pl: Remove --enable-udev option since it is
	  not used anymore with libhal. The udev rules file is now used to
	  change the access rights of the device and not send a hotplug
	  signal to pcscd.

2010-10-13  Ludovic Rousseau

	* [r5312] configure.in: Need pcsc-lite 1.6.5 for
	  TAG_IFD_POLLING_THREAD_WITH_TIMEOUT
	* [r5311] src/Makefile.am: pcscd_ccid.rules is renamed
	  92_pcscd_ccid.rules in revision 5263
	* [r5310] Makefile.am: MacOSX/reader.h.in is now replaced by
	  MacOSX/reader.h since pcsc-lite revision 5254
	* [r5309] configure.in: build: remove use_usb_interrupt variable
	  which is not set.
	  
	  Thanks to Martin Paljak for the patch

2010-10-06  Ludovic Rousseau

	* [r5284] README: Update some paragraphs
	* [r5282] README: Remove the "Known problems" section about Mac OS
	  X libusb since we know use libusb-1.0. The bug should/may have
	  been fixed.

2010-09-20  Ludovic Rousseau

	* [r5263] src/92_pcscd_ccid.rules, src/pcscd_ccid.rules: Rename to
	  add the number in the file name. The file shall be _after_
	  91-permissions.rules on Debian.
	  
	  See http://permalink.gmane.org/gmane.linux.hotplug.devel/16139

2010-09-15  Ludovic Rousseau

	* [r5257] MacOSX/configure, MacOSX/reader.h, MacOSX/reader.h.in: No
	  need to convert reader.h.in in reader.h since revision 5252.

2010-09-14  Ludovic Rousseau

	* [r5253] examples/scardcontrol.c: No need to use HOST_TO_CCID_16()
	  and HOST_TO_CCID_32() since revision 5252
	* [r5252] src/commands.c: SecurePINVerify() & SecurePINModify():
	  Accept big and little endian byte orders for multibytes fields
	  
	  The application should not use HOST_TO_CCID_16() and
	  HOST_TO_CCID_32() any more and just use the normal byte order of
	  the architecture.
	  
	  Thanks to Douglas E. Engert for the patch
	  http://archives.neohapsis.com/archives/dev/muscle/2010-q3/0145.html

2010-09-13  Ludovic Rousseau

	* [r5251] src/pcscd_ccid.rules: Use GROUP= instead of RUN+= to
	  avoid a race
	  
	  See the thread "Use GROUP= in a rule matching an interface of the
	  device?" on linux-hotplug@vger.kernel.org mailing list
	  http://www.spinics.net/lists/hotplug/msg04165.html

2010-09-04  Ludovic Rousseau

	* [r5244] src/pcscd_ccid.rules: Add a ENV{DEVTYPE}!="usb_device"
	  rule as suggested by Marco d'Itri

2010-09-03  Ludovic Rousseau

	* [r5237] readers/HP_kus-0133.txt, readers/supported_readers.txt:
	  HP kus-0133 is not supported
	* [r5236] readers/supported_readers.txt: update URL to use ccid/
	* [r5229] readers/Precise_200_MC.txt: new firmware

2010-09-02  Ludovic Rousseau

	* [r5223] src/pcscd_ccid.rules: Change the group ownership of the
	  device to "pcscd" when a reader is connected
	* [r5222] src/pcscd_ccid.rules: Add $Id$
	* [r5221] src/pcscd_ccid.rules: Factorize teh SUBSYSTEMS=="usb"
	  test

2010-08-31  Ludovic Rousseau

	* [r5207] readers/ReinerSCT_cyberJack_RFID_basis.txt,
	  readers/supported_readers.txt: Add ReinerSCT cyberJack RFID basis
	* [r5206] src/ifdhandler.c: ifdhandler.c: In function
	  ‘IFDHPolling’: ifdhandler.c:328: warning: unused variable ‘ret’
	* [r5205] src/ccid_usb.c, src/ifdhandler.c: Convert the return
	  value from libusb code to IFD_* in InterruptRead() instead of
	  IFDHPolling().
	  
	  We do not return IFD_NO_SUCH_DEVICE any more. This value will be
	  returned by the next libusb_*() call

2010-08-26  Ludovic Rousseau

	* [r5189] readers/supported_readers.txt: Remove O2 Micro Oz776 and
	  Blutronics Bludrive II CCID since they are no more supported
	  since version 1.4.0
	  
	  The USB descriptor is bogus and the patch in
	  get_ccid_usb_interface() does not work with libusb-1.0
	* [r5188] src/ifdhandler.c: IFDHSetCapabilities(): remove dead
	  comments
	* [r5187] configure.in: Add --enable-embedded (default is no) to
	  build libccid for an embedded system.
	  
	  This will activate the NO_LOG option to disable logging and limit
	  RAM and disk consumption.
	* [r5185] src/ccid_serial.c, src/ccid_usb.c, src/commands.c,
	  src/ifdhandler.c, src/utils.c: Include config.h before any other
	  local includes to the configuration defined in config.h is used.
	  
	  This is just a preventive change.

2010-08-24  Ludovic Rousseau

	* [r5182] src/ccid.c: ccid_open_hack_pre(): call InterruptRead()
	  only if the device has an interrupt pipe endpoint (3 in total)
	* [r5181] readers/supported_readers.txt: add Gemalto SG CCID

2010-08-23  Ludovic Rousseau

	* [r5176] src/ccid.c: ccid_open_hack_pre(): use InterruptRead()
	  with a timeout of 100ms instead of 10ms to give more time to the
	  device to respond.
	  
	  This allows the Gemalto SG CCID to always start correctly, not
	  just once in a while.
	* [r5174] src/ccid.c: ccid_open_hack_pre(): Do not disable the call
	  to InterruptRead() on Mac OS X. We now use libusb-1.0 and the
	  timeout should work.
	  
	  This allows the Gemalto SG CCID to work under Mac OS X.
	* [r5173] readers/Gemalto_SG.txt, readers/supported_readers.txt:
	  Add Gemalto Smart Guardian (SG CCID)
	* [r5172] readers/supported_readers.txt: Rename Gemalto Smart
	  Enterprise Guardian

2010-08-19  Ludovic Rousseau

	* [r5166] MacOSX/configure: Use the full include path for libusb.h
	* [r5165] src/Makefile.am, src/ccid_usb.c, src/ifdhandler.c,
	  src/simclist.c, src/simclist.h: Use the new Info.plist parser API
	* [r5164] src/ccid_serial.c: OpenSerialByName():
	  TOKEN_MAX_VALUE_SIZE is no more defined in parser.h
	  
	  Use MAX_DEVICENAME defined as 255 in pcscd.h

2010-08-17  Ludovic Rousseau

	* [r5153] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c,
	  src/ccid_usb.c, src/ccid_usb.h: Do not hardcode the libusb-1.0
	  include header path (remove the libusb-1.0/ part)

2010-08-05  Ludovic Rousseau

	* [r5119] configure.in: Do not hardcode the libusb.h path. The h
	  file is not at the same place on kfreebsd
	  
	  Fixes Debian bug #591782

2010-08-04  Ludovic Rousseau

	* [r5108] README, configure.in: release 1.4.0

2010-08-02  Ludovic Rousseau

	* [r5094] readers/supported_readers.txt: Add support of the SCM SDI
	  010 again. At least the contact interface can be used.
	  
	  This should not conflict with the SCM proprietary driver since
	  the CCID driver will only work with pcsc-lite > 1.6.2 and recent
	  pcsc-lite (>= 1.5.4) will load any specific driver before my
	  "Class" CCID driver.

2010-08-01  Ludovic Rousseau

	* [r5090] src/Makefile.am: Install the serial configuration find in
	  /etc/reader.conf.d/libccidtwin instead of /etc/reader.conf. pcscd
	  (>= 1.6.0) will parse all the files from /etc/reader.conf.d/
	* [r5087] readers/supported_readers.txt: Add SCM SCL01x Contactless
	  Reader (disabled since unsupported)
	* [r5086] readers/supported_readers.txt: Add Gemalto Hybrid
	  Smartcard Reader
	* [r5084] readers/Tianyu_Smart_Card_Reader.txt,
	  readers/supported_readers.txt: Add Tianyu Smart Card Reader
	* [r5083] src/ccid.c, src/commands.c: Do not #include "ccid_usb.h"
	  Compilation fails on Mac OS X for the libccidtwin library

2010-07-29  Ludovic Rousseau

	* [r5078] src/ifdhandler.c: add get_IFSC() to get the IFSC value
	  from the ATR.
	  
	  IFSC is not just the value of TAi (i>2) For example "3B 80 81 1F
	  07 19" has a TA3 but it is not the IFSC since T=15 is defined in
	  TD2 so before TA3
	* [r5077] src/ccid_usb.c: libusb <= 1.0.8 does not implement a
	  reference counter in libusb_init()/libusb_exit() for the default
	  context.
	  
	  We then use our own and unique libusb context.

2010-07-27  Ludovic Rousseau

	* [r5076] src/parse.c: check the return value of
	  libusb_get_active_config_descriptor()
	* [r5075] src/Makefile.am, src/parse.c: parse do need some parts of
	  libccid
	* [r5074] src/Makefile.am: parse do not need to be linked with
	  libccid

2010-07-26  Ludovic Rousseau

	* [r5072] src/ccid.c: ccid_open_hack_post(): update the Gemalto
	  proprietary command to switch in EMV mode. 0xA0 was an old value
	  no more used on new products.

2010-07-02  Ludovic Rousseau

	* [r5055] MacOSX/configure: No need to respecify -arch in LDFLAGS
	  since we already have the correct architectures specified in
	  CFLAGS
	* [r5054] MacOSX/configure: Fix a comment: we do not use
	  libusb-compat-0.1 any more

2010-07-01  Ludovic Rousseau

	* [r5052] src/parse.c: ccid_parse_interface_descriptor(): document
	  "USB Wake up signaling supported on card insertion and removal"
	  in dwFeatures

2010-06-30  Ludovic Rousseau

	* [r5050] readers/Broadcom_5880v3.txt,
	  readers/supported_readers.txt: Add a new Broadcom 5880 reader
	  (idProduct: 0x5802)

2010-06-29  Ludovic Rousseau

	* [r5043] src/ccid_usb.c: OpenUSBByName(): use DEBUG_CRITICAL()
	  instead of printf() to log an error

2010-06-22  Ludovic Rousseau

	* [r5034] src/ccid_usb.c: WriteUSB() & ReadUSB(): also display the
	  value returned by libusb. The error is not always reported by the
	  kernel so errno is not significant.
	* [r5033] src/debug.h: Add DEBUG_CRITICAL5() function
	* [r5030] configure.in: Request pcsc-lite 1.6.2 minimum (instead of
	  1.6.0) to have TAG_IFD_STOP_POLLING_THREAD defined
	* [r5028] src/ccid_usb.c, src/ccid_usb.h, src/ifdhandler.c: Add
	  support of TAG_IFD_STOP_POLLING_THREAD and use of the
	  asynchronous libusb API to be able to stop a transfer.
	  
	  We are now "polling" for card movements every 1 hour or once an
	  event is detected on the interrupt endpoint of the device.
	  
	  Another gain is that the driver will terminate "instantly" after
	  pcscd request instead of after a maximum of 2 seconds (previous
	  polling timeout).
	* [r5027] src/ccid_usb.c: Use ctx instead of NULL to keep the
	  information that this parameter is the libusb context.
	* [r5026] src/ccid_usb.c: OpenUSBByName(): call libusb_exit() if we
	  can't use the reader
	  
	  CloseUSB(): call libusb_exit() before exiting

2010-06-21  Ludovic Rousseau

	* [r5025] src/ccid_usb.c: OpenUSBByName(): free the libusb
	  allocated list & devices when we are done with it
	* [r5024] src/ccid_usb.c: OpenUSBByName(): call libusb_init() just
	  before the next libusb call
	* [r5019] readers/ACS_AET65.txt: add ACS AET65 (same idProduct as
	  many other ACS devices)

2010-06-19  Ludovic Rousseau

	* [r5017] readers/LTC36.txt, readers/supported_readers.txt: add
	  C3PO LTC36

2010-06-18  Ludovic Rousseau

	* [r5016] MacOSX/configure: Only link with libusb-1.0.a without the
	  0.1 compatibility layer now the library has been ported to
	  libusb-1.0 API
	* [r5015] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c:
	  use libusb_detach_kernel_driver() from libusb-1.0 instead of the
	  *_np() version

2010-06-17  Ludovic Rousseau

	* [r5014] src/ccid.c, src/ifdhandler.c: use PROTOCOL_CCID instead
	  of 0 when checking bInterfaceProtocol
	* [r5013] src/ccid.c, src/ccid.h, src/commands.c, src/ifdhandler.c:
	  Rename ICCD_A in PROTOCOL_ICCD_A, ICCD_B in PROTOCOL_ICCD_B and
	  add PROTOCOL_CCID for plain CCID
	* [r5012] src/ccid_usb.c: get_end_points(): use
	  LIBUSB_ENDPOINT_DIR_MASK instead of LIBUSB_TRANSFER_TYPE_MASK to
	  get the direction of an endpoint.
	  
	  .bulk_out field were never set and then not working (No such file
	  or directory)
	* [r5011] src/ccid_usb.c: WriteUSB() & ReadUSB(): the same function
	  libusb_bulk_transfer() is now ued to read and write to a USB
	  device. So I use "write failed" and "read failed" instead of the
	  libusb function name to log an error.
	* [r5010] src/ccid_usb.c: WriteUSB(), ReadUSB() & InterruptRead():
	  display strerror(errno) instead of just the code returned by the
	  libusb_*_transfer() function

2010-06-16  Ludovic Rousseau

	* [r5007] readers/Todos_Cx00.txt, readers/supported_readers.txt:
	  add Todos CX00
	* [r5002] readers/Dectel_CI692.txt, readers/supported_readers.txt:
	  add Dectel CI692
	* [r5001] readers/Kingtrust_Multi-Reader.txt,
	  readers/supported_readers.txt: add Kingtrust Multi-Reader
	* [r4999] SCARDGETATTRIB.txt: replace tabs by spaces
	* [r4998] SCARDGETATTRIB.txt: add SCARD_ATTR_ICC_INTERFACE_STATUS,
	  SCARD_ATTR_ICC_PRESENCE and SCARD_ATTR_VENDOR_IFD_SERIAL_NO
	* [r4997] SCARDCONTOL.txt: add IOCTL_FEATURE_GET_TLV_PROPERTIES

2010-06-14  Ludovic Rousseau

	* [r4993] src/ccid_usb.c: use libusb-1.0/libusb.h instead of usb.h
	  (from libusb-0.1)

2010-06-10  Ludovic Rousseau

	* [r4988] src/ccid.h: The O2MICRO OZ776 patch (for OZ776,
	  OZ776_7772, REINER_SCT and BLUDRIVEII_CCID) is no more supported
	  with libusb-1.0
	* [r4987] configure.in,
	  contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c,
	  src/ccid_usb.c, src/ccid_usb.h, src/ifdhandler.c, src/parse.c:
	  Use libusb-1.0 instead of libusb-0.1

2010-06-04  Ludovic Rousseau

	* [r4979] README, configure.in: release 1.3.13

2010-06-01  Ludovic Rousseau

	* [r4975] readers/GemPCTwin.txt: update
	* [r4973] src/ccid.c, src/ccid.h, src/ccid_ifdhandler.h,
	  src/ccid_serial.c, src/ccid_serial.h, src/ccid_usb.c,
	  src/ccid_usb.h, src/commands.h, src/convert_version.pl,
	  src/create_Info_plist.pl, src/debug.c, src/debug.h, src/defs.h,
	  src/ifdhandler.c, src/parse.c, src/utils.c, src/utils.h: update
	  copyright date
	* [r4972] src/parse.c: No need to #include <usb.h> since revision
	  4907
	* [r4971] configure.in: remove duplicate errno.h in
	  AC_CHECK_HEADERS()
	* [r4970] configure.in, m4/as-ac-expand.m4: Correctly display
	  $bindir and $sysconfdir values when they are not changed from the
	  default values (instead of NONE/bin and NONE/etc)

2010-05-27  Ludovic Rousseau

	* [r4965] readers/Lenovo.txt: update
	* [r4963] src/ccid_usb.c: OpenUSBByName(): allow the combination of
	  USE_COMPOSITE_AS_MULTISLOT and libhal. It does work so do not
	  prevent its use.

2010-05-20  Ludovic Rousseau

	* [r4956] src/ccid.h, src/ccid_serial.c, src/ccid_usb.c,
	  src/ifdhandler.c: Add support of SCARD_ATTR_VENDOR_IFD_SERIAL_NO

2010-05-15  Ludovic Rousseau

	* [r4943] readers/GemPCPinpadv2.txt: Gemalto PC pinpad v1+

2010-05-10  Ludovic Rousseau

	* [r4939] src/commands.c: Revert revision 4936 (stupid me)
	* [r4938] src/ifdhandler.c: IFDHCreateChannelByName() &
	  IFDHCreateChannel(): use the low level CmdGetSlotStatus() instead
	  of IFDHICCPresence() to be able to fix the read timeout.
	  
	  We use a read timeout of 100 milliseconds instead of 2 secondes.
	  The maximum wait time is now 200 milliseconds instead of 4
	  seconds.
	  
	  This increases the startup time a lot (up to 95%) when pcscd is
	  auto started.
	* [r4937] src/ccid.c, src/ccid.h, src/ccid_serial.c,
	  src/ccid_usb.c, src/commands.c, src/defs.h, src/ifdhandler.c:
	  change read timeout from second to millisecond unit to have a
	  sub-second control
	* [r4936] src/commands.c: SecurePINVerify() & SecurePINModify():
	  use min() instead of max() to get a minimum of 30 seconds for the
	  read timeout

2010-05-08  Ludovic Rousseau

	* [r4932] configure.in: Minimum version of pcsc-lite is 1.6.0
	  instead of the unreleased 1.5.6
	* [r4931] README, configure.in: release 1.3.12

2010-05-07  Ludovic Rousseau

	* [r4930] MacOSX/configure: - use libusb-1.0 and libusb-compat-0.1
	  - build for Snow Leopard
	* [r4928] src/ifdhandler.c: IFDHControl(): set
	  PCSCv2_PART10_PROPERTY_bEntryValidationCondition specific value
	  only for the Gemalto PC Pinpad V1 & Covadis Véga-Alpha readers.
	* [r4927] examples/scardcontrol.c: Reformat output
	* [r4926] src/ifdhandler.c: IFDHControl(): The Covadis Véga-Alpha
	  share the same firmware with the Gemalto PC Pinpad V1
	* [r4925] src/ifdhandler.c: IFDHControl(): add comments
	* [r4924] src/ifdhandler.c: IFDHControl(): add support of
	  IOCTL_FEATURE_GET_TLV_PROPERTIES bMinPINSize & bMaxPINSize for
	  Gemalto Pinpad V1

2010-05-03  Ludovic Rousseau

	* [r4914] readers/SCR3500.txt: add SCM SCR3500 (same idProduct as
	  SCR355 but different firmware)

2010-05-02  Ludovic Rousseau

	* [r4908] readers/Athena_IDProtect_Key.txt,
	  readers/supported_readers.txt: add Athena IDProtect Key
	  (unsupported see
	  http://www.opensc-project.org/pipermail/opensc-user/2010-May/004023.html)

2010-05-01  Ludovic Rousseau

	* [r4907] src/ccid_usb.h: Do not try to be smart and always
	  #include <usb.h>
	  
	  Should fix FreeBSD issues

2010-04-29  Ludovic Rousseau

	* [r4902] src/commands.c: SecurePINVerify() & SecurePINModify():
	  with a TPDU reader and a T=1 card the ns & nr sequence numbers
	  were not correctly handled if the CCID command was rejected at
	  the reader level (not sent to the card). The next APDU sent to
	  the card would fail.

2010-04-25  Ludovic Rousseau

	* [r4897] src/ifdhandler.c: IFDHControl(): reuse ccid_descriptor
	  variable when available
	* [r4896] src/ccid.h, src/ifdhandler.c: FEATURE_MCT_READER_DIRECT
	  is also supported by the Kobil mIDentity visual

2010-04-24  Ludovic Rousseau

	* [r4893] readers/Kobil_Smart_Token.txt,
	  readers/Kobil_mIDentity_4smart.txt,
	  readers/Kobil_mIDentity_4smart_AES.txt,
	  readers/Kobil_mIDentity_fullsize.txt,
	  readers/Kobil_mIDentity_fullsize_AES.txt,
	  readers/Kobil_mIDentity_visual.txt,
	  readers/supported_readers.txt: add KOBIL Smart Token, KOBIL
	  mIDentity 4smart, KOBIL mIDentity 4smart AES, KOBIL mIDentity
	  visual, KOBIL mIDentity fullsize, KOBIL mIDentity 4smart fullsize
	  AES

2010-04-18  Ludovic Rousseau

	* [r4886] src/commands.c: CmdXfrBlockCHAR_T0(): debug ICCD type A
	  algorithm
	  
	  Thanks to Alexander Abarzhi for the patch

2010-04-16  Ludovic Rousseau

	* [r4879] src/ifdhandler.c: Fix Studio CC warning "ifdhandler.c",
	  line 1275: warning: initializer does not fit or is out of range:
	  248
	* [r4878] src/ifdhandler.c: Fix Sun Studio CC warnings
	  "ifdhandler.c", line 910: warning: initializer does not fit or is
	  out of range: 250 "ifdhandler.c", line 910: warning: initializer
	  does not fit or is out of range: 255 "ifdhandler.c", line 910:
	  warning: initializer does not fit or is out of range: 129
	  "ifdhandler.c", line 911: warning: initializer does not fit or is
	  out of range: 128 "ifdhandler.c", line 911: warning: initializer
	  does not fit or is out of range: 193 "ifdhandler.c", line 911:
	  warning: initializer does not fit or is out of range: 192
	  "ifdhandler.c", line 912: warning: initializer does not fit or is
	  out of range: 144 "ifdhandler.c", line 912: warning: initializer
	  does not fit or is out of range: 177
	* [r4876] readers/SCL01x.txt: SCM SCL01x Contactless Reader

2010-04-09  Ludovic Rousseau

	* [r4869] readers/ATMEL_AT90SCR050.txt,
	  readers/ATMEL_AT90SCR100.txt, readers/ATMEL_VaultIC420.txt,
	  readers/ATMEL_VaultIC440.txt, readers/ATMEL_VaultIC460.txt,
	  readers/supported_readers.txt: Add Atmel AT90SCR100, Atmel
	  AT90SCR050, Atmel VaultIC420, Atmel VaultIC440, Atmel VaultIC460

2010-04-06  Ludovic Rousseau

	* [r4856] readers/supported_readers.txt: Remove duplicate Vid/Pid
	  entry for Alcor Micro SCR001 and Micro AU9520
	* [r4854] readers/Vasco_DP855.txt, readers/Vasco_DP865.txt,
	  readers/Vasco_DPKey200.txt, readers/Vasco_DPKey860.txt,
	  readers/supported_readers.txt: Add Vasco DIGIPASS KEY 860, Vasco
	  DIGIPASS KEY 200, Vasco DP855, Vasco DP865

2010-03-31  Ludovic Rousseau

	* [r4849] readers/GoldKey_PIV_Token.txt,
	  readers/supported_readers.txt: add GoldKey PIV Token

2010-03-30  Ludovic Rousseau

	* [r4847] src/ccid_ifdhandler.h, src/ifdhandler.c: add support of
	  FEATURE_GET_TLV_PROPERTIES
	* [r4846] examples/scardcontrol.c: add support of
	  FEATURE_GET_TLV_PROPERTIES

2010-03-27  Ludovic Rousseau

	* [r4844] src/Info.plist.src, src/commands.c, src/ifdhandler.c:
	  remove spaces and tabs at end of line

2010-03-14  Ludovic Rousseau

	* [r4815] readers/supported_readers.txt: Enable the Broadcom 5880
	  reader. It should work after a firmware upgrade.

2010-03-12  Ludovic Rousseau

	* [r4814] INSTALL, examples/scardcontrol.c,
	  readers/supported_readers.txt, src/ccid_serial.c,
	  src/reader.conf.in: Rename Gemplus in Gemalto

2010-03-05  Ludovic Rousseau

	* [r4796] src/commands.c: CmdXfrBlockCHAR_T0(): limit the received
	  length to 0x1000 for ICCD Version A length is 16-bits and
	  usb_control_msg() fails with "Invalid argument" if the length is
	  > 0x100
	  
	  The same patch was already present in CmdXfrBlockAPDU_extended
	  for ICCD Version B
	  
	  Thanks to Alexander Abarzhi for the patch
	* [r4795] src/commands.c: CCID_Receive(): set the received length
	  for a ICCD Version A device
	  
	  Thanks to El Tuba for the patch

2010-02-26  Ludovic Rousseau

	* [r4780] readers/supported_readers.txt: SCM SDI 010 removed on
	  manufacturer request since not supported by my driver

2010-02-24  Ludovic Rousseau

	* [r4776] readers/supported_readers.txt: Removed Smart SBV280 on
	  manufacturer request. They use libusb directly.
	* [r4775] readers/Broadcom_5880.txt: regenerate

2010-02-23  Ludovic Rousseau

	* [r4771] readers/Covadis_Auriga.txt,
	  readers/supported_readers.txt: add Covadis Auriga

2010-02-12  Ludovic Rousseau

	* [r4761] readers/id3_CL1356D.txt, readers/supported_readers.txt:
	  id3_CL1356D.txt is a duplicate of id3_CL1356T5.txt
	* [r4759] readers/id3_CL1356T5.txt, readers/supported_readers.txt:
	  add id3 CL1356T5
	* [r4757] readers/Gemalto_PDT.txt, readers/supported_readers.txt:
	  update Gemalto PDT

2010-02-09  Ludovic Rousseau

	* [r4750] src/ccid_usb.c: Fix 1 compiler warning
	  
	  ccid_usb.c: In function ‘InterruptRead’: ccid_usb.c:987: warning:
	  pointer targets in passing argument 3 of ‘log_xxd’ differ in
	  signedness /usr/include/PCSC/debuglog.h:83: note: expected ‘const
	  unsigned char *’ but argument is of type ‘char *’
	* [r4749] src/commands.c: Fix 2 compiler warnings
	  
	  commands.c: In function ‘CCID_Transmit’: commands.c:1107:
	  warning: passing argument 5 of ‘ControlUSB’ discards qualifiers
	  from pointer target type ccid_usb.h:43: note: expected ‘unsigned
	  char *’ but argument is of type ‘const unsigned char *’
	  commands.c:1130: warning: passing argument 5 of ‘ControlUSB’
	  discards qualifiers from pointer target type ccid_usb.h:43: note:
	  expected ‘unsigned char *’ but argument is of type ‘const
	  unsigned char *’
	* [r4748] src/ccid_usb.c: Fix a compiler warning
	  
	  ccid_usb.c: In function ‘OpenUSB’: ccid_usb.c:138: warning:
	  unused parameter ‘Channel’
	* [r4747] readers/Makefile.am: Do not include the reader
	  descriptions in the archive, only the supported_readers.txt file
	* [r4746] Makefile.am, configure.in: use readers/ again (revert
	  revision 4745)
	* [r4745] Makefile.am, configure.in: Do not include the readers/*
	  files in the archive

2010-02-05  Ludovic Rousseau

	* [r4712] readers/CL1356T.txt, readers/id3_CL1356T.txt: rename
	  CL1356T.txt in id3_CL1356T.txt like the other id3_* readers

2010-02-04  Ludovic Rousseau

	* [r4709] src/commands.c: add Copyright (C) 2005 Martin Paljak and
	  update my copyright date

2010-01-29  Ludovic Rousseau

	* [r4694] readers/GPFCryptoStick.txt,
	  readers/supported_readers.txt: add German Privacy Foundation
	  Crypto Stick v1.2

2010-01-22  Ludovic Rousseau

	* [r4684] configure.in: use LT_INIT(disable-static) instead of the
	  deprecated AM_DISABLE_STATIC

2010-01-21  Ludovic Rousseau

	* [r4680] configure.in: Static lib is disabled by default. Use
	  --enable-static if needed

2010-01-19  Ludovic Rousseau

	* [r4676] readers/GemPC_Express.txt: update

2010-01-13  Ludovic Rousseau

	* [r4665] readers/Ask_CPL108.txt, readers/supported_readers.txt:
	  ass Ask CPL108

2010-01-11  Ludovic Rousseau

	* [r4655] readers/supported_readers.txt: update Gemalto Prox-DU and
	  Prox-SU names
	* [r4654] readers/supported_readers.txt: update "Gemalto Prox DU"
	  name

2010-01-04  Ludovic Rousseau

	* [r4639] src/debug.c: debug.c: In function ‘log_msg’: debug.c:38:
	  warning: unused parameter ‘priority’ debug.c: In function
	  ‘log_xxd’: debug.c:51: warning: unused parameter ‘priority’
	* [r4638] src/ifdhandler.c: ifdhandler.c: In function
	  ‘IFDHSetCapabilities’: ifdhandler.c:553: warning: unused
	  parameter ‘Length’ ifdhandler.c:553: warning: unused parameter
	  ‘Value’ ifdhandler.c: In function ‘IFDHTransmitToICC’:
	  ifdhandler.c:1171: warning: unused parameter ‘RecvPci’
	* [r4637] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c:
	  Kobil_mIDentity_switch.c: In function ‘main’:
	  Kobil_mIDentity_switch.c:136: warning: unused parameter ‘argc’
	  Kobil_mIDentity_switch.c:136: warning: unused parameter ‘argv’
	* [r4636] src/openct/proto-t1.c: t1_release(): fix compilation
	  warning openct/proto-t1.c:116: warning: unused parameter ‘t1’

2010-01-02  Ludovic Rousseau

	* [r4631] readers/Broadcom_5880v2.txt,
	  readers/supported_readers.txt: another Broadcom 5880 reader
	  (iProduct: 5880) which looks like to work correctly

2009-12-16  Ludovic Rousseau

	* [r4619] src/ccid_usb.c: Todos Argos Mini II with firmware before
	  1.01 has a bogus CCID descriptor: "Automatic IFSD exchange as
	  first exchange (T=1)" is missing. You can't use a T=1 card with
	  this reader.
	* [r4618] src/ccid_usb.c: Precise Biometrics Precise 250 MC with
	  firmware before 50.00 is bogus: time extension requests are not
	  sent back to the host
	* [r4617] readers/Todos_AGM2_CCID.txt: firmware 1.01

2009-12-15  Ludovic Rousseau

	* [r4614] examples/scardcontrol.c, src/ccid_ifdhandler.h,
	  src/ifdhandler.c: rename FEATURE_MCT_READERDIRECT in
	  FEATURE_MCT_READER_DIRECT

2009-12-13  Ludovic Rousseau

	* [r4610] src/ccid.c: ccid_open_hack_post(): get the language
	  selected during Mac OS X installation as language to use for
	  Covadis Véga-Alpha and Gemalto GemPC PinPad pinpad readers

2009-12-09  Ludovic Rousseau

	* [r4597] readers/Precise_250_MC.txt: firmware update
	* [r4594] src/parse.c: do not generate extra space at end of line

2009-12-05  Ludovic Rousseau

	* [r4592] src/ccid_usb.c: Precise Biometrics Precise 200 MC with
	  firmware before 50.00 is bogus: time extension requests are not
	  sent back to the host
	* [r4590] readers/supported_readers.txt: improve docmentation of
	  bogus readers
	* [r4589] readers/supported_readers.txt: add OCS ID-One Cosmo Card
	  (with ProductID 0x6356) in a commented line (unsupported)
	* [r4588] readers/Gemalto_HybridSmartcardReader.txt: Gemalto Hybrid
	  Smartcard Reader

2009-12-02  Ludovic Rousseau

	* [r4584] readers/Precise_200_MC.txt: new firmware

2009-11-18  Ludovic Rousseau

	* [r4556] readers/Oberthur-CosmoCard1.txt: other version of the OCS
	  ID-One Cosmo Card

2009-11-17  Ludovic Rousseau

	* [r4550] src/ccid.c, src/ccid.h, src/commands.c: The Covadis
	  Véga-Alpha reader is a GemPC pinpad inside. So we use the same
	  code to: - load the strings for the display - avoid limitation of
	  the reader
	  
	  Thanks to Loïs Lherbier for the patch

2009-11-13  Ludovic Rousseau

	* [r4545] src/commands.c: CmdGetSlotStatus(): the SCM SCR3310 also
	  reports an error 0xFE (ICC_MUTE) when no card is inserted. So
	  extend the special case to all readers and not just the O2MICRO
	  OZ776.
	  
	  Thanks to Ivan Vilata i Balaguer for the bug report (Debian bug
	  #555837)

2009-10-28  Ludovic Rousseau

	* [r4521] src/ccid_serial.c: set_ccid_descriptor(): reset
	  dwSlotStatus to IFD_ICC_PRESENT for the other slots of a
	  multislot reader (like a GemCore SIM Pro).
	  
	  This is needed because the state of dwSlotStatus may have already
	  been changed to IFD_ICC_NOT_PRESENT (by the polling thread) when
	  the second slot is created. The polling thread of the second slot
	  would then never check for a card since this check is only done
	  once. Slots are SAMs and the card is always present or absent.
	  
	  The problem was already dealt with on USB from the beginning but
	  not on serial.
	  
	  Thanks to Emmanuel Deloget for the patch.

2009-10-25  Ludovic Rousseau

	* [r4510] src/defs.h: change CMD_BUF_SIZE to support extended APDU
	  of up to 64kB. We need this size for readers in APDU mode to be
	  able to receive the card response in one block (chaining is not
	  always possible in this direction)
	* [r4509] src/defs.h: remove useless #define
	* [r4508] src/ifdhandler.c: FDHPowerICC(): use the exact length for
	  the PowerOn output buffer
	* [r4507] src/defs.h: remove useless #defines

2009-10-24  Ludovic Rousseau

	* [r4505] configure.in: check for IFD_ERROR_INSUFFICIENT_BUFFER in
	  ifdhandler.h and simplify the PCSC checking code

2009-10-21  Ludovic Rousseau

	* [r4502] readers/Precise_250_MC.txt: new firmware
	* [r4501] readers/Precise_200_MC.txt: new firmware

2009-10-18  Ludovic Rousseau

	* [r4499] src/ifdhandler.c: FDHGetCapabilities(): add support of
	  SCARD_ATTR_ICC_PRESENCE
	  
	  Required to support the Windows middleware that's used for French
	  Healthcar cards.
	  
	  Thanks to David Markowitz for the patch.
	* [r4498] src/ifdhandler.c: FDHGetCapabilities(): add support of
	  SCARD_ATTR_ICC_INTERFACE_STATUS
	  
	  Required to support the Windows middleware that's used for French
	  Healthcar cards.
	  
	  Thanks to David Markowitz for the patch.

2009-10-14  Ludovic Rousseau

	* [r4493] readers/Smart_SBV280.txt, readers/supported_readers.txt:
	  add Smart SBV280

2009-10-08  Ludovic Rousseau

	* [r4450] src/ccid_ifdhandler.h, src/ifdhandler.c: IFDHControl():
	  do not check if FEATURE_IFD_PIN_PROPERTIES is defined since we
	  now require pcsc-lite >= 1.5.6 (with FEATURE_IFD_PIN_PROPERTIES
	  defined)
	* [r4449] src/ifdhandler.c: IFDHGetCapabilities() & IFDHControl():
	  return IFD_ERROR_INSUFFICIENT_BUFFER when appropriate
	* [r4448] configure.in, src/commands.c: Require to have pcsc-lite
	  >= 1.5.6 to have IFD_ERROR_INSUFFICIENT_BUFFER defined in
	  ifdhandler.h
	* [r4446] src/ccid_usb.c: Use usb_strerror() instead of
	  strerror(errno) to also get the libusb specifc error messages
	* [r4441] README: The supported, should work and unsupported lists
	  are now online only.
	  
	  The information in the README file was not up to date and hard to
	  sync.

2009-10-02  Ludovic Rousseau

	* [r4417] src/ifdhandler.c: revert change in revision 4414. It is a
	  bug in the reader not the driver
	* [r4416] ylwrap: update
	* [r4414] src/ifdhandler.c: IFDHSetProtocolParameters(): with a T=1
	  card, do not try to negociate IFSD if the reader works in APDU
	  mode
	* [r4413] readers/Todos_AGM2_CCID.txt: update

2009-10-01  Ludovic Rousseau

	* [r4411] src/ifdhandler.c: IFDHControl(): typo in comment

2009-09-30  Ludovic Rousseau

	* [r4410] src/ifdhandler.c: IFDHControl(): PIN_PROPERTIES_STRUCTURE
	  structure do not have the wLcdMaxCharacters and wLcdMaxLines
	  fields anymore. Conform with Revision 2.02.06, April 2009 of
	  PCSCv2 part 10.
	  
	  Modified in pcsc-lite > 1.5.5 (revision 4378, 2009-09-08)

2009-09-28  Ludovic Rousseau

	* [r4401] src/ccid_usb.c: OpenUSBByName(): make the libhal scheme
	  parsing more robust. Readers serial "numbers" may contain '_'
	  characters

2009-09-25  Ludovic Rousseau

	* [r4397] src/ifdhandler.c: IFDHPowerICC(): remove a useless ;

2009-09-22  Ludovic Rousseau

	* [r4392] readers/CherrySmartTerminalXX7X.txt,
	  readers/supported_readers.txt: add Cherry SmartTerminal XX7X
	* [r4390] examples/GPL-2, examples/Makefile.am: sample code is
	  GPLv2+
	* [r4389] src/commands.c: SecurePINVerify(): circumvent a Dell
	  keyboard problem avoid the command rejection because the Enter
	  key is still pressed. Wait a bit (250ms) for the (Enter) key to
	  be released.

2009-09-10  Ludovic Rousseau

	* [r4383] src/ccid.h, src/commands.c: circumvent bugs of the Dell
	  413c:2100 keyboard
	* [r4382] readers/DellSK-3106.txt: regenerate
	* [r4380] src/Info.plist.src: typo in comment

2009-08-30  Ludovic Rousseau

	* [r4372] readers/Todos_AGM2_CCID.txt,
	  readers/supported_readers.txt: add Todos AGM2 CCID

2009-08-27  Ludovic Rousseau

	* [r4368] SCARDCONTOL.txt: List of SCardControl() commands
	  supported by the CCID driver
	* [r4366] src/ifdhandler.c: IFDHControl(): return
	  IFD_ERROR_NOT_SUPPORTED instead of IFD_COMMUNICATION_ERROR if the
	  dwControlCode value is not supported

2009-07-31  Ludovic Rousseau

	* [r4360] src/ccid.c: ccid_open_hack_pre(): do not call
	  InterruptRead() on Mac OS X. The libusb does not timeout and
	  blocks forever.
	* [r4358] src/ifdhandler.c: IFDHControl(): the (proprietary) switch
	  interface escape command is allowed on the Gemalto GemProx DU
	* [r4356] src/ifdhandler.c: IFDHControl(): the (proprietary) get
	  firmware version escape command is allowed with a Gemalto reader
	* [r4355] src/ccid.h: add GET_VENDOR macro

2009-07-28  Ludovic Rousseau

	* [r4347] README, configure.in: release 1.3.11
	* [r4346] src/ccid.c, src/ccid_usb.c, src/ccid_usb.h,
	  src/ifdhandler.c: change InterruptRead() to add a timeout
	  parameter. We need a short timeout in ccid_open_hack_pre()
	* [r4345] src/ccid_usb.c: InterruptRead(): also log reader_index
	  (instead of Lun) for debug

2009-07-27  Ludovic Rousseau

	* [r4343] src/ccid_usb.c: OpenUSBByName(): do not modify the device
	  name. The same pointer is used by pcscd
	* [r4342] src/ccid_usb.c: InterruptRead(): use usb_strerror() to
	  display the error message in text instead of just decimal

2009-07-21  Ludovic Rousseau

	* [r4341] examples/scardcontrol.c: send a "secoder info" command if
	  the reader supports FEATURE_MCT_READERDIRECT
	* [r4340] examples/scardcontrol.c: parse FEATURE_IFD_PIN_PROPERTIES
	  and FEATURE_MCT_READERDIRECT tags
	* [r4339] examples/scardcontrol.c: use a swicth to parse the
	  CM_IOCTL_GET_FEATURE_REQUEST TLV tag
	* [r4338] examples/scardcontrol.c: check a card is present only
	  _after_ SCardControl(CM_IOCTL_GET_FEATURE_REQUEST)
	* [r4337] examples/scardcontrol.c: update copyright date
	* [r4336] examples/scardcontrol.c: document how to select a reader
	  using a command line argument
	* [r4335] examples/scardcontrol.c: check the error code returned by
	  SCardControl(CM_IOCTL_GET_FEATURE_REQUEST)

2009-07-20  Ludovic Rousseau

	* [r4325] src/ccid.c: the disable card movements notification
	  "hack" for GemProx DU is no more needed

2009-07-18  Ludovic Rousseau

	* [r4323] MacOSX/configure: update Copyright date
	* [r4322] MacOSX/configure: try to use a static link with libusb
	  even if libusb-config is found

2009-07-17  Ludovic Rousseau

	* [r4318] readers/Panasonic_USB_Smart_Card_Reader_7A-Smart.txt,
	  readers/supported_readers.txt: add Panasonic USB Smart Card
	  Reader 7A-Smart

2009-07-07  Ludovic Rousseau

	* [r4313] MacOSX/configure: ifd-ccid-foobar ->
	  ifd-ccid-foobar.bundle for the bundle name
	* [r4311] readers/ATMEL_AT91SC192192CT-USB.txt,
	  readers/supported_readers.txt: add ATMEL_AT91SC192192CT-USB.txt

2009-07-06  Ludovic Rousseau

	* [r4310] configure.in, src/Makefile.am: add --disable-class
	  argument to build a NON class driver
	* [r4309] src/create_Info_plist.pl: remove debug line
	* [r4308] src/Info.plist.src, src/create_Info_plist.pl: add a
	  --no-class argument so that the Info.plist does not define a
	  Class driver. Default is class driver.
	* [r4307] src/Info.plist.src: default value for ifdCapabilities is
	  now 0x00000000 since pcscd should use libhal instead of udev
	  hotplug
	* [r4306] src/Info.plist.src, src/Makefile.am,
	  src/create_Info_plist.pl: extend create_Info_plist.pl to use
	  --ifdCapabilities= --target= --version= --bundle= instead of sed
	  expression in the Makefile
	* [r4304] readers/Alcor_SCR001.txt, readers/supported_readers.txt:
	  add Alcor Micro SCR001
	* [r4303] MacOSX/configure: document the use of --enable-bundle=
	* [r4302] configure.in: check if strlcat is provided by the system
	  
	  strlcpycat.h:20: warning: redundant redeclaration of ‘strlcat’

2009-07-03  Ludovic Rousseau

	* [r4295] src/ccid_usb.c, src/ifdhandler.c: If the driver fails to
	  open a device (wrong interface number in the libhal scheme for
	  example) then return IFD_NO_SUCH_DEVICE instead of the generic
	  error IFD_COMMUNICATION_ERROR

2009-07-01  Ludovic Rousseau

	* [r4292] src/defs.h: use int instead of DWORD for nATRLength in
	  CCID_DESC structure. Gain 8 bytes on the structure size. Thanks
	  to pahole(1)

2009-06-29  Ludovic Rousseau

	* [r4284] src/ccid_usb.c: InterruptRead(): use PERIODIC instead of
	  COMM debug level to not pollute to much the logs for this
	  _periodic_ call

2009-06-26  Ludovic Rousseau

	* [r4282] src/ifdhandler.c: IFDHControl(): add support of
	  FEATURE_MCT_READERDIRECT
	  
	  Only the Kobil TriB@nk reader supports this feature for now. This
	  is used for the Secoder functionality in connected mode.
	* [r4281] src/ccid.c: ccid_open_hack_pre(): do not call
	  InterruptRead() with a KOBIL_TRIBANK The call do not timeout and
	  blocs until a card is inserted (on Mac OS X)
	* [r4280] src/ccid.h: #define KOBIL_TRIBANK
	* [r4279] src/ccid_ifdhandler.h: #define
	  IOCTL_FEATURE_MCT_READERDIRECT

2009-06-25  Ludovic Rousseau

	* [r4276] readers/Aktiv_Rutoken_ECP.txt,
	  readers/supported_readers.txt: add Aktiv Rutoken ECP
	* [r4274] MacOSX/configure: typo in comment

2009-06-20  Ludovic Rousseau

	* [r4267] readers/supported_readers.txt: add missing ':' separator
	* [r4266] src/ccid_ifdhandler.h: define
	  IOCTL_FEATURE_IFD_PIN_PROPERTIES only if
	  FEATURE_IFD_PIN_PROPERTIES is defined (pcsc-lite version >=
	  1.5.3)

2009-06-19  Ludovic Rousseau

	* [r4263] readers/Synnix_STD200.txt, readers/supported_readers.txt:
	  add Synnix STD200

2009-06-16  Ludovic Rousseau

	* [r4260] readers/supported_readers.txt: add 2 Neowave Weneo tokens
	* [r4257] readers/Neowave_Weneo2.txt: another Neowave token - 512MB
	  flash storage - OS is "IBM JCOP41 Standard" - 32k internal memory

2009-06-14  Ludovic Rousseau

	* [r4256] src/utils.h: rename variable index in idx
	  
	  utils.h:32: warning: declaration of 'index' shadows a global
	  declaration
	* [r4255] src/ifdhandler.c: IFDHControl(): use the correct return
	  size for IOCTL_FEATURE_IFD_PIN_PROPERTIES

2009-06-13  Ludovic Rousseau

	* [r4254] readers/Kobil_EMV_CAP.txt: new firmware

2009-05-29  Ludovic Rousseau

	* [r4235] src/commands.c: CmdXfrBlockAPDU_extended(): Correctly ask
	  for the next extended response block.
	  
	  Thanks to Harm Braams for the bug report

2009-05-27  Ludovic Rousseau

	* [r4229] src/ccid_usb.c: ccid_check_firmware(): reindent a line
	* [r4228] src/ccid_usb.c: OpenUSBByName(): no need to get a pointer
	  on the device serial number from the HAL string
	* [r4227] src/ccid_usb.c: ACS ACR122U-WB-R with firmware < 2.06 are
	  bogus: APDU with 0x7B (123) bytes expected do not work with a
	  14443 card. The reader returns SW=63 00 instead.
	* [r4226] readers/ACR122U_PICC.txt: new firmware

2009-05-25  Ludovic Rousseau

	* [r4224] Makefile.am, configure.in: generate a .bz2 archive only

2009-05-13  Ludovic Rousseau

	* [r4204] readers/Softforum_XecureHSM.txt,
	  readers/Softforum__XecureHSM.txt: remove a _ in the filename
	* [r4203] readers/Samsung_XecureHSM.txt,
	  readers/Softforum__XecureHSM.txt, readers/supported_readers.txt:
	  rename Samsung XecureHSM in Softforum XecureHSM

2009-05-12  Ludovic Rousseau

	* [r4197] readers/Samsung_XecureHSM.txt,
	  readers/supported_readers.txt: add Samsung XecureHSM

2009-05-10  Ludovic Rousseau

	* [r4195] src/ccid.c: ccid_open_hack_pre(): call InterruptRead()
	  for all CCID device Makes the Broadcom 5880 work a bit better
	  (but the reader is still bogus) ---This line, and those below,
	  will be ignored--
	  
	  M src/ccid.c

2009-05-08  Ludovic Rousseau

	* [r3494] readers/C3PO_LTC32_USBv2_old.txt, readers/Makefile.am:
	  C3PO_LTC32_USBv2_old.txt is a duplicate of C3PO_TLTC2USB.txt

2009-05-07  Ludovic Rousseau

	* [r3490] readers/LTC32.txt: duplicate of C3PO_LTC32_USBv2.txt
	* [r3488] src/ccid.h, src/ccid_serial.c, src/ccid_usb.c,
	  src/commands.c: do not power up a card with a voltage not
	  supported by the reader

2009-05-02  Ludovic Rousseau

	* [r3485] readers/SCR331-DI-NTTCom.txt: the CCID descriptor was
	  duplicated

2009-04-21  Ludovic Rousseau

	* [r3462] readers/Feitian_SCR301.txt,
	  readers/supported_readers.txt: add Feitian SCR301

2009-04-17  Ludovic Rousseau

	* [r3459] src/Info.plist.src: define CFBundleName to
	  CCIDCLASSDRIVER so that non class drivers have a higher priority.
	  It should work on Mac OS X.
	  
	  Patch from SmartCardServices on macosxforge.org
	* [r3458] src/Info.plist.src, src/Makefile.am: add
	  CFBundleExecutable, CFBundleIdentifier and
	  CFBundleShortVersionString to be inline with the Apple version

2009-04-16  Ludovic Rousseau

	* [r3455] readers/supported_readers.txt: add iDream Vid/Pid but
	  commented as the reader is bogus
	* [r3454] README, readers/supported_readers.txt: add Raritan
	  D2CIM-DVUSB VM/CCID in the should work list

2009-04-10  Ludovic Rousseau

	* [r3425] src/openct/proto-t1.c: t1_transceive(): receiving a WTX
	  block asking for more time is not a critical error. Use
	  DEBUG_COMM2 instead of DEBUG_CRITICAL2
	* [r3424] src/ccid.c: ccid_open_hack_pre(): empty the interrupt end
	  point (card movements) before trying to talk to the device for
	  the GemProx DU/SU

2009-04-09  Ludovic Rousseau

	* [r3423] readers/Raritan_D2CIM-DVUSB.txt: add Raritan D2CIM-DVUSB
	  VM/CCID virtual reader
	* [r3416] src/ifdhandler.c: IFDHCreateChannelByname() &
	  IFDHCreateChannel(): do not call ccid_open_hack_post() if the 3
	  IFDHICCPresence() failed and we closed the reader
	* [r3414] src/ccid_usb.c: OpenUSBByName(): static_interface
	  variable is used only with USE_COMPOSITE_AS_MULTISLOT

2009-04-08  Ludovic Rousseau

	* [r3413] readers/SCL010.txt, readers/supported_readers.txt: The
	  SCM SCL010 Contactless Reader is not supported

2009-04-02  Ludovic Rousseau

	* [r3409] readers/GemProxDU_contact.txt,
	  readers/GemProxDU_contactless.txt, readers/GemProxSU_contact.txt,
	  readers/GemProxSU_contactless.txt: regenerate
	* [r3408] src/parse.c: get the iInterface string instead of just
	  printing the string number

2009-03-31  Ludovic Rousseau

	* [r3406] src/ccid_usb.c: OpenUSBByName(): only increase the
	  interface number for the next "slot" if the previous interface
	  was opened correctly
	  
	  It is now posible to use 2 composite readers without libusb and
	  libhal scheme
	* [r3405] src/ccid_usb.c: OpenUSBByName(): support more than one
	  composite or composite-as-multislot readers

2009-03-30  Ludovic Rousseau

	* [r3404] src/ccid.c: move hack code for GemPC Key, GemPC Twin,
	  GemPC pinpad, GemProx DU GemProx SU and SCM contactless readers
	  from ccid_open_hack_pre() to ccid_open_hack_post()
	  
	  We first need to get a correct communication (sync USB togggle
	  bit) before sending the control commands
	* [r3403] src/ccid.c, src/ccid.h, src/ifdhandler.c: split
	  ccid_open_hack() in ccid_open_hack_pre() and
	  ccid_open_hack_post() before and after the empirical "warm up"
	  sequence
	  
	  The problem is the USB toggle bit. I could not find a simple way
	  to reset it. So when the driver is started again the reader and
	  the host may not be in sync. The few first CCID commands may
	  fail.

2009-03-29  Ludovic Rousseau

	* [r3401] readers/supported_readers.txt: remove support of
	  Reiner-SCT cyberJack pinpad(a) on request of Reiner-SCT
	  
	  You should user the Reiner-SCT driver instead

2009-03-27  Ludovic Rousseau

	* [r3395] src/ifdhandler.c: IFDHCreateChannel(): use the same
	  empirical hack as in IFDHCreateChannelByName() to recover the
	  reader after pcscd is restarted.
	  
	  The problem is that USB frames have a toggle bit

2009-03-26  Ludovic Rousseau

	* [r3380] readers/GemProxDU_contact.txt,
	  readers/GemProxDU_contactless.txt, readers/GemProxSU_contact.txt,
	  readers/GemProxSU_contactless.txt, readers/supported_readers.txt:
	  add Gemalto GemProx DU and SU readers
	* [r3379] MacOSX/configure: use --enable-composite-as-multislot on
	  Mac OS X since libhal is not available on Mac OS X
	* [r3378] configure.in, src/ccid.c, src/ccid.h, src/ccid_usb.c,
	  src/ifdhandler.c: add support of a composite device as
	  multi-slots device

2009-03-24  Ludovic Rousseau

	* [r3375] src/ccid.h, src/commands.c: SecurePINVerify(): Correct
	  bNumberMessage for Dell keyboard
	* [r3374] readers/DellSCRK.txt: update
	* [r3373] readers/GemPCTwin_serial.txt: add a (faked) USB
	  descriptor for the GemPC Twin using serial communication

2009-03-21  Ludovic Rousseau

	* [r3356] examples/scardcontrol.c, src/ccid.h,
	  src/ccid_ifdhandler.h, src/ccid_usb.c, src/commands.c,
	  src/ifdhandler.c: add support of PIN_PROPERTIES_STRUCTURE
	  structure and FEATURE_IFD_PIN_PROPERTIES
	  
	  Thanks to Martin Paljak for the patch

2009-03-20  Ludovic Rousseau

	* [r3354] src/commands.c: CmdEscape(): set the communication
	  timeout to 30 seconds for the PC_to_RDR_Escape commands since
	  some commands may be slow
	  
	  Thanks to Adam Laurie (rfidiot.org) for the bug report
	* [r3353] src/commands.c: SecurePINVerify() and SecurePINModify():
	  correctly restore the communication timeout if sending the
	  command fails

2009-03-19  Ludovic Rousseau

	* [r3351] src/commands.c: SecurePINModify(): do not reject the
	  command if bNumberMessage = 0xFF (default value)
	  
	  Thanks to Martin Paljak for the patch
	* [r3350] src/ccid_usb.c: OpenUSBByName(): support more than one
	  CCID interface per USB device with the libhal scheme

2009-03-17  Ludovic Rousseau

	* [r3349] MacOSX/configure: Use libusb-config to define LIBUSB_*
	  variables
	* [r3348] src/ccid_usb.c, src/ccid_usb.h, src/parse.c: allow to
	  list more than one CCID interface per USB device

2009-03-13  Ludovic Rousseau

	* [r3344] readers/Alya.txt: remove fingerprint part

2009-03-07  Ludovic Rousseau

	* [r3340] README: use spaces instead of tabs
	* [r3338] README, configure.in: release 1.3.10
	* [r3337] src/ifdhandler.c: IFDHSetProtocolParameters(): rename atr
	  in openpgp_atr
	  
	  ifdhandler.c:822: warning: declaration of ‘atr’ shadows a
	  previous local ifdhandler.c:527: warning: shadowed declaration is
	  here

2009-03-01  Ludovic Rousseau

	* [r3330] src/ifdhandler.c: IFDHSetProtocolParameters(): add a hack
	  to support the bogus OpenGPG card. The card declares a BWI=4
	  (1.4s) but, sometimes, do not send a WTX (time request) in time
	  and the on board key generation then fails. The patch uses BWI=7
	  (11s)
	  
	  Thanks to Jan Suhr for helping tracking the bug

2009-02-25  Ludovic Rousseau

	* [r3325] readers/ACS_ACR100.txt, readers/ACS_ACR38_plugin.txt: add
	  ACS ACR100 and ACS ACR38 plugin
	* [r3324] readers/ACR122U_PICC.txt: update firmware

2009-02-21  Ludovic Rousseau

	* [r3322] src/ifdhandler.c: typo in comment

2009-02-18  Ludovic Rousseau

	* [r3320] README, readers/Precise_200_MC.txt,
	  readers/supported_readers.txt: add Precise Biometrics 200 MC and
	  250 MC in the "should work" list
	* [r3319] src/ifdhandler.c: IFDHSetProtocolParameters(): correct
	  parameter Protocol documentation
	  
	  Thanks to Joachim Breitner for the bug report

2009-02-15  Ludovic Rousseau

	* [r3318] src/commands.c: SecurePINVerify(): also check the value
	  of bmPINBlockString in case of Case 1 APDU and SPR532
	  
	  Thanks to Peter Koch for the patch

2009-02-14  Ludovic Rousseau

	* [r3316] README, readers/Makefile.am, readers/Philips_SmartMX.txt,
	  readers/SafeNet_IKey4000.txt, readers/supported_readers.txt: use
	  product name Philips SmartMX instead of commercial name SafeNet
	  IKey4000.
	  
	  SafeNet IKey4000 is also used with different device like:
	  idVendor: 0x04B9 iManufacturer: SafeNet, Inc. idProduct: 0x1206
	  iProduct: iKey 4000 Found a CCID/ICCD device idVendor: 0x04B9
	  iManufacturer: SafeNet, Inc. idProduct: 0x1206 iProduct: iKey
	  4000 bcdDevice: 1.10 (firmware release?) bLength: 9
	  bDescriptorType: 4 bInterfaceNumber: 0 bAlternateSetting: 0
	  bNumEndpoints: 0 Control only bInterfaceClass: 0xFF NOT A CCID
	  DEVICE Class is 0xFF (proprietary) bInterfaceSubClass: 0
	  bInterfaceProtocol: 0 bulk transfer, optional interrupt-IN (CCID)
	  iInterface: 0 USB extra length is too short: 2
	  
	  NOT A CCID DEVICE

2009-02-11  Ludovic Rousseau

	* [r3315] README, readers/TianYu_CCID_SmartKey.txt,
	  readers/supported_readers.txt: add TianYu CCID SmartKey in the
	  should work list

2009-02-07  Ludovic Rousseau

	* [r3310] src/ccid_usb.c: OpenUSBByName(): device_vendor and
	  device_product varioables are not used on Mac OS X.

2009-02-04  Ludovic Rousseau

	* [r3301] configure.in: display the values of PCSC_CFLAGS and
	  PCSC_LIBS
	* [r3300] configure.in: use [ ] for PKG_CHECK_EXISTS() arguments
	* [r3299] MacOSX/configure, configure.in: use PKG_CHECK_EXISTS()
	  before PKG_CHECK_MODULES() so that the *_CFLAGS and *_LIBS are
	  not erased if pkg-config does not find the searched lib

2009-01-29  Ludovic Rousseau

	* [r3296] readers/supported_readers.txt: use generic "Realtek"
	  instead of one particular brand "iMONO"

2009-01-26  Ludovic Rousseau

	* [r3293] src/openct/proto-t1.c: reformat to ease diff with
	  proto-t1.c from OpenCT
	* [r3292] src/ifdhandler.c, src/openct/proto-t1.c,
	  src/openct/proto-t1.h: rename t1_negociate_ifsd() in
	  t1_negotiate_ifsd() to be in sync with OpenCT

2009-01-21  Ludovic Rousseau

	* [r3289] src/Makefile.am: move tokenparser.c from
	  MAINTAINERCLEANFILES to DISTCLEANFILES so that "make distcheck"
	  works without error

2009-01-19  Ludovic Rousseau

	* [r3284] src/ifdhandler.c: ICCD devices do not use
	  usb_interrupt_read() but sleep(). So there is no problem killing
	  the polling thread and sleep for 10 minutes instead of just 5
	  seconds
	* [r3283] readers/GemPCKey.txt: regenerate
	* [r3282] README, readers/Aktiv_Rutoken_Magistra.txt,
	  readers/supported_readers.txt: add Aktiv Rutoken Magistra in the
	  "Should work but untested by me" list

2009-01-15  Ludovic Rousseau

	* [r3281] configure.in: remove an extra AC_MSG_RESULT()

2009-01-13  Ludovic Rousseau

	* [r3280] src/ccid.c, src/ifdhandler.c: disable support of the
	  contcatless part of SDI010 and SCR331DI

2009-01-07  Ludovic Rousseau

	* [r3272] MacOSX/configure: do not overwrite LIBUSB_CFLAGS and
	  LIBUSB_LIBS if libusb-config is found

2009-01-05  Ludovic Rousseau

	* [r3271] src/ccid_serial.c: use int instead of long to store a
	  reader ID (32 bits)
	* [r3270] src/ccid_serial.c, src/ccid_usb.h, src/commands.c,
	  src/commands.h, src/towitoko/atr.h, src/towitoko/pps.h: tag
	  output parameters with /*@out@*/
	* [r3269] src/ccid.c, src/ccid_serial.c, src/ccid_usb.c: use
	  snprintf() instead of sprintf() to avoid potential buffer
	  overflow
	* [r3268] src/ccid.c, src/ccid_serial.c, src/ccid_usb.c,
	  src/commands.c, src/debug.c, src/ifdhandler.c, src/parse.c:
	  explicitly cast result in void when not used (reported by the
	  splint tool)

2008-12-17  Ludovic Rousseau

	* [r3237] README, readers/supported_readers.txt: add Atmel
	  AT98SC032CT in the should work list

2008-12-16  Ludovic Rousseau

	* [r3236] readers/ATMEL_AT98SC032CT.txt: add ATMEL AT98SC032CT

2008-12-13  Ludovic Rousseau

	* [r3234] MacOSX/convert_reader_h.pl: update FSF address

2008-12-12  Ludovic Rousseau

	* [r3232] README, readers/supported_readers.txt: add iMONO 43 in 1
	  + Sim + Smart Card Reader in the "should work" list
	* [r3231] readers/iMONO.txt: add iMONO USB2.0-CRW reader

2008-12-09  Ludovic Rousseau

	* [r3228] README, readers/supported_readers.txt: add Xiring Xi Sign
	  PKI in the supported list

2008-11-27  Ludovic Rousseau

	* [r3227] readers/Neowave_Weneo.txt: add Neowave Weneo device

2008-11-26  Ludovic Rousseau

	* [r3226] src/ifdhandler.c: IFDHSetProtocolParameters(): convert
	  protocol from ATR_PROTOCOL_TYPE_T? to SCARD_PROTOCOL_T? in case
	  of O2MICRO_OZ776_PATCH
	  
	  Thanks to Jim Dawson for the bug report

2008-11-22  Ludovic Rousseau

	* [r3222] readers/Omnikey_noname1.txt,
	  readers/supported_readers.txt: add a Noname reader (from Omnikey)

2008-11-20  Ludovic Rousseau

	* [r3220] README, readers/supported_readers.txt: add MSI StarReader
	  SMART in the should work but untested list

2008-11-19  Ludovic Rousseau

	* [r3219] readers/MSI_StarReader_SMART.txt: add MSI StarReader
	  SMART
	* [r3218] readers/ACR122U_PICC.txt: new firmware

2008-11-18  Ludovic Rousseau

	* [r3214] bootstrap: add -I m4 to aclocal
	* [r3208] README, configure.in: release 1.3.9
	* [r3207] src/ccid.h: cast dw2i() to return an unsigned int
	* [r3206] README, readers/supported_readers.txt: add VMware Virtual
	  USB CCID in should work but untested list

2008-11-14  Ludovic Rousseau

	* [r3205] configure.in: check for usb_interrupt_read instead of
	  usb_get_string_simple and request libusb 0.1.12 instead of 0.1.7
	* [r3203] README, readers/supported_readers.txt: move Broadcom 5880
	  in the Unsupported list and comment the entry in
	  readers/supported_readers.txt
	  
	  No communication to the device ("Resource temporarily
	  unavailable" error)

2008-11-11  Ludovic Rousseau

	* [r3202] src/Makefile.am: add $(LIBUSB_LIBS) to parse_LDADD
	  
	  Thanks to Karl Dahlén for the patch Closes: [#311251] Patch for
	  solving cross-compile build error for the tool parse.
	* [r3201] readers/SDI010.txt: new firmware

2008-11-10  Ludovic Rousseau

	* [r3199] src/defs.h, src/ifdhandler.c: defs.h: add readerName
	  field ifdhandler.c: also log reader name instead of just Lun
	* [r3198] src/debug.h: #define DEBUG_PERIODIC3
	* [r3196] readers/SCR331-DI.txt: regenerate

2008-11-08  Ludovic Rousseau

	* [r3195] readers/Xiring_XI-SIGN.txt,
	  readers/Xiring_XI-SIGN_6000.txt: add Xiring Xi Sign PKI et Xiring
	  Xi Sign 6000
	* [r3194] examples/scardcontrol.c: typo in comment
	* [r3193] examples/scardcontrol.c: get the GemPC firmware only if
	  GET_GEMPC_FIRMWARE is #define
	* [r3192] README, readers/supported_readers.txt: move the "jNet
	  Technology jToken s1" in the Unsupported list and remove it
	  (commented entry) from the supported_readers.txt

2008-11-07  Ludovic Rousseau

	* [r3191] readers/VMware_Virtual_USB_CCID.txt: add VMware Virtual
	  USB CCID reader (available since VMWare 6.5)

2008-10-31  Ludovic Rousseau

	* [r3189] README, readers/supported_readers.txt: add jNet
	  Technology jToken s1 in should work but untested list
	* [r3188] src/parse.c: small code reformat
	* [r3187] readers/jNet_jToken_s1.txt: add jNet_jToken_s1.txt

2008-10-28  Ludovic Rousseau

	* [r3185] Makefile.am: add --reparagraph to svn2cl arguments
	* [r3183] src/commands.c: SecurePINVerify(): in case of SPR532 and
	  Case 1 APDU we need to set bSeq again to avoid a "Duplicate frame
	  detected" error since the bSeq of CmdEscape is now greater than
	  bSeq set at the beginning of this function
	  
	  Thanks to Peter Koch for the bug report

2008-10-27  Ludovic Rousseau

	* [r3182] README, readers/supported_readers.txt: add Gemalto PDT in
	  should work list
	* [r3181] readers/Gemalto_PDT.txt, readers/Makefile.am: add Gemalto
	  PDT

2008-10-17  Ludovic Rousseau

	* [r3177] Makefile.am: no need to explicitely provide the aux files

2008-10-16  Ludovic Rousseau

	* [r3176] README, readers/supported_readers.txt: add ACS ACR122U
	  PICC Interface in the Should work but untested by me list
	* [r3175] readers/ACR122U_PICC.txt, readers/Makefile.am: add
	  ACR122U_PICC.txt
	* [r3174] configure.in, reconf: build is now .
	* [r3173] build: remove build/ It collides with the Debian build
	  rule when using dh(1)
	* [r3172] build/ylwrap, ylwrap: move ylwrap out of build/

2008-10-14  Ludovic Rousseau

	* [r3170] src/towitoko/atr.c: ATR_InitFromArray(): use atr_buffer[]
	  directly (no need to copy it)
	* [r3169] src/towitoko/defines.h: remove definition of
	  INVERT_BYTE()
	* [r3168] src/towitoko/atr.c: ATR_InitFromArray(): do not reverse
	  the ATR for inverse convention cards since the ATR is already
	  corrected by the reader
	  
	  This never happend since the test was never true (TS == 0x03)
	* [r3167] src/towitoko/atr.c, src/towitoko/atr.h: make atr_buffer[]
	  argument const to avoid accidental modifications
	* [r3166] src/towitoko/atr.c: typo in comment

2008-10-11  Ludovic Rousseau

	* [r3163] README, readers/supported_readers.txt: add HP MFP Smart
	  Card Reader in the "Should work but untested by me" list
	* [r3162] readers/HP_MFP_SmartCardReader.txt, readers/Makefile.am:
	  add HP_MFP_SmartCardReader.txt
	* [r3161] readers/HPUSBSmartCardReader.txt: reindent

2008-10-07  Ludovic Rousseau

	* [r3154] README: reorder SchlumbergerSema reader
	* [r3153] README: reorder SpringCard readers
	* [r3152] README: reorder 2 readers
	* [r3151] README, readers/supported_readers.txt: add "KONA USB
	  SmartCard" to the should work list

2008-09-27  Ludovic Rousseau

	* [r3148] README, readers/supported_readers.txt: add Broadcom Corp
	  5880 (found in Dell E6500 laptop) in the "Should work but
	  untested by me" list
	* [r3147] readers/Broadcom_5880.txt, readers/Makefile.am: add
	  Broadcom_5880.txt

2008-09-23  Ludovic Rousseau

	* [r3144] src/ifdhandler.c: IFDHCreateChannelByName(): call
	  ClosePort() to release resources if the 3 IFDHICCPresence() fails

2008-09-13  Ludovic Rousseau

	* [r3129] readers/Makefile.am,
	  readers/Pro-Active_CSB6_Ultimate.txt: Pro-Active CSB6 Ultimate is
	  renamed SpringCard CSB6 Ultimate
	* [r3128] README, readers/supported_readers.txt: add SpringCard
	  CrazyWriter, CSB6 Basic, CSB6 Secure, CSB6 Ultimate, EasyFinger
	  Standard, EasyFinger Ultimate and Prox'N'Roll in the "Should work
	  but untested by me" list
	* [r3127] README, readers/supported_readers.txt: rename Pro-Active
	  in Springcard

2008-09-12  Ludovic Rousseau

	* [r3126] src/ifdhandler.c: IFDHPowerICC(): use a very long timeout
	  for PowerUp since the card can be very slow to send the full ATR
	  (up to 30 seconds at 4 MHz)

2008-09-10  Ludovic Rousseau

	* [r3122] readers/Makefile.am, readers/SpringCard_CSB6_Basic.txt,
	  readers/SpringCard_CSB6_Secure.txt,
	  readers/SpringCard_CSB6_Ultimate.txt,
	  readers/SpringCard_CrazyWriter.txt,
	  readers/SpringCard_EasyFinger_Standard.txt,
	  readers/SpringCard_EasyFinger_Ultimate.txt,
	  readers/SpringCard_Prox_N_Roll.txt: add SpringCard readers
	  Prox'N'Roll, CSB6 Basic, EasyFinger Ultimate, CSB6 Ultimate,
	  EasyFinger Standard, CrazyWriter, CSB6 Secure

2008-09-09  Ludovic Rousseau

	* [r3115] readers/Makefile.am, readers/mIDentityXL.txt: add
	  mIDentityXL.txt
	* [r3114] readers/supported_readers.txt: differentiate between
	  KOBIL mIDentity M (pid 0x4000) and XL (pid 0x4001)

2008-09-05  Ludovic Rousseau

	* [r3106] src/ccid_usb.c: InterruptRead(): do not log the error if
	  errno == ENODEV since that happens in canse of timeout

2008-09-01  Ludovic Rousseau

	* [r3105] src/ccid.c: ccid_open_hack(): GEMPCPINPAD: add a sleep(1)
	  before sending the load strings command to let the reader
	  initialise itself

2008-08-19  Ludovic Rousseau

	* [r3097] src/ccid_usb.c: InterruptRead(): do not cache if the
	  reader has failed previously since this state was stored in a
	  static variable global to all the readers managed by the driver
	  and was not per reader.
	  
	  Without this mechanism we may have a bit more error messages
	  logged but the driver will work in a multi-reader configuration.

2008-08-18  Ludovic Rousseau

	* [r3096] src/ifdhandler.c: IFDHSleep(): just sleep for 5 seconds
	  since the polling thread is NOT killable so pcscd event thread
	  must loop to exit cleanly
	  
	  Once the driver (libusb in fact) will support
	  TAG_IFD_POLLING_THREAD_KILLABLE then we could use a much longer
	  delay and be killed before pcscd exits

2008-08-14  Ludovic Rousseau

	* [r3090] README, readers/supported_readers.txt: add Atmel AT91SO
	  in the "Should work but untested by me" list
	* [r3089] readers/ATMEL_AT91SO.txt, readers/Makefile.am: add
	  ATMEL_AT91SO.txt

2008-08-07  Ludovic Rousseau

	* [r3085] README: add Cherry SmartTerminal ST-1200USB in the
	  "Should work but untested by me"
	* [r3084] readers/CherrySmartTerminalXX1X.txt,
	  readers/supported_readers.txt: add Cherry SmartTerminal XX1X

2008-07-30  Ludovic Rousseau

	* [r3066] MacOSX/configure: link statically against libusb by
	  default
	* [r3065] MacOSX/configure: do not build a static driver (building
	  fails when linking statically with libusb)
	* [r3064] MacOSX/configure: do not overwrite PCSC_CFLAGS,
	  PCSC_LIBS, LIBUSB_CFLAGS and LIBUSB_LIBS if already defined by
	  the user
	  
	  Closes [#310945] MacOSX/configure - disable forced OpenSC libusb
	  usage, permit other builds
	* [r3063] configure.in, src/Makefile.am: no need to use
	  CoreFoundation and IOKit frameworks since we use libusb that
	  already includes them

2008-07-29  Ludovic Rousseau

	* [r3061] README: add the Aladdin eToken PRO USB 72K Java in the
	  "Should work but untested by me" list
	* [r3060] readers/supported_readers.txt: add the Aladdin eToken PRO
	  USB 72K Java in the "Should work but untested by me" list
	* [r3059] readers/Aladdin_eToken_PRO_USB_72K_Java.txt,
	  readers/Makefile.am: add Aladdin_eToken_PRO_USB_72K_Java.txt

2008-06-27  Ludovic Rousseau

	* [r3033] README, configure.in: release 1.3.8

2008-06-26  Ludovic Rousseau

	* [r3027] src/ccid_usb.c: InterruptRead(): remove a \n in a log
	* [r3026] src/ccid_usb.c: InterruptRead(): use a 2 seconds timeout
	  since it is not possible for pcscd to kill the polling thread.
	  
	  See thread on libusb-devel
	  http://sourceforge.net/mailarchive/forum.php?thread_name=baabf6440805290726s228bce20r5073d55d8d56241b%40mail.gmail.com&forum_name=libusb-devel
	* [r3025] src/ifdhandler.c: IFDHPolling(): log only if
	  DEBUG_LEVEL_PERIODIC is set
	* [r3024] src/Info.plist.src, src/Makefile.am, src/ifdhandler.c: do
	  not include the release number in the Info.plist to avoid a diff
	  of a configuration file when upgrading the package.
	  
	  Thanks to Benoit Gonzalvo for the bug report

2008-06-25  Ludovic Rousseau

	* [r3023] README, readers/supported_readers.txt: add "Oberthur
	  ID-One Cosmo Card" in the "Should work but untested by me" list
	* [r3022] readers/Makefile.am, readers/Oberthur-CosmoCard.txt: add
	  Oberthur-CosmoCard.txt

2008-06-18  Ludovic Rousseau

	* [r3010] readers/KAAN_Advanced.txt: firmware 1.19
	* [r3009] readers/KAAN_Base.txt: firmware 1.19

2008-06-17  Ludovic Rousseau

	* [r3008] readers/Kobil_EMV_CAP.txt: firmware 0.30
	* [r3007] readers/KAAN_Advanced.txt: regenerate
	* [r3006] src/defs.h: typo in comments
	* [r3005] src/defs.h: Kobil readers does not support APDU chaining
	  for T=1 so you can't send an extended APDU. The readers supports
	  a command of up to 512 or 420 bytes.

2008-06-16  Ludovic Rousseau

	* [r3004] src/commands.c: CCID_Receive(): do not crash if the
	  reader firmware is bogus and does not support chaining for
	  extended APDU.
	  
	  This is the case for Kobil readers

2008-06-14  Ludovic Rousseau

	* [r3002] configure.in: ask to install libusb if usb.h is not found
	* [r3001] INSTALL: update the "building serial reader driver"
	  sections
	* [r3000] contrib/Makefile.am: build Kobil_mIDentity_switch only if
	  WITH_LIBUSB is true
	* [r2999] src/Makefile.am: build parse and libccid.la only if
	  WITH_LIBUSB is true
	* [r2998] configure.in: define the conditional WITH_LIBUSB if
	  libusb is used
	* [r2997] reconf: remove useless copy if m4.m4
	* [r2996] configure.in: do not AC_MSG_RESULT([no]) if PCSC is not
	  found since PKG_CHECK_MODULES() will already display the result
	* [r2995] configure.in: set use_usb_interrupt=no by default

2008-06-09  Ludovic Rousseau

	* [r2988] Makefile.am: rename aclocal to m4
	* [r2987] Makefile.am, aclocal, configure.in, m4, reconf: rename
	  aclocal to m4

2008-06-08  Ludovic Rousseau

	* [r2985] README, configure.in: release 1.3.7
	* [r2984] README, readers/supported_readers.txt: add Pro-Active
	  CSB6 Ultimate in "should work" list
	* [r2983] src/ccid_serial.c: ReadSerial(): return the length of
	  data read in *length
	  
	  Thanks to Alexander Georg for the bug report

2008-06-07  Ludovic Rousseau

	* [r2982] aclocal/acx_pthread.m4: add the file as a symlink to
	  ../../../PCSC/m4/acx_pthread.m4
	* [r2981] aclocal/acx_pthread.m4: remove file
	* [r2976] aclocal/acx_pthread.m4: update (correct a problem under
	  Solaris)
	  
	  Thanks to David L. Markowitz for the bug report

2008-05-28  Ludovic Rousseau

	* [r2974] MacOSX/configure, README,
	  contrib/RSA_SecurID/RSA_SecurID_getpasswd.c,
	  examples/scardcontrol.c, src/ccid.c, src/ccid.h,
	  src/ccid_ifdhandler.h, src/ccid_serial.c, src/ccid_serial.h,
	  src/ccid_usb.c, src/ccid_usb.h, src/commands.c, src/commands.h,
	  src/convert_version.pl, src/create_Info_plist.pl, src/debug.c,
	  src/debug.h, src/defs.h, src/ifdhandler.c, src/openct/checksum.h,
	  src/openct/proto-t1.h, src/parse.c, src/towitoko/COPYING,
	  src/towitoko/atr.c, src/towitoko/atr.h, src/towitoko/defines.h,
	  src/towitoko/pps.c, src/towitoko/pps.h, src/utils.c, src/utils.h:
	  update Free Software Foundation mail address
	* [r2973] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c:
	  change the licence from GPL-v2 to LGPL-v2.1 after request from
	  Norbert Federa
	* [r2972] README, readers/supported_readers.txt: add id3
	  Semiconductors CL1356A HID in the should work list
	* [r2971] readers/Makefile.am: add id3_CL1356D.txt
	* [r2970] readers/Makefile.am, readers/id3_CL1356A_HID.txt: add
	  id3_CL1356A_HID.txt

2008-05-27  Ludovic Rousseau

	* [r2969] readers/CardMan5321.txt: regenerate

2008-05-23  Ludovic Rousseau

	* [r2968] README: update RSA SecureID SID800 web page

2008-05-22  Ludovic Rousseau

	* [r2966] src/parse.c: libusb-compat returns a permission denied
	  error on usb_open() when not run as root
	* [r2965] configure.in: check if libusb-0.1 is emulated by
	  libusb-compat + libusb-1.0 to use or not the USB interrupt
	  feature
	  
	  libusb-0.1 may never solve the performance problem of
	  usb_interrupt_read()
	* [r2964] readers/GemCoreSIMPro.txt: update

2008-05-11  Ludovic Rousseau

	* [r2941] Makefile.am: add AUTOMAKE_OPTIONS = dist-bzip2 so that
	  make dist alsa generates a .tar.bz2 archive

2008-05-09  Ludovic Rousseau

	* [r2937] readers/Makefile.am,
	  readers/Pro-Active_CSB6_Ultimate.txt: add
	  Pro-Active_CSB6_Ultimate.txt
	* [r2936] src/parse.c: do not try to parse devices with
	  bInterfaceClass=0xFF by default (use command line argument -p for
	  proprietary class)
	* [r2935] src/parse.c: remove duplicated code

2008-05-08  Ludovic Rousseau

	* [r2934] README: use a real space character
	* [r2933] README: use a real space character
	* [r2932] README: sync with the ccid.html web page
	* [r2931] README: rename Gemplus in Gemalto
	* [r2930] README: reorder Eutron CryptoIdentity
	* [r2929] README: add ActivCard Activkey Sim

2008-04-30  Ludovic Rousseau

	* [r2924] README, configure.in: release 1.3.6
	* [r2923] README: add URL for Validy USB Token
	* [r2922] examples/scardcontrol.c: exit if no card is present
	* [r2921] README, readers/supported_readers.txt: add Covadis Véga
	  in "Should work but untested by me" list
	* [r2920] readers/Vega-Alpha.txt: regenerate
	* [r2919] configure.in, src/convert_version.pl,
	  src/create_Info_plist.pl: add support for DragonFly BSD
	  
	  Thanks to Hasso Tepper for the patch (alioth #310748)

2008-04-29  Ludovic Rousseau

	* [r2916] src/openct/proto-t1.c: t1_transceive(): correctly reply
	  to S(ABORT request) with a S(ABORT response) instead of a
	  S(RESYNC request)
	  
	  Thanks to Alon Bar-Lev for the bug report

2008-04-25  Ludovic Rousseau

	* [r2912] Makefile.am: add "ACLOCAL_AMFLAGS = -I aclocal" so that
	  "autoreconf --install --verbose --force" works after a clean svn
	  checkout
	  
	  Thanks to Alon Bar-Lev for the patch
	* [r2911] src/ifdhandler.c: init_driver(): use the environment
	  variable LIBCCID_ifdLogLevel to overwrite the value of
	  ifdLogLevel read from the Info.plist file
	  
	  Thanks to Alon Bar-Lev for the idea

2008-04-09  Ludovic Rousseau

	* [r2876] readers/KEBTechnology_KONA_USB_SmartCard.txt,
	  readers/Makefile.am: add KEBTechnology_KONA_USB_SmartCard.txt
	* [r2875] README, readers/supported_readers.txt: add the Validy
	  TokenA sl vt in the should work list
	* [r2874] readers/Makefile.am, readers/Validy_TokenA.txt: add
	  Validy_TokenA.txt
	* [r2873] README, readers/supported_readers.txt: Add Vasco DP905 in
	  the should work list

2008-04-08  Ludovic Rousseau

	* [r2872] src/parse.c: display the enumerated USB devices and if
	  they are or not a CCID/ICCD device also add some colors
	* [r2871] src/ccid.h, src/ccid_serial.c, src/ccid_usb.c,
	  src/ifdhandler.c: Simulate card absence for the GemCore SIM Pro
	* [r2870] INSTALL: improve a bit the serial reader section
	* [r2869] README: add Voltage selection section

2008-03-31  Ludovic Rousseau

	* [r2864] src/Makefile.am: use $(bundle) instead of the hardcoded
	  ifd-ccid.bundle for CCID_BUNDLE

2008-03-29  Ludovic Rousseau

	* [r2863] readers/Makefile.am, readers/Vasco_DP905.txt: add Vasci
	  DP905
	* [r2862] src/parse.c: log error messages on stderr instead of
	  stdout
	* [r2861] src/parse.c: use an unsigned char [] buffer only for
	  multi-bytes conversions. usb_* functions want a char [] buffer.
	* [r2860] src/utils.c, src/utils.h: use int instead of DWORD for
	  GetNewReaderIndex() and LunToReaderIndex() Lun parameter
	  
	  utils.c:48: warning: comparison between signed and unsigned
	  utils.c:73: warning: comparison between signed and unsigned
	* [r2859] src/ccid_usb.c: ccid_check_firmware(): use unsigned int
	  instead of int
	  
	  ccid_usb.c:720: warning: comparison between signed and unsigned
	* [r2858] src/ccid_serial.c: WriteSerial(): use unsigned int
	  instead of int
	  
	  ccid_serial.c:199: warning: comparison between signed and
	  unsigned
	* [r2857] src/ifdhandler.c: use defined(USE_USB_INTERRUPT) instead
	  of just USE_USB_INTERRUPT
	  
	  ifdhandler.c:60:66: warning: "USE_USB_INTERRUPT" is not defined
	* [r2856] readers/supported_readers.txt: move the Blutronics and
	  Covadis reader before the Bogus readers

2008-03-25  Ludovic Rousseau

	* [r2855] readers/Makefile.am, readers/Precise_250_MC.txt: add
	  Precise Biometrics 250 MC

2008-03-24  Ludovic Rousseau

	* [r2854] src/ifdhandler.c: IFDHSetProtocolParameters(): store the
	  protocol used in ccid_desc->cardProtocol even if the reader has
	  CCID_CLASS_AUTO_PPS_PROP. Correct a potential bug in
	  SecurePINVerify()/SecurePINModify().
	  
	  Thanks to Jim Dawson for the bug report

2008-03-14  Ludovic Rousseau

	* [r2849] src/ifdhandler.c: IFDHSetProtocolParameters(): O2Micro
	  OZ776 does not support a protocol change to T=1 for dual protocol
	  cards
	  
	  https://www.opensc-project.org/opensc/ticket/172
	  https://bugs.launchpad.net/ubuntu/+bug/163072

2008-03-07  Ludovic Rousseau

	* [r2848] README: add Covadis Alya in the supported list
	* [r2847] readers/supported_readers.txt: add Covadis Alya
	* [r2846] readers/Alya.txt: update

2008-02-27  Ludovic Rousseau

	* [r2844] readers/Alya.txt, readers/Makefile.am,
	  readers/Vega-Alpha.txt: add Covadis.ch Alya and Vega-Alpha
	  readers

2008-02-22  Ludovic Rousseau

	* [r2842] README, configure.in: release 1.3.5
	* [r2841] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c:
	  add "Try to rerun this program as root." if no device is found
	  and euid != 0
	* [r2840] README: add Advanced Card Systems ACR122 in "Should work"
	  list

2008-02-21  Ludovic Rousseau

	* [r2837] readers/ACR122U.txt, readers/Makefile.am: add ACR122U.txt

2008-02-20  Ludovic Rousseau

	* [r2836] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c:
	  #include "config.h" to have HAVE_USB_DETACH_KERNEL_DRIVER_NP

2008-02-16  Ludovic Rousseau

	* [r2832] README: update SCM Micro URLs
	* [r2831] README: rename the duplicate [31] reference as [31b]

2008-02-15  Ludovic Rousseau

	* [r2827] configure.in: typo
	* [r2826] configure.in: use $PKG_CONFIG instead of pkg-config
	* [r2825] configure.in, src/ifdhandler.c: use usb_interrupt_read()
	  only if libusb > 0.1.12 or --enable-usb-interrupt is used

2008-02-14  Ludovic Rousseau

	* [r2824] src/Makefile.am: add MAINTAINERCLEANFILES = tokenparser.c
	  so that make distcheck works
	* [r2822] README: add Cherry SmartBoard, G83-6610 in the "Should
	  work but untested by me" list
	* [r2821] readers/supported_readers.txt: add Cherry SmartBoard XX1X
	* [r2820] readers/CherrySmartBoardXX1X.txt, readers/Makefile.am:
	  add CherrySmartBoardXX1X.txt
	* [r2819] README: add Gemplus Gem e-Seal Pro in the "Should work
	  but untested by me" list
	* [r2818] readers/supported_readers.txt: add Gemplus Gem e-Seal Pro
	* [r2815] c.sh: linked to ../../PCSC/c.sh
	* [r2813] readers/Gem_e-SealPro.txt, readers/Makefile.am: add
	  Gem_e-SealPro.txt

2008-02-08  Ludovic Rousseau

	* [r2810] src/ifdhandler.c: IFDHPolling() and IFDHPolling() are
	  defined if TWIN_SERIAL is not defined and also if
	  HAVE_DECL_TAG_IFD_POLLING_THREAD is set to 1
	* [r2809] README, configure.in: release 1.3.4
	* [r2808] src/ccid.c: ccid_open_hack(): do not call InterruptRead
	  when compiling the serial driver since this function is not
	  defined in that case
	* [r2807] README: Bluetronics -> Blutronics

2008-02-07  Ludovic Rousseau

	* [r2806] src/ifdhandler.c: do not declare IFDHPolling() and
	  IFDHSleep() when building for the serial reader
	* [r2805] src/ccid_serial.h: use #ifndef to avoid multiple include
	  of the file
	* [r2804] src/ccid.c: #include "ccid_usb.h" to get the declaration
	  of InterruptRead()
	* [r2803] src/pcscd_ccid.rules: remove
	  WAIT_FOR_SYSFS="bInterfaceProtocol" to do not delay udev
	  
	  Thanks to Alon Bar-Lev for the patch
	* [r2802] src/ccid_usb.c: InterruptRead(): in case of timeout we
	  can also get EAGAIN (Resource temporarily unavailable)
	* [r2801] src/ifdhandler.c: IFDHSleep(): add a log call

2008-02-06  Ludovic Rousseau

	* [r2799] configure.in: release 1.3.3
	* [r2798] build/ylwrap: new version
	* [r2796] README: release 1.3.3
	* [r2795] src/pcscd_ccid.rules: remove the sleep since it causes
	  more problems than solutions the sleep occured for any USB device
	  connection.
	* [r2794] README, readers/supported_readers.txt: add Blutronics
	  Bludrive II CCID in supported list
	* [r2793] src/ccid.h, src/ccid_usb.c: add support for Bludrive II
	  CCID
	* [r2792] readers/BludriveII.txt, readers/Makefile.am: add Bludrive
	  II CCID
	* [r2791] src/parse.c: bInterfaceProtocol set to 0 is CCID

2008-02-05  Ludovic Rousseau

	* [r2790] README: add Lexar/Gemalto Smart Enterprise Guardian in
	  the "Should work but untested by me" list

2008-02-04  Ludovic Rousseau

	* [r2789] src/commands.c: CCID_Receive(): the receive buffer must
	  be 4 bytes minimum for ICCD-B
	  
	  Thanks to Martin Rauch for the bug report
	* [r2788] src/ifdhandler.c: on an ICCD device the card is always
	  inserted so no card movement will ever happen: just do nothing in
	  the TAG_IFD_POLLING_THREAD thread
	* [r2786] configure.in: improve configuration display

2008-02-02  Ludovic Rousseau

	* [r2783] src/ifdhandler.c: HAVE_DECL_TAG_IFD_POLLING_THREAD is
	  always defined but is set to 0 or 1

2008-02-01  Ludovic Rousseau

	* [r2782] readers/supported_readers.txt, src/ccid.c, src/ccid.h:
	  add support of Smart Enterprise Guardian
	* [r2781] src/ifdhandler.c: add a prototype for IFDHPolling()
	* [r2777] src/ifdhandler.c: add support of TAG_IFD_POLLING_THREAD
	  using IFDHPolling() to detect asynchronous card movements
	* [r2776] src/ccid_usb.c, src/ccid_usb.h: add InterruptRead() to
	  read the interrupt pipe use by asynchronous card movements

2008-01-29  Ludovic Rousseau

	* [r2774] src/ccid_usb.c: add comments
	* [r2773] configure.in: check for TAG_IFD_POLLING_THREAD in
	  ifdhandler.h
	* [r2772] src/ccid_usb.c: add interrupt end point field in
	  _usbDevice structure
	* [r2771] src/ccid.h, src/ccid_usb.c: add bNumEndpoints field in
	  _ccid_descriptor structure

2008-01-24  Ludovic Rousseau

	* [r2763] src/ccid_usb.c: ReadUSB(): return an error if we get more
	  than 10 duplicate frames error in one read. Avoids an infinite
	  loop with some buggy readers.
	* [r2762] src/commands.c: CCID_Receive(): return an error if we
	  have read less (or more) data than the CCID frame says to contain

2008-01-22  Ludovic Rousseau

	* [r2757] configure.in: version 1.3.2
	* [r2755] README: release 1.3.2
	* [r2754] src/ccid_usb.c, src/ifdhandler.c: add support for Mac OS
	  X Leopard (10.5.1)
	* [r2753] Makefile.am: distribute build files for Mac OS X Leopard
	* [r2752] MacOSX, MacOSX/configure, MacOSX/convert_reader_h.pl,
	  MacOSX/debuglog.h, MacOSX/ifdhandler.h, MacOSX/pcsclite.h,
	  MacOSX/reader.h.in, MacOSX/winscard.h, MacOSX/wintypes.h: build
	  infrastructure for Apple Mac OS X Leopard
	* [r2751] readers/GemCoreSIMPro.txt: do not duplicate the
	  description for each slot

2008-01-18  Ludovic Rousseau

	* [r2746] Makefile.am, bootstrap: add and use bootstrap instead of
	  reconf. reconf does not work on Leopard

2008-01-14  Ludovic Rousseau

	* [r2734] readers/supported_readers.txt: do not use a & (as in
	  "G&D") since Leopard cannot parse it as valid XML

2008-01-08  Ludovic Rousseau

	* [r2725] src/pcscd_ccid.rules: correct comment on sleep: 1s
	  instead of 100ms
	* [r2724] src/commands.c: CCID_Receive(): do not declare a
	  _ccid_descriptor variable for the twin serial (warning: unused
	  variable 'ccid_descriptor')

2008-01-07  Ludovic Rousseau

	* [r2723] src/commands.c: do not add support for ICCD A or B for
	  the serial driver since ControlUSB() is not available with this
	  reader
	* [r2722] Makefile.am: put src as the lastd directory to have the
	  udev message on screen when installing

2007-12-31  Ludovic Rousseau

	* [r2717] src/Makefile.am: force the libccidtwin.so symlink
	  creation to update a previously existing file
	* [r2716] src/Makefile.am: do not include the VERSION number in the
	  created reader.conf file
	* [r2715] src/Makefile.am: create a symlink from libccidtwin.so to
	  libccidtwin.so.VERSION so that the /etc/reader.conf configuration
	  file do not need to edited for each new driver version
	  
	  Closes Debian bug #457657

2007-12-11  Ludovic Rousseau

	* [r2713] src/pcscd_ccid.rules: increase sleep delay from 0.1 to 1
	  second

2007-12-10  Ludovic Rousseau

	* [r2712] src/pcscd_ccid.rules: wait until the field
	  bInterfaceProtocol is created. Should solve the hotplug problem
	  on Ubuntu 7.10
	  
	  Thanks to OpenCT for the code

2007-11-23  Ludovic Rousseau

	* [r2711] readers/GemaltoSmartEnterpriseGuardian.txt,
	  readers/Makefile.am: add Gemalto Smart Enterprise Guardian Secure
	  USB Device

2007-11-16  Ludovic Rousseau

	* [r2699] README: update Reiner-SCT cyberJack pinpad(a) bug
	  description
	* [r2698] README: Reiner-SCT cyberJack pinpad(a) bug is "just" a
	  non-management of time requests
	* [r2697] src/ccid_usb.c: remove Reiner-SCT cyberJack pinpad(a)
	  from bogus firmware list since yhe bug is just a missing
	  management of time requests
	* [r2693] README: update Reiner-SCT bug: only case 1 APDU do not
	  work
	* [r2692] README, configure.in: release 1.3.1
	* [r2691] src/ccid_usb.c: move the readers without a correct
	  firmware together at the end of the list of bogus firmwares
	* [r2690] src/ccid_usb.c: add Reiner-SCT cyberJack pinpad(a) in the
	  list of bogus firmwares
	* [r2689] README: use the complete name for "Reiner-SCT cyberJack
	  pinpad(a)"
	* [r2688] readers/supported_readers.txt: add Reiner-SCT cyberJack
	  pinpad(a) in the bogus section
	* [r2687] readers/supported_readers.txt: create a section "Bogus
	  readers but partly supported" and move the C3PO LTC31 (old model)
	  and ActivCard USB Reader 2.0 in this section

2007-11-15  Ludovic Rousseau

	* [r2686] README: add Reiner SCT in the unsupported list. The
	  reader does not work correctly.
	* [r2685] src/ccid.h, src/ccid_usb.c: add support for Reiner SCT
	* [r2684] readers/Makefile.am, readers/ReinerSCT.txt: add
	  ReinerSCT.txt
	* [r2683] README, readers/supported_readers.txt: add Charismathics
	  token in the "Should work but untested by me" list
	* [r2682] readers/Charismathics.txt, readers/Makefile.am: add
	  Charismathics.txt

2007-11-01  Ludovic Rousseau

	* [r2679] src/parse.c: do not claim/release the device on Mac OS X
	* [r2677] src/parse.c: if usb_claim_interface() fails we ask the
	  user to stop pcscd and retry
	* [r2676] readers/Kobil_EMV_CAP.txt: new firmware
	* [r2675] src/parse.c: claim and release the interface

2007-10-24  Ludovic Rousseau

	* [r2674] README, readers/supported_readers.txt: add Eutron
	  Digipass 860 in the supported list
	* [r2673] readers/Eutron_Digipass_860.txt, readers/Makefile.am: add
	  Eutron Digipass 860
	* [r2672] readers/Eutron_CryptoIdentity.txt: new firmware
	* [r2671] README, readers/supported_readers.txt: add "Eutron Smart
	  Pocket" in the supported list
	* [r2670] readers/Eutron_Smart_Pocket.txt, readers/Makefile.am: add
	  Eutron_Smart_Pocket.txt
	* [r2669] README, readers/supported_readers.txt: add "Kobil EMV CAP
	  - SecOVID Reader III" in the "should work" list
	* [r2668] readers/Kobil_EMV_CAP.txt, readers/Makefile.am: add
	  Kobil_EMV_CAP.txt

2007-10-23  Ludovic Rousseau

	* [r2667] readers/SCR3320.txt, readers/SCR333.txt,
	  readers/SCR3340.txt: firmware update

2007-10-21  Ludovic Rousseau

	* [r2666] readers/SCR331.txt: regenerated on linux
	* [r2665] readers/SCR331.txt: update firmware
	* [r2664] src/ccid_usb.c: get_end_points(): check that dev->config
	  is not NULL before dereferencing dev->config->bNumInterfaces
	  
	  Avoid a crash on Mac OS X

2007-10-16  Ludovic Rousseau

	* [r2656] README, readers/supported_readers.txt: add "Lenovo
	  Integrated Smart Card Reader" in "Should work but untested by me"
	  list
	* [r2655] readers/Lenovo.txt, readers/Makefile.am: add Lenovo
	  Integrated Smart Card Reader

2007-10-15  Ludovic Rousseau

	* [r2653] examples/scardcontrol.c: use SCARD_LEAVE_CARD instead of
	  SCARD_UNPOWER_CARD for SCardReconnect() since SCardReconnect()
	  returns SCARD_W_REMOVED_CARD on Mac OS X 10.4

2007-10-14  Ludovic Rousseau

	* [r2652] readers/SCR3310.txt, readers/SCR3311.txt,
	  readers/SCR335.txt: new firmware version

2007-10-13  Ludovic Rousseau

	* [r2650] src/parse.c: display "Can't find any CCID device. Maybe
	  you must run parse as root?" if appropriate

2007-10-11  Ludovic Rousseau

	* [r2649] readers/GemPCPinpad.txt, readers/GemPCTwin.txt: update
	* [r2648] src/ifdhandler.c: typo in log message

2007-09-29  Ludovic Rousseau

	* [r2632] configure.in:
	  contrib/Kobil_mIDentity_switch/Makefile.am:2: compiling
	  `Kobil_mIDentity_switch.c' with per-target flags requires
	  `AM_PROG_CC_C_O' in `configure.in'

2007-09-28  Ludovic Rousseau

	* [r2631] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c:
	  call usb_detach_kernel_driver_np() only if libusb provides it
	  (Linux only)
	* [r2630] configure.in: check for usb_detach_kernel_driver_np()
	  since only libusb on Linux provides it
	* [r2629] examples/Makefile.am: use $(PTHREAD_CFLAGS) and
	  $(PTHREAD_LIBS) since the thread library must be explicitly used
	  on *BSD
	* [r2628] readers/supported_readers.txt: add Eutron CryptoIdentity
	* [r2627] readers/Eutron_CryptoIdentity.txt, readers/Makefile.am:
	  add Eutron CryptoIdentity (generated under FreeBSD 6.2-STABLE)

2007-09-21  Ludovic Rousseau

	* [r2626] readers/supported_readers.txt: add Giesecke & Devrient
	  CardToken 350 and 550. They were listed in the README, the web
	  site but not in this list.

2007-09-14  Ludovic Rousseau

	* [r2624] configure.in: use PCSC_LIBS instead of LDLIBS in the
	  error message if SCardEstablishContext() is not found

2007-08-21  Ludovic Rousseau

	* [r2617] README, readers/supported_readers.txt: add SafeNet
	  IKey4000 in the "Should work but untested by me" list
	* [r2616] readers/Makefile.am, readers/SafeNet_IKey4000.txt: add
	  SafeNet IKey4000

2007-08-03  Ludovic Rousseau

	* [r2610] README: add Giesecke & Devrient StarSign Card Token 350
	  and 550 in the "Should work but untested by me" list
	* [r2609] src/Makefile.am: DISTCLEANFILES = Info.plist so that make
	  distcheck works
	* [r2608] readers/GnD_StarSignCardToken350.txt,
	  readers/GnD_StarSignCardToken550.txt, readers/Makefile.am: add
	  Giesecke & Devrient StarSign Card Token 350 and 550
	* [r2607] README: add OmniKey CardMan 5321 in the "Should work but
	  untested by me" list
	* [r2606] readers/CardMan5321.txt, readers/Makefile.am,
	  readers/supported_readers.txt: add CardMan5321

2007-08-02  Ludovic Rousseau

	* [r2605] .: update svn:ignore
	* [r2604] README, readers/supported_readers.txt: add O2 Micro Oz776
	  (ProductID 0x7772) to the "Should work but untested by me" list
	* [r2603] readers/Makefile.am, readers/Oz776_7772.txt: add new
	  O2Micro Oz776
	* [r2602] src/ccid.h, src/ccid_usb.c, src/commands.c: add support
	  of the O2Micro oz776 (ProductID 0x7772)

2007-07-05  Ludovic Rousseau

	* [r2599] src/pcscd_ccid.rules: replace BUS by SUBSYSTEMS
	* [r2597] examples/scardcontrol.c: add support for Mac OS X

2007-07-03  Ludovic Rousseau

	* [r2596] src/ccid.c: ccid_error(): increase the size of var_text[]
	  to avoid a buffer overflow
	  
	  Thanks to Anders Storsveen for the bug report

2007-07-02  Ludovic Rousseau

	* [r2593] examples/scardcontrol.c: update version and copyright
	  date
	* [r2592] examples/scardcontrol.c: remove compilation warnings
	* [r2591] examples/scardcontrol.c: do not free() unallocated memory
	* [r2590] examples/scardcontrol.c: use PCSC_ERROR_EXIT() for
	  SCardListReaders() call
	* [r2585] examples/scardcontrol.c: display an explicit message when
	  no card is present
	* [r2584] reconf: update versions of autotools used
	* [r2583] build/ylwrap: regenerated using automake-1.10

2007-06-30  Ludovic Rousseau

	* [r2582] readers/ActivkeySim.txt: update

2007-06-28  Ludovic Rousseau

	* [r2581] src/pcscd_ccid.rules: use DRIVERS== instead of DRIVER==

2007-06-25  Ludovic Rousseau

	* [r2579] README, readers/JCOP41V221.txt,
	  readers/supported_readers.txt: add "Philips Semiconductors
	  JCOP41V221" ICCD card in "Should work but untested by me" list

2007-06-18  Ludovic Rousseau

	* [r2566] readers/Sitecom_MD-010.txt: remove trash at end of file

2007-06-13  Ludovic Rousseau

	* [r2557] src/commands.c: SecurePINVerify(): avoid a possible
	  buffer overflow detected by sparse

2007-05-19  Ludovic Rousseau

	* [r2533] src/Makefile.am: generate a local Info.plist before
	  trying to install it
	* [r2532] src/Info.plist, src/Info.plist.src: rename Info.plist as
	  Info.plist.src since it is just a template

2007-05-10  Ludovic Rousseau

	* [r2526] README: typos
	* [r2524] contrib/RSA_SecurID/RSA_SecurID_getpasswd.1: manpage
	  section is 1 instead of 8
	* [r2522] README, configure.in: release 1.3.0
	* [r2521] README, readers/Makefile.am, readers/e-gate.txt,
	  readers/supported_readers.txt: add SchlumbergerSema Cyberflex
	  Access e-gate in the should work list
	* [r2520]
	  contrib/Kobil_mIDentity_switch/README_Kobil_mIDentity_switch.txt:
	  rename midswitch to Kobil_mIDentity_switch
	* [r2519] examples, src: update svn:ignore properties
	* [r2518] contrib/Kobil_mIDentity_switch, contrib/RSA_SecurID:
	  update snn:ignore properties
	* [r2517] contrib, contrib/Kobil_mIDentity_switch,
	  contrib/RSA_SecurID: set svn:ignore properties
	* [r2516] README, readers/Makefile.am, readers/Sitecom_MD-010.txt,
	  readers/supported_readers.txt: add Sitecom USB simcard reader
	  MD-010 in the "Should work but untested by me" list
	* [r2515] readers/supported_readers.txt: correct KOBIL mIDentity
	  names

2007-05-09  Ludovic Rousseau

	* [r2514] src/pcscd_ccid.rules: exit if ACTION!="add"

2007-05-07  Ludovic Rousseau

	* [r2511] src/commands.c: #include "ccid_usb.h" to avoid
	  commands.c:103: warning: implicit declaration of function
	  'ControlUSB'

2007-05-03  Ludovic Rousseau

	* [r2510] src/ccid_usb.c: get_end_points(): avoid a double free on
	  close for the O2MICRO_OZ776 special case.
	  
	  " In ccid_usb.c you move the extra descriptor from the endpoint 2
	  descriptor to the interface descriptor. The problem is, when
	  libusb try to free the descriptors associated to this device on
	  shutdown or if the device disappears, it tries to free the same
	  buffer twice. For me it means the pcscd is killed with a glibc
	  detected "double free". "
	  
	  Thanks to Michael Wegner for the patch
	* [r2509] README, readers/supported_readers.txt: add OmniKey
	  CardMan 4321 in "Should work but untested by me" list
	* [r2508] readers/CardMan4321.txt, readers/Makefile.am: add
	  CardMan4321.txt

2007-03-28  Ludovic Rousseau

	* [r2498] src/commands.c: define
	  BOGUS_SCM_FIRMWARE_FOR_dwMaxCCIDMessageLength and code to avoid
	  the bogus limitation of dwMaxCCIDMessageLength on SCM firmwares

2007-03-21  Ludovic Rousseau

	* [r2489] src/ccid.c: ccid_open_hack(): add Dutch(nl) and
	  Tukish(tr) messages for the GemPC pinpad

2007-03-20  Ludovic Rousseau

	* [r2488] readers/SCR331-DI.txt, readers/SCR331.txt,
	  readers/SCR3310.txt, readers/SCR3311.txt: firmware updates

2007-03-19  Ludovic Rousseau

	* [r2487] SCARDGETATTRIB.txt: improve documentation of
	  SCARD_ATTR_MAXINPUT

2007-03-15  Ludovic Rousseau

	* [r2485] src/parse.c: if usb_control_msg() fails because the
	  device is busy this is because pcscd has claimed the device
	  already
	* [r2484] README: add Fujitsu Siemens Computers SmartCard Keyboard
	  USB 2A and SmartCard USB 2A to the "Should work but untested by
	  me" list
	* [r2483] readers/FujitsuSiemens_SmartCard_Keyboard_USB_2A.txt,
	  readers/FujitsuSiemens_SmartCard_USB_2A.txt, readers/Makefile.am,
	  readers/supported_readers.txt: add Fujitsu Siemens Computers
	  SmartCard USB 2A and SmartCard Keyboard USB 2A readers

2007-03-13  Ludovic Rousseau

	* [r2480] src/parse.c: use an unsigned char buffer[] to have
	  unsigned multi-bytes convertions

2007-03-12  Ludovic Rousseau

	* [r2473] src/ifdhandler.c: move #include of config.h before
	  pcsclite.h and reader.h

2007-03-08  Ludovic Rousseau

	* [r2472] src/commands.c, src/ifdhandler.c: In case of error set
	  the received length to 0 in IFDHTransmitToICC() and IFDHControl()
	  instead of in all the lower level commands
	* [r2471] src/pcscd_ccid.rules: add SchlumbergerSema Cyberflex
	  Access e-gate ICCD
	* [r2470] src/ccid.c, src/ccid.h, src/ccid_usb.c, src/commands.c:
	  add support of ICCD version A and B
	* [r2469] src/ccid_usb.c: ControlUSB(): add some debug: request
	  value and data send/received
	* [r2468] src/parse.c: bit 0x000800 of dwFeatures is undocumented
	  but used by ICCD?

2007-02-28  Ludovic Rousseau

	* [r2454] readers/supported_readers.txt: differentiate the two
	  KOBIL mIDentity devices (Basic and Classic)
	* [r2453] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c:
	  usb_detach_kernel_driver_np() is not available on libusb for Mac
	  OS X
	* [r2452] configure.in: require autoconf 2.61
	* [r2451] configure.in: check for strlcpy

2007-02-27  Ludovic Rousseau

	* [r2450] contrib/RSA_SecurID/RSA_SecurID_getpasswd.c: small
	  reformat

2007-02-26  Ludovic Rousseau

	* [r2448] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c:
	  replace a C++ comment by a C comment

2007-02-25  Ludovic Rousseau

	* [r2444] contrib/Kobil_mIDentity_switch/Makefile.am,
	  contrib/RSA_SecurID/Makefile.am: EXTRA_DIST = $(doc_DATA)
	  $(man_MANS)
	* [r2443] contrib/RSA_SecurID/Makefile.in: remove from SVN
	* [r2442] src/pcscd_ccid.rules: add rule to call
	  /usr/sbin/Kobil_mIDentity_switch for mIDentity devices
	* [r2441] README: move the Kobil mIDentity from the "Supported" to
	  "Unsupported or partly supported" because of a time request
	  problem
	* [r2440] readers/supported_readers.txt: add (new) KOBIL mIDentity
	* [r2439] contrib/Kobil_mIDentity_switch/Makefile.am: use
	  $(LIBUSB_LIBS) instead of -lusb
	* [r2438] configure.in, contrib/Makefile.am, contrib/RSA_SecurID,
	  contrib/RSA_SecurID/Makefile.am, contrib/RSA_SecurID/Makefile.in,
	  contrib/RSA_SecurID/RSA_SecurID_getpasswd.1,
	  contrib/RSA_SecurID/RSA_SecurID_getpasswd.c: add
	  contrib/RSA_SecurID
	* [r2437] contrib/GPL-2: add GNU GPL v2 licence
	* [r2436] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.8,
	  contrib/Kobil_mIDentity_switch/Makefile.am: add manpage
	  Kobil_mIDentity_switch.8
	* [r2435] contrib/Kobil_mIDentity_switch/Makefile.am: doc_DATA =
	  README_Kobil_mIDentity_switch.txt
	* [r2434] contrib/Kobil_mIDentity_switch/README.txt,
	  contrib/Kobil_mIDentity_switch/README_Kobil_mIDentity_switch.txt:
	  rename README.txt in README_Kobil_mIDentity_switch.txt
	* [r2433] contrib/Kobil_mIDentity_switch/Kobil_mIDentity_switch.c,
	  contrib/Kobil_mIDentity_switch/Makefile.am,
	  contrib/Kobil_mIDentity_switch/midswitch.c: rename midswitch{.c,}
	  in Kobil_mIDentity_switch{.c,}
	* [r2432] configure.in, contrib/Kobil_mIDentity_switch,
	  contrib/Makefile.am, contrib/midswitch: rename contrib/midswitch/
	  in contrib/Kobil_mIDentity_switch/

2007-02-24  Ludovic Rousseau

	* [r2431] Makefile.am, configure.in, contrib, contrib/Makefile.am,
	  contrib/midswitch, contrib/midswitch/Makefile.am,
	  contrib/midswitch/README.txt, contrib/midswitch/midswitch.c: add
	  contrib/midswitch to activate the CCID reader of the Kobil
	  mIDentity

2007-02-23  Ludovic Rousseau

	* [r2430] src/commands.c: CmdPowerOn() & SecurePINVerify(): rename
	  6 local variables to avoid: warning: declaration of 'cmd' shadows
	  a previous local
	* [r2429] src/parse.c: display the error message if
	  usb_control_msg() fails
	* [r2428] src/parse.c: do not declare another buffer variable to
	  avoid: declaration of ‘buffer’ shadows a previous local
	* [r2427] src/ccid_usb.h: allow multiple inclusion using #ifndef
	  __CCID_USB_H__ ...
	* [r2426] src/ccid_usb.c: get_end_points(): change parameter name
	  from usb_device to usbdevice to avoid: warning: declaration of
	  'usb_device' shadows a global declaration /usr/include/usb.h:329:
	  warning: shadowed declaration is here
	* [r2425] src/ccid_usb.c: ControlUSB(): explicit cast to avoid
	  warning: pointer targets in passing argument 6 of
	  'usb_control_msg' differ in signedness
	* [r2424] src/ccid_usb.c: get_data_rates(): use ControlUSB()
	  instead of usb_control_msg()
	* [r2423] src/ccid_usb.c, src/ccid_usb.h: add ControlUSB()
	  declaration and implementation
	* [r2422] examples/scardcontrol.c: remove a redundant declaration
	  of i scardcontrol.c:486: attention : declaration of ‘i’ shadows a
	  previous local

2007-02-22  Ludovic Rousseau

	* [r2421] src/commands.c: CmdXfrBlockTPDU_T0(): set *rx_length to 0
	  in case of command too long
	* [r2420] src/commands.c: CmdXfrBlockTPDU_T0(): set *rx_length to 0
	  if CCID_Transmit() fails

2007-02-20  Ludovic Rousseau

	* [r2407] examples/scardcontrol.c: Secure modify PIN: add a
	  bConfirmPIN and bNumberMessage table
	* [r2406] src/commands.c: SecurePINModify(): set bNumberMessages in
	  all cases
	* [r2405] examples/scardcontrol.c: set max pin size to 8 instead of
	  4
	* [r2404] src/commands.c: SecurePINModify(): the GemPC Twin does
	  support different values of bNumberMessages but all the
	  bMsgIndex? must be present in the CCID command

2007-02-17  Ludovic Rousseau

	* [r2399] src/ifdhandler.c: IFDHControl(): log the Rx and Rx
	  buffers
	* [r2398] src/debug.h: add DEBUG_INFO_XXD()

2007-02-10  Ludovic Rousseau

	* [r2393] src/ccid_usb.c: get_end_points(): correct bug in revision
	  2392
	* [r2392] src/ccid_usb.c: get_end_points(): use
	  usb_interface->altsetting->bNumEndpoints instead of the hardcoded
	  value 3

2007-02-08  Ludovic Rousseau

	* [r2391] src/pcscd_ccid.rules: use ATTRS{} instead of SYSFS{} for
	  use with recent udev versions
	* [r2390] src/parse.c: parse bInterfaceProtocol field
	* [r2389] src/parse.c: parse bNumEndpoints field

2007-02-05  Ludovic Rousseau

	* [r2387] Makefile.am: ChangeLog: use svn2cl instead of svn2cl.sh

2007-01-30  Ludovic Rousseau

	* [r2366] src/ccid.c: ccid_open_hack(): add the l10n of the 10th
	  string "PIN blocked"
	* [r2365] src/ccid.c: ccid_open_hack(): add portugese strings for
	  the GemPC Pinpad.
	  
	  Thanks to Stef Hoeben

2007-01-27  Ludovic Rousseau

	* [r2363] README, configure.in: release 1.2.1
	* [r2362] README: move the O2Micro Oz7762 from the unsupported to
	  the supported list since patches to support it are applied by
	  default (O2MICRO_OZ776_PATCH)
	* [r2361] src/pcscd_ccid.rules: add non CCID generic
	  (InterfaceClass: 0xFF) readers
	* [r2360] readers/Makefile.am, readers/SK-3106.txt: SK-3106.txt is
	  a duplicate of DellSK-3106.txt
	* [r2359] src/ccid_usb.c: Bogus_firmwares[]: the driver now
	  contains patches to circumvent the Oz776 reader. It is then
	  declared bogus only if O2MICRO_OZ776_PATCH is not defined
	* [r2358] src/commands.c: T0ProcACK(): use a hack to circumvent the
	  Oz776 firmware bug with commands of size modulo 64

2007-01-26  Ludovic Rousseau

	* [r2357] src/commands.c: CmdGetSlotStatus(): the O2MICRO OZ 776
	  reader sends "card absent or mute" errors when no card is
	  inserted. We do not log this error since it is normal execution
	  and just fill the syslog files
	* [r2356] src/ccid.h, src/ccid_usb.c: move #define
	  O2MICRO_OZ776_PATCH from ccid_usb.c to ccid.h so we can use it in
	  other .c files

2007-01-24  Ludovic Rousseau

	* [r2355] INSTALL: document how to use --enable-udev on FreeBSD.
	  
	  Thanks to Tilman Linneweh

2007-01-20  Ludovic Rousseau

	* [r2351] README: version 1.2.0 was released in 2007 not 2006 :-)

2007-01-19  Ludovic Rousseau

	* [r2345] README, configure.in: release 1.2.0
	* [r2342] config.h.in: removed since generated from configure.in by
	  autoheader

2007-01-18  Ludovic Rousseau

	* [r2338] INSTALL: document udev use
	* [r2337] INSTALL: pcsc-lite versions before 1.3.3 are not
	  supported so remove notes about CHANNELID
	* [r2336] INSTALL: add #CCID_compliant URL refenrece when a reader
	  is not yet supported

2007-01-10  Ludovic Rousseau

	* [r2329] src/Makefile.am: do not install the pcscd_ccid.rules file
	  but display a message telling so. The exact location of this file
	  is Linux distribution dependent.
	  
	  Thanks to Alon Bar-Lev for the idea.
	* [r2328] src/parse.c: typo: "busses" -> "buses"
	  
	  Thanks to Martin Paljak for the patch
	* [r2326] src/parse.c: add a missing \n in printf

2007-01-09  Ludovic Rousseau

	* [r2322] src/Makefile.am: use 60-pcscd_ccid.rules instead of
	  50-pcscd_ccid.rules so udev default > rules will run before are
	  run before this one.
	  
	  Thanks to Alon Bar-Lev.

2007-01-08  Ludovic Rousseau

	* [r2318] src/Makefile.am: add pcscd_ccid.rules in EXTRA_DIST
	  
	  Thanks to Kjell M. Myksvoll for the bug report

2007-01-06  Ludovic Rousseau

	* [r2317] Makefile.am: add SCARDGETATTRIB.txt to EXTRA_DIST
	* [r2316] examples/scardcontrol.c: use LPSTR instead or the
	  deprecated LPTSTR
	* [r2315] src/Makefile.am: if --enable-udev is used we define
	  IFD_GENERATE_HOTPLUG in ifdCapabilities and install the
	  pcscd_ccid.rules for udev
	* [r2314] src/create_Info_plist.pl: replace MAGIC_IFDCAPABILITIES
	  by the 3rd command line argument
	* [r2313] src/Info.plist: use MAGIC_IFDCAPABILITIES
	* [r2312] configure.in: add --enable-udev
	* [r2311] src/pcscd_ccid.rules: udev file for hotplug capability

2007-01-04  Ludovic Rousseau

	* [r2298] README: add "HP USB Smartcard Reader" in the "Should work
	  but untested by me" list
	* [r2297] readers/HPUSBSmartCardReader.txt,
	  readers/supported_readers.txt: add HP USB Smartcard Reader

2007-01-02  Ludovic Rousseau

	* [r2296] src/ccid_usb.c: CloseUSB(): free .dirname and .filename
	  only for the last slot
	* [r2295] src/ccid_usb.c: OpenUSBByName(): move the "Checking
	  device: " log message out of the usbDevice[] loop since we
	  display info of the new device and not of a device from
	  usbDevice[]
	* [r2294] src/ccid_usb.c: struct _usbDevice: replace struct
	  usb_device *dev; by char *dirname; and char *filename; since the
	  libusb structure can be modified at any time by libusb (this
	  structure is reused for another USB device when the USB device is
	  removed)
	* [r2293] src/ccid_usb.c: get_data_rates() now has a struct
	  usb_device *dev parameter to avoid storing it in struct
	  _usbDevice
	* [r2292] src/ccid_usb.c, src/ccid_usb.h: remove unused get_desc()
	  function
	* [r2291] src/ccid_usb.c: revert revisions 2289 and 2290
	  
	  It is not the correct solution to the problem
	* [r2290] src/ccid_usb.c: WriteUSB()/ReadUSB(): check that the
	  device entry is still valid before using it
	* [r2289] src/ccid_usb.c: WriteUSB()/ReadUSB(): call CloseUSB() as
	  soon as the device disapears (ENODEV) since the libusb structures
	  pointed by usbDevice[] may be reused by another USB device

2006-12-30  Ludovic Rousseau

	* [r2288] configure.in: do not use two AM_CONDITIONAL() with the
	  same variable
	  
	  Thanks to Alon Bar-Lev for the patch
	* [r2287] configure.in: --disable-twinserial now works as expected.
	  
	  Thanks to Alon Bar-Lev for the patch

2006-12-25  Ludovic Rousseau

	* [r2285] src/commands.c: many commands: make sure we received at
	  least STATUS_OFFSET+1 bytes before reading the value of
	  buffer[STATUS_OFFSET]
	  
	  usb_bulk_read() may return 0 bytes instead of an error when the
	  reader is just disconnected
	* [r2280] src/utils.c: GetNewReaderIndex(): check that Lun is NOT
	  already used
	  
	  Thanks to Martin Preuss for the idea

2006-12-20  Ludovic Rousseau

	* [r2278] README: add the OmniKey CardMan 1021 to the "Should work
	  but untested by me" list
	* [r2277] readers/CardMan1021.txt, readers/Makefile.am,
	  readers/supported_readers.txt: add OmniKey CardMan 1021
	* [r2276] readers/CardMan3021.txt: a line was wrapped

2006-12-12  Ludovic Rousseau

	* [r2275] SCARDGETATTRIB.txt: new file

2006-12-11  Ludovic Rousseau

	* [r2271] configure.in: add PKG_PROG_PKG_CONFIG

2006-12-10  Ludovic Rousseau

	* [r2270] INSTALL: add --enable-twinserial to build the serial
	  reader driver

2006-12-05  Ludovic Rousseau

	* [r2269] readers/KAAN_Advanced.txt: upgrade firmware to 1.02
	* [r2268] readers/KAAN_Base.txt: upgrade firmware to 1.02

2006-12-02  Ludovic Rousseau

	* [r2260] src/openct/checksum.c: #include "checksum.h"
	* [r2258] src/ifdhandler.c: warning: initialization discards
	  qualifiers from pointer target type
	* [r2257] src/commands.c: warning: initialization discards
	  qualifiers from pointer target type
	* [r2256] src/parse.c: remove unused argc and argv arguments
	* [r2255] src/ccid.c, src/ccid.h: ccid_error(): "char *file"
	  argument -> "const char *file"
	* [r2254] src/ccid.c: warning: assignment discards qualifiers from
	  pointer target type
	* [r2253] src/ccid_ifdhandler.h: warning: redundant redeclaration
	  of 'LogLevel'

2006-11-30  Ludovic Rousseau

	* [r2252] src/Makefile.am: use $(srcdir)/convert_version.pl
	* [r2251] readers/Makefile.am: change C3PO_LTC32_USBv_old.txt in
	  C3PO_LTC32_USBv2_old.txt

2006-11-29  Ludovic Rousseau

	* [r2240] configure.in: test if IFD_NO_SUCH_DEVICE is defined in
	  ifdhandler.h
	* [r2239] configure.in: use AC_TRY_LINK_FUNC() instead of
	  AC_CHECK_LIB() to not hard code the use of -lpcsclite
	* [r2238] src/Makefile.am: distribute convert_version.pl

2006-11-23  Ludovic Rousseau

	* [r2237] readers/C3PO_KBR36.txt, readers/C3PO_LTC32_USBv2.txt,
	  readers/C3PO_LTC32_USBv2_old.txt, readers/C3PO_TLTC2USB.txt,
	  readers/Makefile.am: add C3PO_* files

2006-11-22  Ludovic Rousseau

	* [r2234] src/parse.c: exit if the command is not run as root and
	  getting iManufacturer fails

2006-11-18  Ludovic Rousseau

	* [r2224] README, readers/supported_readers.txt: add C3PO TLTC2USB,
	  LTC32 USBv2 with keyboard support and KBR36 in the "Should work
	  but untested by me" list

2006-11-17  Ludovic Rousseau

	* [r2223] src/ifdhandler.c: set IFSC in the SetParameters argument
	  for T=1 if TAi (i>2) is present: IFSC
	  
	  Thanks to Stefan Neis for the bug report and patch
	* [r2222] README, readers/Teo.txt, readers/supported_readers.txt:
	  add Teo by Xiring in the supported list
	* [r2221] readers/LTC32.txt, readers/supported_readers.txt: add
	  C3PO LTC32

2006-11-15  Ludovic Rousseau

	* [r2210] configure.in: we need pcsc-lite 1.3.3 since we now use
	  IFD_NO_SUCH_DEVICE
	* [r2208] src/ifdhandler.c: IFDHICCPresence(): return the error
	  code returned by CmdGetSlotStatus() instead of using
	  IFD_COMMUNICATION_ERROR
	* [r2207] src/commands.c: CmdGetSlotStatus(), CCID_Transmit() and
	  CCID_Receive(): return IFD_NO_SUCH_DEVICE if the lower
	  communication layer returns STATUS_NO_SUCH_DEVICE
	* [r2206] src/ccid_usb.c: WriteUSB() & ReadUSB(): return
	  STATUS_NO_SUCH_DEVICE if read() or write() fails with ENODEV
	* [r2205] src/defs.h: add STATUS_NO_SUCH_DEVICE
	* [r2197] src/ifdhandler.c: IFDHGetCapabilities(): add support of
	  SCARD_ATTR_MAXINPUT to get the maximal APDU size
	  (dwMaxCCIDMessageLength -10)

2006-11-06  Ludovic Rousseau

	* [r2195] src/commands.c: SecurePINVerify(): the GemPC Pinpad does
	  not support a bEntryValidationCondition different of 0x02
	  (validation key pressed)

2006-10-13  Ludovic Rousseau

	* [r2186] configure.in, src/Makefile.am: remove unneeded dependency
	  on dl library

2006-09-26  Ludovic Rousseau

	* [r2176] src/ifdhandler.c: IFDHICCPresence(): the patch in
	  revision 2150 was not correct. SCardReconnect(...,
	  SCARD_UNPOWER_CARD, ...) failed since the card was reported as
	  non present after the power off
	* [r2175] src/ifdhandler.c: IFDHPowerICC(): log the action
	  performed (PowerUp, PowerDown, Reset)

2006-09-22  Ludovic Rousseau

	* [r2174] README, readers/CardMan5125.txt,
	  readers/supported_readers.txt: add OmniKey CardMan 5125 in the
	  should work but unsupported list
	* [r2173] README: update OmniKey URLs
	* [r2172] README, readers/supported_readers.txt: move the RSA
	  SID800 in the supported list now that I have a working model
	* [r2171] readers/sid800.txt: update using a new SID800 model.
	  Unfortunately the firmware version has not changed so it is not
	  possible to detect a non working model
	* [r2170] README: add O2Micro Oz7762 in the unsupported list

2006-09-20  Ludovic Rousseau

	* [r2168] src/ifdhandler.c: IFDHGetCapabilities(): add support of
	  SCARD_ATTR_VENDOR_NAME
	* [r2166] src/Makefile.am, src/ifdhandler.c: add support for
	  SCARD_ATTR_VENDOR_IFD_VERSION tag used by SCardGetAttrib()
	* [r2165] src/convert_version.pl: Perl script to convert a version
	  format from "1.2.3-svn-xyz" to "0x01020003"

2006-09-14  Ludovic Rousseau

	* [r2163] README: update OmniKey URLs
	* [r2162] README: the OmniKey 5125 was a 5121
	* [r2161] readers/CardMan5121.txt, readers/CardMan5125.txt,
	  readers/supported_readers.txt: The reader was a 5121 in fact

2006-09-11  Ludovic Rousseau

	* [r2156] configure.in: do not #include the tested .h file since it
	  is already included by the macro. A double inclusion fails with
	  SuSE gcc 4.1.0 with fdopen: Bad file descriptor
	  
	  Thanks to Byron Johnson for the bug report see
	  http://www.mail-archive.com/muscle@lists.musclecard.com/msg05632.html

2006-09-10  Ludovic Rousseau

	* [r2155] README: add a note about Alcor Micro AU9520 firmware 1.01
	  bug (time request not forwarded)
	* [r2154] src/ccid_usb.c: Bogus_firm[]: firmware 1.01 for Alcor
	  AU9520 is bogus. The time request of the card is not forwarded to
	  the host by the reader.
	* [r2153] readers/AU9520.txt: new firmware (1.02)

2006-09-06  Ludovic Rousseau

	* [r2152] src/ccid.c, src/ccid.h, src/ccid_serial.c,
	  src/ccid_usb.c, src/commands.c, src/debug.h, src/defs.h,
	  src/ifdhandler.c, src/openct/proto-t1.c, src/parse.c,
	  src/towitoko/atr.c, src/towitoko/pps.c: remove trailing spaces at
	  end of lines
	* [r2150] src/ifdhandler.c: IFDHICCPresence(): correctly support
	  the removal and insertion between two consecutive
	  IFDHICCPresence() calls

2006-08-11  Ludovic Rousseau

	* [r2135] README, configure.in: release 1.1.0
	* [r2134] configure.in, src/Makefile.am: use ./configure
	  --enable-twinserial to compile and install the the driver for the
	  GemPC Twin serial
	  
	  Thanks to Wolfgang Glas for the idea
	* [r2133] README, readers/CL1356T.txt, readers/Makefile.am: add id3
	  Semiconductors CL1356T in the "should work but unsuported" list
	* [r2132] config.h.in: Regenerate

2006-08-10  Ludovic Rousseau

	* [r2131] README, readers/Makefile.am, readers/iDream.txt: Add
	  iDream (or THRC2002-2) to the "Unsupported or partly supported
	  CCID readers" list.
	  
	  Thanks to Dr Jean-Pierre Szikora for the report

2006-08-09  Ludovic Rousseau

	* [r2130] src/ifdhandler.c: IFDHCreateChannelByName(): add a "warm
	  up" sequence. This sequence is sometimes needed when pcscd is
	  restarted with the reader already connected. We get some
	  "usb_bulk_read: Resource temporarily unavailable" on the first
	  few tries. It is an empirical hack

2006-08-07  Ludovic Rousseau

	* [r2123] src/defs.h: CMD_BUF_SIZE should not include a byte for
	  the cmd. This definition was reused as-is from the ifd-gempc
	  source code.
	  
	  Thanks to Wolfgang Glas for the bug report

2006-08-03  Ludovic Rousseau

	* [r2122] src/ifdhandler.c: IFDHICCPresence(): check the value
	  returned by CmdEscape() in the SCR331-DI contactless reader
	  familly code.
	  
	  Byg detected by using __attribute__((warn_unused_result)) also
	  used as __must_check by the Linux kernel
	* [r2121] src/utils.c, src/utils.h: change the prototype of
	  ReleaseReaderIndex() to return void since he function always
	  returned 0 and the returned value was never checked
	* [r2120] src/commands.c: SecurePINVerify()/SecurePINModify(): the
	  USB timeout shall be greater than the reader timeout so we get
	  the reader answer. I use a margin of 10 seconds.
	  
	  Thanks to Gerald Richter for the bug report

2006-08-01  Ludovic Rousseau

	* [r2119] src/ccid_usb.c: ReadUSB(): check that
	  usbDevice[reader_index].dev->bus is still non-NULL (as we do in
	  WriteUSB()) before dereferencing it in the debug message.
	  
	  Thanks to Michael Wegner for the patch
	* [r2118] configure.in: Exit the ./configure script if some include
	  files are not found
	  
	  Use AC_MSG_ERROR() instead of AC_MSG_WARN()

2006-07-31  Ludovic Rousseau

	* [r2117] config.h.in: regenerate
	* [r2116] configure.in, examples/scardcontrol.c, src/ifdhandler.c:
	  use ntohl/htonl from arpa/inet.h since the tag value for
	  IOCTL_FEATURE_VERIFY_PIN_DIRECT and
	  IOCTL_FEATURE_MODIFY_PIN_DIRECT _shall_ be encoded in big endian
	  as documented in PCSC v2 part 10 ch 2.2 page 2.
	  
	  The applications using this feature shall be updated (to respect
	  the PCSC specification)
	  
	  Thanks to Ulrich Vogl for the bug report

2006-07-12  Ludovic Rousseau

	* [r2110] src/commands.c: CCID_Receive(): check that we received at
	  least enough bytes to test cmd[STATUS_OFFSET].
	  
	  usb_bulk_read() will return 0 bytes without error in case of
	  timeout
	* [r2109] src/ifdhandler.c: use LPSTR instead of LPTSTR
	  (deprecated)
	* [r2108] src/commands.c: SetParameters(): do not fail if the
	  command fails to set a parameter that is not changeable by the
	  CCID

2006-07-11  Ludovic Rousseau

	* [r2107] src/ccid_usb.c: correct a typo in a comment

2006-07-09  Ludovic Rousseau

	* [r2101] README, readers/AU9520.txt,
	  readers/supported_readers.txt: add Alcor Micro AU9520
	* [r2100] README, readers/id3_CL1356D.txt,
	  readers/supported_readers.txt: add id3 Semiconductors CL1356D

2006-07-04  Ludovic Rousseau

	* [r2099] config.h.in: update comment for size_t
	* [r2098] src/commands.c: make pcscd detect a buffer overflow when
	  the receiving buffer is too small instead of silently ignoring
	  the detected problem. This problem only occured with readers
	  supporting Extended APDU.
	* [r2097] src/ccid_usb.c: ReadUSB(): be sure we have read enough
	  bytes before checking for frame detectation

2006-07-03  Ludovic Rousseau

	* [r2096] src/commands.c: CmdXfrBlock(): remove the unused
	  clean_up_and_return goto label
	* [r2095] src/commands.c: CmdXfrBlock(): call
	  CmdXfrBlockAPDU_extended() if the reader supports Extended APDU
	* [r2094] src/commands.c: add CmdXfrBlockAPDU_extended() to support
	  Extended APDU readers
	* [r2093] src/commands.c: CCID_Receive(): return the value of
	  bChainParameter in *chain_parameter
	* [r2092] src/commands.c: CmdXfrBlockTPDU_T1(): also log the length
	  of the reception buffer
	* [r2091] src/commands.c, src/openct/proto-t1.c,
	  src/towitoko/pps.c: use CCID_Receive() with the new API (use NULL
	  as chain_parameter)
	* [r2090] src/commands.c, src/commands.h: CCID_Receive() has a new
	  parameter: chain_parameter
	* [r2089] src/commands.h: add #define CHAIN_PARAMETER_OFFSET
	* [r2088] src/commands.c: move the "command length too big" checks
	  from CmdXfrBlock() to CmdXfrBlockTPDU_T0()
	* [r2087] src/commands.c: CCID_Transmit(): log if the transmit
	  buffer is too big
	* [r2086] src/commands.c: CCID_Receive(): use <= instead of < to
	  detect a reception buffer overrun and log an error if it occurs
	* [r2085] src/ccid.c: ccid_open_hack(): the CL1356D firmware needs
	  some time to initialize. Wait 1 second here
	* [r2084] src/ccid.h: add #define CL1356D
	* [r2083] src/ccid_usb.c: ReadUSB(): detect and ignore duplicated
	  CCID frames

2006-06-30  Ludovic Rousseau

	* [r2082] src/ccid.c: ccid_error(): display the value of the
	  Unknown CCID error code

2006-06-08  Ludovic Rousseau

	* [r2078] configure.in: add support of FreeBSD

2006-05-25  Ludovic Rousseau

	* [r2055] src/Info.plist: update the licence from GPL to LGPL

2006-05-19  Ludovic Rousseau

	* [r2048] src/ccid_usb.c: SCM SPR 532 with firmware < 5.10 has
	  problems
	* [r2047] readers/SPR532.txt: update with firmware 5.10
	* [r2046] src/openct/proto-t1.c: t1_transceive(): add a overrun
	  debug message if we received more bytes than we can store.
	* [r2045] src/openct/proto-t1.c: t1_transceive(): add a debug
	  message if we are in state DEAD. The card must be reset first.

2006-05-16  Ludovic Rousseau

	* [r2044] readers/ActivkeySim.txt, readers/supported_readers.txt:
	  add Actividentity (ActiveCard) Activkey Sim

2006-05-10  Ludovic Rousseau

	* [r2041] src/ccid.h: correct a typo in a comment

2006-05-04  Ludovic Rousseau

	* [r2039] examples/scardcontrol.c: Use a timeout of 0.1 second
	  instead of 0 for waiting characters from the keyboard
	* [r2038] README, readers/supported_readers.txt: add C3PO LTC31
	  (new model, USB product id 0x0006) in the supported list
	* [r2037] README, readers/supported_readers.txt: add "HP USB Smart
	  Card Keyboard" in the "Should work but untested by me:" list
	* [r2036] readers/HPUSBSmartCardKeyboard.txt, readers/Makefile.am:
	  add HPUSBSmartCardKeyboard.txt

2006-05-03  Ludovic Rousseau

	* [r2035] src/ccid.c: ccid_open_hack(): add SCM SCR331-DI-NTTCOM in
	  the list of dual slots contactless readers hack
	* [r2034] README, readers/CardMan3021.txt, readers/Makefile.am: add
	  OmniKey CardMan 3021 in the "Should work but untested by me" list
	* [r2033] readers/LTC31v2.txt, readers/Makefile.am: add LTC31 (new
	  version)
	* [r2032] src/parse.c: I used the MSB instead of LSB in parsing
	  dwSynchProtocols

2006-04-23  Ludovic Rousseau

	* [r2026] COPYING: update the Free Software Foundation postal
	  address

2006-04-22  Ludovic Rousseau

	* [r2022] src/Makefile.am: add $(PROVIDED_BY_PCSC) to
	  libccidtwin_la_SOURCES so that libccidtwin uses its own
	  log_xxd/log_msg when configured with --disable-pcsclite
	* [r2021] src/Makefile.am: add $(TOKEN_PARSER) to
	  libccidtwin_la_SOURCES
	* [r2020] README, configure.in: release 1.0.1

2006-04-20  Ludovic Rousseau

	* [r2019] src/ifdhandler.c: declare the functions to export as
	  EXTERNAL
	* [r2017] readers/ACR38U-CCID.txt, readers/CardMan3121.txt,
	  readers/CryptoIdentity.txt, readers/GemPCKey.txt,
	  readers/GemPCTwin.txt, readers/KAAN_Advanced.txt,
	  readers/KAAN_Base.txt, readers/KAAN_SIM_III.txt,
	  readers/LTC31.txt, readers/MySmartPad.txt, readers/Oz776S.txt,
	  readers/SCR331-DI.txt, readers/SCR331.txt, readers/SCR3310.txt,
	  readers/SCR335.txt, readers/SCR355.txt,
	  readers/SIM_Pocket_Combo.txt, readers/SPR532.txt,
	  readers/Verisign_secure_storage_token.txt, readers/mIDentity.txt,
	  readers/sid800.txt: regenerate using the latest version of parse
	* [r2016] README, readers/CardMan3621.txt, readers/Makefile.am,
	  readers/supported_readers.txt: add OmniKey CardMan 3621 in the
	  "Should work but untested by me" list Thanks to Bruce Stephens.

2006-04-18  Ludovic Rousseau

	* [r2014] src/ccid_usb.c: declare get_ccid_usb_interface() as
	  EXTERNAL since this function is used by src/parse
	* [r2013] src/ifdhandler.c: #include "misc.h" so that ifdhandler.h
	  functions are declared EXTERNAL
	* [r2012] src/Makefile.am: add $(SYMBOL_VISIBILITY) to
	  libccid_la_CFLAGS and libccidtwin_la_CFLAGS
	* [r2011] configure.in: add code to detect the support of
	  -fvisibility=hidden
	* [r2007] src/Makefile.am, src/misc.h, src/parser.h, src/strlcpy.c,
	  src/strlcpycat.h, src/tokenparser.l: use tokenparser.l and
	  parser.h from pcsc-lite (using a symlink in subversion). So we
	  also need strlcpy.c, strlcpycat.h and misc.h
	* [r2006] src/parser.h, src/tokenparser.l: remove
	* [r2005] configure.in, src/Makefile.am: always use our own
	  tokenparser.l even when pcsc-lite is used (do not use
	  LTPBundleFindValueWithKey from pcscd)

2006-04-14  Ludovic Rousseau

	* [r2004] readers/Makefile.am: add SCR3311.txt, SCR355.txt and
	  SDI010.txt
	* [r2003] readers/SDI010.txt, readers/SSI010.txt: rename SSI010.txt
	  in SDI010.txt
	* [r2002] src/ccid_usb.c: firmwares for Athena ASE IIIe USBv2 and
	  ASE IIIe KB USB were bogus.
	* [r2001] readers/Makefile.am: add ASE_IIIe.txt and
	  ASEDrive_IIIe_KB.txt
	* [r2000] README, readers/ASEDrive_IIIe_KB.txt,
	  readers/supported_readers.txt: add Athena ASE IIIe KB USB
	* [r1999] readers/ASE_IIIe.txt: update firmware version

2006-03-28  Ludovic Rousseau

	* [r1986] src/commands.c: SecurePINVerify() and SecurePINModify():
	  Make sure bEntryValidationCondition is valid
	  
	  The Cherry XX44 keyboard smart card reader crashes when a wrong
	  value is used

2006-03-27  Ludovic Rousseau

	* [r1985] examples/scardcontrol.c: Modify PIN: use a for() loop
	  instead of 3 fgets() since we will not read every "PIN" if the
	  command is aborted
	* [r1984] src/commands.c: SecurePINVerify(): debug a debug message.
	  use dw2i(TxBuffer, 15) instead of just the first byte
	  TxBuffer[15]
	* [r1983] src/commands.c: SecurePINModify(): separate the
	  validation test in three different tests and add a debug message
	  for each test
	* [r1982] src/commands.c: SecurePINVerify(): debug a debug message
	  :-)
	* [r1981] src/ccid.h, src/commands.c: SecurePINModify(): circumvent
	  a bug in Cherry XX44 keyboard firmware

2006-03-21  Ludovic Rousseau

	* [r1969] README: add Gemplus GemPC Card in the "supported" list
	* [r1968] README, readers/Makefile.am, readers/Winbond.txt,
	  readers/supported_readers.txt: add Winbond Electronics W81E381
	  chipset
	* [r1951] README: add SCM Micro SDI 010 in the "Should work" list
	* [r1950] readers/SSI010.txt, readers/supported_readers.txt,
	  src/ccid.c, src/ccid.h, src/ifdhandler.c: add support for SCM SDI
	  010 contactless reader
	  
	  thanks to Oleg Makarenko for the patch
	* [r1949] readers/AxaltoV3.txt, readers/Makefile.am: add Axalto
	  Reflex USB V3

2006-03-20  Ludovic Rousseau

	* [r1945] README, readers/supported_readers.txt: add Axalto Reflex
	  USB v3 in the "should work" list
	* [r1944] configure.in: document --disable-multi-thread instead of
	  --enable-multi-thread since safe threading is used by default
	* [r1943] configure.in: document --disable-pcsclite instead of
	  --enable-pcsclite since pcsc-lite is used by default
	* [r1942] configure.in: display the status "use libusb : yes/no"
	  
	  document --disable-libusb instead of --enable-libusb since libusb
	  is used by default.

2006-03-06  Ludovic Rousseau

	* [r1927] src/ccid_usb.h: use #if defined (__USB_H__) || defined
	  (_SYS_USB_LIBUSB_USB_H) instead of #ifdef __USB_H__ to support
	  the Solaris libusb
	  
	  thanks to Iain MacDonnell for the patch
	* [r1926] configure.in: remove CFLAGS="$CFLAGS -Wall" since it is
	  GCC specific
	* [r1925] configure.in: add support of Solaris

2006-03-03  Ludovic Rousseau

	* [r1911] README: release 1.0.0
	* [r1910] configure.in: version 1.0.0
	* [r1909] README: add OmniKey CardMan 3821 and CardMan 6121 in the
	  "Should work but untested by me" list
	* [r1908] readers/CardMan3821.txt, readers/CardMan6121.txt,
	  readers/Makefile.am, readers/supported_readers.txt: add OmniKey
	  CardMan 3821 and CardMan 6121
	* [r1905] README: update the "Debug informations:" chapter. The two
	  options comm and periodic have been swaped
	* [r1904] readers/CherrySmartTerminalST2XXX.txt: new firmware
	  (5.08)

2006-02-28  Ludovic Rousseau

	* [r1903] readers/Makefile.am, readers/SCR333.txt: add SCR333.txt
	* [r1886] src/ifdhandler.c: IFDHSetProtocolParameters(): if the
	  card is in specific mode and request a speed not supported by the
	  reader we return IFD_COMMUNICATION_ERROR instead of
	  IFD_PROTOCOL_NOT_SUPPORTED so that pcsc-lite do not try to talk
	  to the card

2006-02-24  Ludovic Rousseau

	* [r1883] README: add URL for the Cherry SmartTerminal ST2000U

2006-02-21  Ludovic Rousseau

	* [r1876] README: - move the ActivCard USB reader 2.0 from "Should
	  work but untested by me" to "Unsupported or partly supported CCID
	  readers" - add the ActivCard USB reader 3.0 in the "Supported
	  CCID readers" list
	* [r1875] src/ccid_usb.c: the ActivCard V2 is bogus (problem with
	  wMaxPacketSize size frames)
	* [r1874] readers/Makefile.am: distribute ActivCardV2.txt and
	  ActivCardV3.txt
	* [r1873] readers/supported_readers.txt: add ActivCard USB Reader
	  3.0
	* [r1872] readers/ActivCardV2.txt, readers/ActivCardV3.txt: add
	  ActivCard v2 and v3 descriptions
	* [r1870] Makefile.am: correct the Perl regexp in ChangeLog rule
	* [r1869] Makefile.am: add subversion revision in ChangeLog.svn

2006-02-20  Ludovic Rousseau

	* [r1867] readers/Makefile.am: add SCM SCR3320.txt and SCR3340.txt
	* [r1866] readers/SCR3320.txt: add SCM SCR3320 - Smart Card Reader
	* [r1865] readers/SCR3340.txt: add SCR3340 - ExpressCard54 Smart
	  Card Reader

2006-02-07  Ludovic Rousseau

	* [r1864] README, readers/supported_readers.txt: add "SCM SCR 3340
	  ExpressCard54" in the "Should work but untested by me" list
	* [r1863] README: add Gemplus GemPC Express in the "Should work but
	  untested by me" list
	* [r1862] readers/GemPC_Express.txt, readers/Makefile.am,
	  readers/supported_readers.txt: add Gemplus GemPC Express

2006-02-06  Ludovic Rousseau

	* [r1861] readers/supported_readers.txt: rename POS Pro & SIM Pro
	  to a more real name "Gemplus GemCore xxx"
	* [r1860] src/commands.c: SecurePINVerify/SecurePINModify: get the
	  data from a T=1 TPDU block only if the exchange was successful
	  (with special treatment for timeout and cancel cases)
	* [r1859] src/commands.c: SecurePINVerify(): move the prologue
	  filing part to be homogenous with SecurePINModify()
	* [r1858] src/commands.c: SecurePINModify(): add support of T=1
	  cards with TPDU readers
	* [r1857] src/commands.c: SecurePINVerify(): add support of T=1
	  cards with TPDU readers
	* [r1856] src/openct/proto-t1.c, src/openct/proto-t1.h: export
	  t1_build() and some constants
	* [r1855] src/ifdhandler.c: IFDHSetProtocolParameters(): store the
	  card protocol in ccid_desc->cardProtocol
	* [r1854] src/ccid.h: add a cardProtocol field to store the card
	  protocol in use

2006-01-30  Ludovic Rousseau

	* [r1846] configure.in: add support for OpenBSD
	* [r1845] examples/Makefile.am, src/Makefile.am: use $(foo) instead
	  of @foo@ to do not replace the values but the variables
	* [r1842] configure.in: when checking for PCSC exit with en error
	  only if /usr/local/lib/pkgconfig/libpcsclite.pc exists _and_
	  pkg-config is installed

2006-01-25  Ludovic Rousseau

	* [r1841] readers/Makefile.am: add CardMan5125.txt
	* [r1840] README: add OmniKey CardMan 5125 in the "Should work but
	  untested by me" list
	* [r1839] readers/CardMan5125.txt, readers/supported_readers.txt:
	  add OmniKey CardMan 5125

2006-01-24  Ludovic Rousseau

	* [r1834] readers/supported_readers.txt: add SmartEpad
	* [r1833] README: add SmartEpad (v 2.0) in the supported list
	* [r1832] src/ccid.c, src/ccid.h: add support for the SmartEpad (v
	  2.0) reader (MYSMARTPAD)
	* [r1831] readers/Makefile.am: add MySmartPad.txt

2006-01-20  Ludovic Rousseau

	* [r1820] README, readers/SCR3311.txt: move the SCM Micro SCR 3311
	  from the "should work" list to the "supported" list
	* [r1819] src/parse.c: rewrite to scan the devices ourself instead
	  of calling IFDHCreateChannel(). No need to have an updated
	  Info.plist anymore.
	* [r1818] src/ccid_usb.c: get_ccid_usb_interface(): use the same
	  code for a device with 1 or >1 interfaces

2006-01-18  Ludovic Rousseau

	* [r1815] README: add Gemplus GemPC PinPad, Gemplus GemCore POS Pro
	  & Gemplus GemCore SIM Pro
	* [r1814] INSTALL: document the configuration of /etc/reader.conf
	  for a GemPC PinPad, a GemCore POS Pro or a GemCore SIM Pro
	* [r1810] readers/GemCoreSIMPro.txt, readers/Makefile.am: add
	  GemCore SIM Pro
	* [r1809] readers/supported_readers.txt: add GemCore POS Pro &
	  Gemplus SIM Pro --Cette ligne, et les suivantes ci-dessous,
	  seront ignorées--
	  
	  M readers/supported_readers.txt
	* [r1808] src/ccid.h, src/ccid_serial.c, src/ccid_usb.c,
	  src/defs.h, src/reader.conf.in: add support of GemCore SIM Pro
	  and GemCore POS Pro (serial and USB).
	* [r1807] src/ccid_usb.c: CloseUSB(): free the allocated
	  arrayOfSupportedDataRates only for the pimary slot. The other
	  slots of the same reader either point to the same array or point
	  to a statically allocated array.
	* [r1806] src/ifdhandler.c: IFDHSetProtocolParameters(): exit the
	  while if you find a correct speed in the case of a card too fast
	* [r1805] src/ccid.c: ccid_open_hack(): update the spanish PIN Pad
	  string since the number of remaining tries in always displayed at
	  the first character

2006-01-17  Ludovic Rousseau

	* [r1804] src/ccid_usb.c: OpenUSBByName(): check that
	  usbDevice[previous_reader_index].dev is still valid before
	  dereferencing it
	  
	  Thanks to Martin Paljak for the bug report
	* [r1803] src/Makefile.am: use @PTHREAD_CFLAGS@ and @PTHREAD_LIBS@
	* [r1802] configure.in: use LIBS instead of LDLIBS when checking if
	  pcsc-lite is installed
	* [r1801] src/ccid_serial.c: OpenSerialByName(): call CloseSerial()
	  if the "Get firmware" or "Change card movement notification"
	  command failed

2006-01-16  Ludovic Rousseau

	* [r1800] src/commands.c, src/commands.h: SecurePINVerify(): bug
	  circumvention for the GemPC Pinpad (bNumberMessage)

2006-01-12  Ludovic Rousseau

	* [r1799] src/ccid.c: ccid_open_hack(): use { } around DEBUG_COMM()
	  in an if-else since DEBUG_COMM() is not a function but an
	  multi-instruction macro

2006-01-11  Ludovic Rousseau

	* [r1798] readers/GemPCPinpad.txt, readers/supported_readers.txt:
	  add Gemplus GemPC Pinpad
	* [r1797] src/ifdhandler.c: IFDHSetProtocolParameters(): if the
	  card is faster than the reader (TA1=97 for example) we try to use
	  a no so bad speed (corresponding to TA1=96, 95 or 94) instead of
	  the default speed of TA1=11
	* [r1796] src/ccid.c: ccid_open_hack(): load the localisation
	  strings according to LANG environment variable. Languages
	  supported: de, en, es, fr, it
	* [r1795] src/Info.plist, src/ccid.c: move the comment about APDU
	  mode from ccid_open_hack() to Info.plist since it is configured
	  there
	* [r1794] src/ccid.h, src/commands.c: SecurePINModify(): bug
	  circumvention for the GemPC Pinpad
	* [r1793] src/commands.c, src/commands.h: SecurePINModify(): modify
	  the user command to make the SPR 532 and Cherry ST 2000C firmware
	  happy
	* [r1792] src/ccid_usb.c: OpenUSBByName(): use log level INFO
	  instead of CRITICAL to display copyright information
	* [r1791] src/ccid_usb.c: release the allocated ressources only
	  when the last slot of a multi-slot reader is closed
	* [r1790] src/Info.plist, src/ccid.h, src/commands.c,
	  src/commands.h, src/ifdhandler.c: allow to select the power on
	  voltage using Info.plist instead of recompiling the source code

2006-01-03  Ludovic Rousseau

	* [r1789] README, readers/supported_readers.txt: add SCM Micro SCR
	  3311 and 3320 in the "Should work but untested by me" list
	* [r1788] README: add URL for SCM Micro SCR 3310
	* [r1787] README, readers/SCR355.txt,
	  readers/supported_readers.txt: add support for SCM Micro SCR 355

2006-01-02  Ludovic Rousseau

	* [r1785] readers/Makefile.am: use ACR38U-CCID.txt instead of
	  ACR38.txt
	* [r1784] configure.in: use pkg-config for libusb if available

2005-12-14  Ludovic Rousseau

	* [r1782] readers/Verisign_secure_storage_token.txt: update with
	  new ./parse version

2005-12-08  Ludovic Rousseau

	* [r1780] src/ifdhandler.c: typo in a comment
	* [r1779] INSTALL: The GemPC Twin is not the only serial CCID
	  reader

2005-12-07  Ludovic Rousseau

	* [r1778] README, readers/ACR38.txt, readers/ACR38U-CCID.txt,
	  readers/supported_readers.txt: replace ACR 38 by ACR 38U-CCID
	  since they are two different readers

2005-12-01  Ludovic Rousseau

	* [r1776] README, readers/ASE_IIIe.txt,
	  readers/supported_readers.txt: add Athena ASE IIIe USB V2 in
	  "Supported CCID readers" list

2005-11-29  Ludovic Rousseau

	* [r1775] src/ccid_usb.c: OpenUSBByName(): do not (re)set the
	  usbDevice[].ccid.pbSeq field since we just copied the complete
	  structure just before
	* [r1774] src/ifdhandler.c: Avoid a possible division by 0 if f or
	  d parameter is null. This could happen only with non-ISO cards
	  with TA1=0x00 or other undefined values
	* [r1773] src/towitoko/atr.c: add support of non-ISO TA1=0x97 (Di=7
	  is/was RFU)
	* [r1771] examples/scardcontrol.c, src/ccid.c, src/ccid_serial.c,
	  src/commands.c, src/defs.h, src/ifdhandler.c,
	  src/openct/proto-t1.c, src/towitoko/defines.h,
	  src/towitoko/pps.c, src/utils.c: remove PCSC/ from the pcsc-lite
	  #include header files since the PCSC/ part is already given by
	  `pkg-config --cflags libpcsclite`
	* [r1770] configure.in: rewrite the libusb detection code to: - use
	  libusb-config if available - --enable-libusb do not give a path
	  anymore but just a yes/no status. paths/arguments/etc must be
	  given using LIBUSB_CFLAGS and LIBUSB_LIBS - use
	  AC_TRY_LINK_FUNC() instead of AC_CHECK_LIB() so we do not
	  explicitely give the library name. This name should come from
	  LIBUSB_LIBS
	* [r1769] configure.in: in libusb detection code: restore CPPFLAGS
	  to $saved_CPPFLAGS instead of $saved_LIBS
	* [r1768] configure.in: recommand the use of PCSC_CFLAGS=...
	  instead of CFLAGS=... to find the pcsc-lite headers
	* [r1767] configure.in: use $CPPFLAGS instead of $CFLAGS since we
	  only need to set the C preprocessor to find the .h files

2005-11-27  Ludovic Rousseau

	* [r1761] README: release 0.9.4
	* [r1760] readers/MySmartPad.txt: new file for MySMART PAD V2.0
	* [r1759] README: add Cherry SmartTerminal ST2XXX
	* [r1758] readers/Makefile.am: add 3 missing reader descriptions

2005-11-24  Ludovic Rousseau

	* [r1754] configure.in: we need pcsc-lite 1.2.9-beta9 or greater
	* [r1752] src/ifdhandler.c: IFDHGetCapabilities(): use info instead
	  of comm debug level to print the number of slots supported by the
	  reader
	* [r1751] examples/scardcontrol.c: update copyright date
	* [r1750] examples/scardcontrol.c: in Modify PIN command we need to
	  read 3 lines from the keyboard (old, new and confirm PINs)
	* [r1749] examples/scardcontrol.c: use a buffer of 40 instead of 10
	  to reader the keyboard since the PIN may be longer than 8 digits
	* [r1747] src/commands.c: SecurePINVerify()/SecurePINModify(): set
	  the response length to 0 in case of (write) communication error
	* [r1746] src/commands.c: SecurePINModify(): set the response
	  length to 0 in case of error in the command format
	* [r1745] src/ifdhandler.c: IFDHControl(): use
	  sizeof(PCSC_TLV_STRUCTURE) instead of 6
	* [r1743] examples/scardcontrol.c: my check if the applet is
	  present was wrong
	* [r1742] examples/scardcontrol.c: exit if the test applet is not
	  found
	* [r1740] configure.in: do not duplicate the definition of
	  PCSCLITE_HP_DROPDIR in --enable-ccidtwindir since it is already
	  defined in --enable-usbdropdir
	  
	  This prevented the successful execution of ./configure when
	  -pedantic-errors is used
	* [r1739] src/openct/proto-t1.c: t1_xcv(): correct the comment
	  about &rmax
	* [r1738] src/openct/proto-t1.c: t1_xcv(): the second argument of
	  CCID_Receive() is (unsigned int *) so we can't use &rmax since
	  &rmax is a (size_t *) and may not be the same on 64-bits
	  architectures for example (iMac G5) */
	* [r1737] configure.in, src/Makefile.am: tokenparser.l is only
	  needed when pcscd is not used (Solaris). It is not needed on Mac
	  OS X since LTPBundleFindValueWithKey() is provided by pcscd
	* [r1735] configure.in: use libusb-config(1) to get, if possible,
	  correct values for LIBUSB_CFLAGS and LIBUSB_LIBS
	* [r1734] configure.in: replace dnl by #
	* [r1733] configure.in, src/Makefile.am: use
	  LIBUSB_CFLAGS/LIBUSB_LIBS instead of LDFLAGS/CPPFLAGS for libusb
	  configuration

2005-11-22  Ludovic Rousseau

	* [r1730] README: add the "SCM Micro SCR 3310-NTTCOM" in the
	  "Should work but untested by me" list. See
	  http://archives.neohapsis.com/archives/dev/muscle/2005-q4/0217.html
	* [r1729] readers/supported_readers.txt: add SCM SCR 3310 NTTCom.
	  See
	  http://archives.neohapsis.com/archives/dev/muscle/2005-q4/0217.html

2005-11-16  Ludovic Rousseau

	* [r1717] examples/scardcontrol.c: Modify PIN: use a 4 digit PIN so
	  we can test it using the test Java Card applet
	* [r1716] examples/scardcontrol.c: Modify PIN: bInsertionOffsetOld
	  and bInsertionOffsetNew starts from the APDU data (5th byte) and
	  not the APDU start (first byte)
	* [r1715] examples/scardcontrol.c: add a modify PIN dump command
	* [r1714] examples/scardcontrol.c: Modify PIN: add a comment for
	  bNumberMessage
	* [r1713] examples/scardcontrol.c: Modify PIN: use 0x03 for
	  bNumberMessage since the GemPC Pinpad rejects any other valu. The
	  SPR 532 needs 0 here
	* [r1712] examples/scardcontrol.c: verify PIN: use 0x01 for
	  bNumberMessage for the GemPC Pinpad
	* [r1711] examples/scardcontrol.c: verify PIN: use 0x02 (validation
	  key pressed) for bEntryValidationCondition as the GemPC Pinpad
	  rejects any other values

2005-11-15  Ludovic Rousseau

	* [r1705] Makefile.am: use svn2cl.sh instead of rcs2log since we
	  migrated to subversion
	* [r1704] src/commands.c: SecurePINModify(): set the readTimeout to
	  at least 30 seconds since we are not waiting after an APDU but
	  after a human (after the reader in fact).

2005-11-07  Ludovic Rousseau

	* [r1703] src/ccid_serial.c, src/ccid_usb.c: remove #ifdef
	  DEBUG_LEVEL_COMM since DEBUG_LEVEL_COMM is a numeric value and
	  not a compilation flag anymore. Debug is always active and
	  filtered by pcscd.
	* [r1702] src/Info.plist, src/debug.h: exchange COMM and PERIODIC
	  debug values so that all except PERIODIC value is 7

2005-10-30  Ludovic Rousseau

	* [r1701] src/commands.c: SecurePINModify(): correct management of
	  bMsgIndex2 and bMsgIndex3
	* [r1700] src/commands.c: SecurePINModify(): do not copy the
	  ulDataLength field to the CCID frame
	* [r1699] src/ccid.h: #define CHERRYST2000

2005-10-19  Ludovic Rousseau

	* [r1692] readers/SPR532.txt: firmware 5.07
	* [r1691] examples/scardcontrol.c: declare offset, pin_verify and
	  pin_modify variable only if needed

2005-09-27  Ludovic Rousseau

	* [r1677] src/commands.c: CCID_Transmit(): cmd[8-9] is the expected
	  length in character mode only. It shall be 0x0000 for TPDU and
	  short APDU modes.

2005-09-26  Ludovic Rousseau

	* [r1676] examples/scardcontrol.c: use the new HandlerTest applet
	  commands
	* [r1675] src/commands.c: SecurePINVerify(): set the readTimeout to
	  at least 30 seconds since we are not waiting after an APDU but
	  after a human.
	* [r1674] src/ccid.h: _ccid_descriptor.readTimeout is in seconds
	  even for USB. The comment was wrong

2005-09-20  Ludovic Rousseau

	* [r1670] src/commands.c: SecurePINVerify(): update the size of
	  ulDataLength field as defined in PCSCv2 part 10, revision
	  2.01.04, september 2005
	* [r1669] examples/scardcontrol.c: use
	  HOST_TO_CCID_16/HOST_TO_CCID_32

2005-09-05  Ludovic Rousseau

	* [r1641] src/ccid_usb.c: get_data_rates(): check the response size
	  only if bNumDataRatesSupported is non zero
	* [r1640] src/parse.c: if bNumDataRatesSupported is 0 we get the
	  list size from what GET DATA RATES command returns
	  
	  idem for bNumClockSupported
	* [r1639] src/parse.c: do not request data rates if the reader
	  reports it support a 0 length list. Idem for clocks.
	* [r1638] src/parse.c: print bNumClockSupported: as %d and not
	  0x%02X

2005-09-01  Ludovic Rousseau

	* [r1635] examples/scardcontrol.c: also work with T=1 cards
	* [r1634] examples/scardcontrol.c: debug modify PIN test code
	* [r1633] readers/supported_readers.txt: add Cherry ST1044U
	* [r1632] readers/CherrySmartTerminalST2XXX.txt,
	  readers/supported_readers.txt: add Cherry SmartTerminal ST-2XXX
	* [r1631] examples/scardcontrol.c: add sample code to perform
	  FEATURE_VERIFY_PIN_DIRECT and FEATURE_MODIFY_PIN_DIRECT if the
	  reader supports it
	* [r1630] src/ccid_ifdhandler.h, src/commands.c, src/commands.h,
	  src/ifdhandler.c: add support of PC/SC v2 part 10
	  CM_IOCTL_GET_FEATURE_REQUEST add support of
	  FEATURE_VERIFY_PIN_DIRECT and FEATURE_MODIFY_PIN_DIRECT
	  
	  remove support of IOCTL_SMARTCARD_VENDOR_VERIFY_PIN (now
	  obsoleted)

2005-08-25  Ludovic Rousseau

	* [r1626] README: add Cherry ST-1044U in the supported list
	* [r1625] readers/CherryST1044U.txt: new file

2005-08-21  Ludovic Rousseau

	* [r1622] README: move the "Cherry XX44 keyboard" from "should
	  work" to "supported" list

2005-08-16  Ludovic Rousseau

	* [r1619] .cvsignore, aclocal/.cvsignore, build/.cvsignore,
	  examples/.cvsignore, readers/.cvsignore, src/.cvsignore,
	  src/towitoko/.cvsignore: removed since we use SVN and not CVS
	  anymore
	  
	  Thanks to Martin Paljak for the idea

2005-08-13  Ludovic Rousseau

	* [r1614] src/Info.plist: document DRIVER_OPTION_RESET_ON_CLOSE
	* [r1613] src/ccid_usb.c: CloseUSB(): call usb_reset() only if
	  DRIVER_OPTION_RESET_ON_CLOSE is set.
	  
	  The problem was that a device reset also disconnects the keyboard
	  on a keyboard + reader device.
	* [r1612] src/ccid_ifdhandler.h: #define
	  DRIVER_OPTION_RESET_ON_CLOSE

2005-08-11  Ludovic Rousseau

	* [r1610] readers/CherryXX44.txt: update adding clock frequencies
	  and data rates
	* [r1609] src/parse.c: check that we do not receive more data rates
	  anc clock frequencies than the reader supports
	* [r1608] src/ccid_usb.c: get_data_rates(): check that we do not
	  get more data rates than the reader supports

2005-08-03  Ludovic Rousseau

	* [r1600] src/commands.c: CCID_Receive(): log time extension
	  messages at priority COMM instead of CRITICAL.
	  
	  Thanks to Martin Paljak for the patch.

2005-08-02  Ludovic Rousseau

	* [r1585] src/ccid_usb.c: OpenUSBByName(): call usb_close() if the
	  device can't be used

2005-07-04  Ludovic Rousseau

	* [r1570] src/ifdhandler.c: IFDHControl(): having a NULL RxBuffer
	  is not an error since it is enough to send the code in
	  dwControlCode
	  
	  Thanks to Martin Paljak for the patch
	* [r1569] src/ccid_usb.c: OpenUSBByName(): vendorID, productID are
	  unsigned avoids a "comparison between signed and unsigned"
	  warning
	* [r1568] src/ccid.h: struct _ccid_descriptor: dwMaxDataRate is
	  unsigned avoids a "comparison between signed and unsigned"
	  warning
	* [r1567] src/ccid.h: struct _ccid_descriptor:
	  dwMaxCCIDMessageLength is unsigned avoids a "comparison between
	  signed and unsigned" warning
	* [r1566] src/commands.c: CmdPowerOn(): atr_len is unsigned avoids
	  a "comparison between signed and unsigned" warning

2005-06-16  Ludovic Rousseau

	* [r1563] src/parse.c: parse wLcdLayout
	* [r1562] src/parse.c: parse bClassEnveloppe
	* [r1561] src/parse.c: pares bClassGetResponse
	* [r1560] src/parse.c: parse dwSynchProtocols

2005-06-15  Ludovic Rousseau

	* [r1559] src/ifdhandler.c: #include <PCSC/reader.h>
	* [r1558] examples/scardcontrol.c: remove definition of
	  SCARD_CTL_CODE and #include <PCSC/reader.h>
	* [r1557] src/ccid_ifdhandler.h: remove definition of
	  SCARD_CTL_CODE
	* [r1556] configure.in: check the availability of reader.h
	  (provided by pcsc-lite 1.2.9-beta8)
	* [r1555] configure.in: check against pcsc-lite 1.2.9-beta8 instead
	  of beta7

2005-06-04  Ludovic Rousseau

	* [r1547] src/ccid_usb.c: WriteUSB(): do not parse
	  usbDevice[reader_index].dev->bus if it is a NULL pointer (the
	  device has been removed for example)

2005-05-27  Ludovic Rousseau

	* [r1546] README: Add Eutron SIM Pocket Combo and Eutron
	  CryptoIdentity in the supported list
	* [r1545] readers/CryptoIdentity.txt,
	  readers/supported_readers.txt: add Eutron CryptoIdentity

2005-05-20  Ludovic Rousseau

	* [r1523] README: add Verisign Secure Token in the supported list
	* [r1522] README: add RSA SecureID SID800 in the UNsupported list
	* [r1521] README: add Verisign Secure Storage Token in the
	  supported list
	* [r1520] readers/sid800.txt: regenerate using new ./parse

2005-05-05  Ludovic Rousseau

	* [r1514] readers/Makefile.am, readers/SCR331-DI-NTTCom.txt: add
	  SCR331-DI-NTTCom.txt
	* [r1513] readers/Makefile.am: rename KAAN_mIDentity.txt in
	  mIDentity.txt
	* [r1512] readers/ACR38.txt, readers/CardMan3121.txt,
	  readers/GemPCKey.txt, readers/KAAN_Advanced.txt,
	  readers/KAAN_Base.txt, readers/LTC31.txt, readers/Oz776S.txt,
	  readers/SCR331-DI.txt, readers/SCR331.txt, readers/SCR3310.txt,
	  readers/SCR335.txt, readers/SIM_Pocket_Combo.txt,
	  readers/SPR532.txt, readers/mIDentity.txt: regenerate using the
	  latest src/parse program
	* [r1511] src/ifdhandler.c: do not #include <math.h> since we now
	  use +1 instead of ceil() to round the calculated timeouts to the
	  upper integer - we do not need an mathematical exact value. the
	  {usb,serial}read must just not timeout before the reader firmware
	  timeouts - we avoid a dependency/link on the math library
	* [r1510] src/ifdhandler.c: T0_card_timeout(): use intermediate
	  variables EGT, BWT, CWT, etu to improve code readability
	* [r1509] src/ifdhandler.c: T0_card_timeout(): declare EGT, WWT as
	  double instead of int to have some precision We also calculate
	  EGT and WWT in milliseconds instead of seconds

2005-05-04  Ludovic Rousseau

	* [r1508] README, readers/supported_readers.txt: add SCM Micro SCR
	  331-DI NTTCom in the "Should work but untested by me" list
	* [r1507] src/ifdhandler.c: IFDHCreateChannelByName(),
	  T0_card_timeout(), T1_card_timeout(): also include other card
	  parameters (TC1 for T=0, TC1 and CWI for T=1) in the timeout
	  formula
	* [r1506] README, readers/supported_readers.txt: rename "Kobil KAAN
	  mIDentity" in "Kobil mIDentity"
	* [r1505] src/ifdhandler.c: IFDHICCPresence(): add support of
	  SCR331-DI NTTCom
	  
	  Thanks to Takuto Matsuu fro the patch
	* [r1504] src/ccid.h: #define SCR331DINTTCOM 0x04E65120
	* [r1503] readers/supported_readers.txt: add the manufacturer name
	  in the reader name

2005-05-02  Ludovic Rousseau

	* [r1496] src/ccid_serial.c: typo in the data rates list
	* [r1495] src/ifdhandler.c: T0_card_timeout()/T1_card_timeout():
	  use ceil() to round the timeout
	* [r1494] src/ccid.c, src/ccid.h: ccid_error(): function is (const
	  char *) instead of (char *) to avoid a "warning: passing arg 4 of
	  `ccid_error' discards qualifiers from pointer target type" using
	  gcc 3.4
	* [r1493] readers/CherryXX33.txt, readers/DellSCRK.txt,
	  readers/GemPC433_SL.txt, readers/GemPCTwin.txt,
	  readers/KAAN_SIM_III.txt: regenerate using the new parse command
	* [r1492] src/commands.c: CmdEscape(): replay the command if we
	  receive STATUS_COMM_NAK
	* [r1491] src/ccid_serial.c: ReadSerial(): if we get a NAK we
	  return STATUS_COMM_NAK to the above layer to replay the command
	  instead of just restarting the read
	* [r1490] src/defs.h: add STATUS_COMM_NAK
	* [r1489] src/parse.c: display the clock frequencies supported by
	  the reader
	* [r1488] src/parse.c: move the display of supported data rates
	  after printing bNumDataRatesSupported info
	* [r1487] src/ifdhandler.c: IFDHSetProtocolParameters(): check if
	  the baud rate is present in the baud rates list only if the list
	  is present. Otherwise we use the old behavior.
	* [r1486] src/ccid_usb.c: get_data_rates(): if the reader do not
	  support GET DATA RATES we return NULL instead of a manually
	  constructed/fake list
	* [r1485] src/ccid_serial.c, src/ccid_usb.c: Open*ByName():
	  initialise dwMaxDataRate field
	* [r1484] src/ccid.h: add dwMaxDataRate field (again)
	* [r1483] src/ccid_usb.c: get_data_rates(): check that the reader
	  sends a DATA RATES list size multiple of 4 othewise it is an
	  error
	* [r1482] src/parse.c: display the bit value of dwFeatures in the
	  text message
	* [r1481] src/parse.c: test all the 4 bytes of dwFeatures against 0
	  and not just the first one
	* [r1480] src/parse.c: do not display the list returned by GET DATA
	  RATES if the list size is not a multiple of 4 (n % 4 != 0)

2005-04-27  Ludovic Rousseau

	* [r1479] src/ccid_serial.c, src/ccid_usb.c: Open*ByName: do not
	  initialise the now disappeared .dwMaxDataRate field
	* [r1478] src/ccid.h: _ccid_descriptor: remove the now useless
	  dwMaxDataRate field
	* [r1477] src/ifdhandler.c: IFDHSetProtocolParameters(): we do not
	  check if (card_baudrate <= ccid_desc->dwMaxDataRate) since
	  find_baud_rate() will tell us if the speed is supported or not by
	  the reader
	* [r1476] src/ccid_usb.c: get_data_rates(): if the CCID command GET
	  DATA RATES is nto supported the array of supported rates contains
	  only the default and max data rates
	* [r1475] src/ccid_usb.c: get_data_rates(): test if int_array is
	  NULL (and not buffer)
	* [r1474] readers/Makefile.am: add the new or missing readers
	* [r1473] configure.in: version 0.9.4
	* [r1472] src/ccid_serial.c: OpenSerialByName(): inhibit the
	  Plug-n-Play string by setting the RTS signal to low. Mainly
	  useful for the GemPC Card (PCMCIA)
	* [r1471] readers/Verisign_secure_storage_token.txt: Verisign
	  Secure Storage Token
	* [r1470] readers/Verisign_secure_token.txt: Verisign Secure Token
	  (without mass memory)
	* [r1469] readers/supported_readers.txt: add Verisign Secure Token
	  and VeriSign Secure Storage Token
	* [r1468] src/parse.c: display the supported data rates using the
	  CCID command GET DATA RATES
	* [r1467] src/ccid_usb.c: get_data_rates(): use the real interface
	  number instead of 0
	* [r1460] src/ccid_usb.c: get_data_rates(): buffer argument of
	  usb_control_msg is (char *) and not (unsigned char *)
	* [r1459] src/ccid_usb.c: get_data_rates() returns an unsigned int
	  [] (not just int [])
	* [r1458] src/ccid_serial.c: SerialDataRates[] is unsigned

2005-04-26  Ludovic Rousseau

	* [r1454] src/openct/proto-t1.c: t1_xcv(): increase the read
	  timeout if the card sends and WTX request
	* [r1453] src/ccid_serial.c, src/ccid_usb.c: use the calculated
	  read timeout instead of a fixed value
	* [r1452] src/ifdhandler.c: calculate and store the read timeout
	  according to the card ATR instead of using a fixed value of 60
	  seconds
	* [r1451] src/ifdhandler.c: add T0_card_timeout() and
	  T1_card_timeout()
	* [r1450] src/defs.h: /* Default communication read timeout in
	  seconds */ #define DEFAULT_COM_READ_TIMEOUT 2
	* [r1449] src/ccid.h: struct _ccid_descriptor: add unsigned int
	  readTimeout field
	* [r1448] src/ifdhandler.c: IFDHSetProtocolParameters(): only use a
	  data rate supported by the reader in the PPS negociation,
	  otherwise we stay at the default speed.
	* [r1447] src/ccid_serial.c: OpenSerialByName(): the reader does
	  not support the Get Data Rates CCID function so the list of
	  supported data rates is hard coded.
	* [r1446] src/ccid_usb.c: OpenUSBByName(): get the list of data
	  rates the reader supports
	  
	  See 3.7.3 Get Data Rates (page 25) from CCID spec 1.00
	* [r1445] src/ccid.h: struct _ccid_descriptor: add unsigned int
	  *arrayOfSupportedDataRates field
	* [r1444] src/ccid_serial.c: OpenSerialByName(): set card movement
	  notification in synchronous mde
	* [r1443] configure.in: we need pcsc-lite 1.2.9-beta7 and not just
	  beta5 since we use the new log API
	* [r1442] src/ifdhandler.c: extra_egt(): rewrite the function
	  comment
	* [r1441] src/ifdhandler.c: extra_egt(): reuse the same baud rate
	  calculation formula
	* [r1440] src/ifdhandler.c: extra_egt(): change two if() in one
	* [r1439] src/ifdhandler.c: change comments: TBi (i>2) is BWI/CWI
	  not BWI/BCI

2005-04-25  Ludovic Rousseau

	* [r1438] src/ifdhandler.c: extra_egt(): some (bogus) cards require
	  an extra EGT but the ATR does not say so. We try to detect the
	  bogus cards and set TC1=2
	* [r1437] src/ifdhandler.c: light code reformating

2005-04-22  Ludovic Rousseau

	* [r1436] readers/supported_readers.txt: add Eutron SIM Pocket
	  Combo

2005-04-21  Ludovic Rousseau

	* [r1427] src/openct/checksum.c, src/openct/checksum.h,
	  src/openct/proto-t1.h: #include <stdint.h> only if HAVE_STDINT_H
	  is defined. Some old FreeBSD do not have stdint.h.
	  
	  Thanks to Tilman Linneweh for the patch

2005-04-13  Ludovic Rousseau

	* [r1426] readers/SIM_Pocket_Combo.txt: Eutron SIM Pocket Combo
	  (the reader is dual slot and is seen as two readers)
	* [r1425] readers/sid800.txt: RSA SecurID SID800 Hardware
	  Authenticator

2005-04-12  Ludovic Rousseau

	* [r1422] src/Info.plist: "Generic CCID reader" -> "Generic CCID
	  driver"

2005-03-17  Ludovic Rousseau

	* [r1411] src/ccid.c: ccid_error(): use log_msg() instead of
	  debug_msg()
	* [r1410] src/debug.c: change debug_msg() in log_msg() and add the
	  priority argument same for debug_xxd() changed in log_xxd()
	  
	  These functions are only used by the parse command and if the
	  driver is not used with pcsclite
	* [r1409] src/debug.h: use pcsclite debuglog.h header file and use
	  its Log?() macro instead of debug_msg().
	  
	  This adds color to the log messages because Log?() macros use
	  log_msg() instead of the deprecated debug_msg() function.
	* [r1408] src/ifdhandler.c: init_driver(): use DEBUG_INFO2()
	  instead of debug_msg()
	* [r1407] src/tokenparser.l: add "%option nounput" to avoid the
	  compilation warning "`yyunput' defined but not used"
	* [r1406] src/towitoko/atr.c: ATR_GetDefaultProtocol(): the message
	  "no default protocol found in ATR. Using T=0" is not CRITICAL but
	  INFO only
	* [r1405] configure.in: store & restore the value of LIBS around
	  the macro AC_CHECK_LIB(pcsclite,...) to avoid adding an automatic
	  -lpcsclite to LIBS
	* [r1404] configure.in: do not check for SCardEstablishContext is
	  the user does NOT want to use pcsc-lite (with --disable-pcsclite)

2005-03-14  Ludovic Rousseau

	* [r1400] README: release 0.9.3
	* [r1399] COPYING, README, src/ccid.c, src/ccid.h,
	  src/ccid_ifdhandler.h, src/ccid_serial.c, src/ccid_serial.h,
	  src/ccid_usb.c, src/ccid_usb.h, src/commands.c, src/commands.h,
	  src/debug.c, src/debug.h, src/defs.h, src/ifdhandler.c,
	  src/openct/checksum.h, src/openct/proto-t1.h, src/utils.c,
	  src/utils.h: change licence from GNU GPL to GNU LGPL
	* [r1398] configure.in: version 0.9.3

2005-03-04  Ludovic Rousseau

	* [r1397] readers/KAAN_SIM_III.txt, readers/mIDentity.txt: Add KAAN
	  SIM III and KAAN mIDentity
	* [r1396] config.h.in: add HAVE_LIBPCSCLITE
	* [r1395] configure.in: use $PCSC_LIBS instead of $PCSCLITE_LIBS
	  since we used PKG_CHECK_MODULES(PCSC, ...)
	* [r1394] README, readers/supported_readers.txt: add Kobil KAAN
	  mIDentity in supported reader list
	* [r1393] README, readers/supported_readers.txt: add Kobil KAAN SIM
	  III in supported readers list
	* [r1392] README, readers/supported_readers.txt: add SCR 3310
	* [r1391] readers/SCR3310.txt: SCR3310

2005-02-28  Ludovic Rousseau

	* [r1368] src/ifdhandler.c, src/towitoko/atr.c: use ATR_t instead
	  of ATR
	* [r1367] src/towitoko/atr.h: rename ATR struct to ATR_t do not
	  conflict with ATR field defined by PCSC/ifdhandler.h. This allows
	  compilation using tcc (Tiny C Compiler)

2005-02-27  Ludovic Rousseau

	* [r1361] configure.in: check that we can link with libpcsclite
	  needed by examples/scardcontrol.c
	* [r1360] configure.in: exits with an error if usbdropdir is not
	  defined
	* [r1359] configure.in: if /usr/local/lib/pkgconfig/libpcsclite.pc
	  exists (default pcsc-lite configuration) we exit telling the user
	  to use PKG_CONFIG_PATH=/usr/local/lib/pkgconfig ./configure
	* [r1358] configure.in: do not check for pkg-config since we can do
	  without it

2005-02-25  Ludovic Rousseau

	* [r1356] readers/CardMan3121.txt, readers/CherryXX33.txt,
	  readers/CherryXX44.txt, readers/GemPC433_SL.txt,
	  readers/KAAN_Advanced.txt, readers/KAAN_Base.txt,
	  readers/SCR331-DI.txt, readers/SCR331.txt, readers/SCR335.txt,
	  readers/SPR532.txt: typo: correct ICC by CCID where needed
	* [r1355] src/parse.c: typo: used "ICC" instead of "CCID"
	* [r1354] src/ifdhandler.c: IFDHSetProtocolParameters(): return
	  immediately if the reader has the bit CCID_CLASS_AUTO_PPS_PROP
	  set since he will perform PPS and SetParameters himself
	* [r1353] src/ccid.h: #define CCID_CLASS_AUTO_PPS_PROP 0x00000040
	* [r1352] src/ifdhandler.c: IFDHSetProtocolParameters(): calculate
	  the value of pps[2] (TA1) even if CCID_CLASS_AUTO_PPS_CUR bit is
	  set and no PPS will be generated by the driver since this value
	  is also used later by the SetParameters()
	* [r1351] src/ifdhandler.c: IFDHSetProtocolParameters(): use
	  "card_baudrate <= ccid_desc->dwMaxDataRate" instead of
	  "card_baudrate < ccid_desc->dwMaxDataRate" to not miss the
	  maximum speed value
	* [r1350] Makefile.am: we do not need to distribute mkinstalldirs
	* [r1349] configure.in: define WITHOUT_PCSC=false when pcsclite
	  _is_ used

2005-02-23  Ludovic Rousseau

	* [r1346] examples/scardcontrol.c: #include <sys/time.h> instead of
	  <time.h> to get correct definition of struct timeval under Mac OS
	  X
	* [r1343] src/debug.c: if you use --disable-pcsclite and do _not_
	  want to see the logs sent to stderr just #undef LOG_TO_STDERR
	* [r1342] configure.in, src/Makefile.am: if --disable-pcsclite is
	  used we must link the library with debug.c to provide debug_msg()
	* [r1341] examples/Makefile.am: use @PCSC_CFLAGS@ and @PCSC_LIBS@

2005-02-21  Ludovic Rousseau

	* [r1330] src/ccid_serial.c: OpenSerialByName(): use tx_buffer[] =
	  { 0x02 } insead of "\x02" since we want 1 byte only and not a
	  null-terminated string
	* [r1329] src/Makefile.am: use @PCSC_CFLAGS@
	* [r1328] configure.in: use pkg-config(1) to find everything
	  related to pcsc-lite
	  
	  if you installed pcsc-lite in /usr/local you may use $
	  PKG_CONFIG_PATH=/usr/local/lib/pkgconfig ./configure
	  
	  if you do not have pkg-config installed you may use $
	  CFLAGS=-I/usr/local/include/PCSC ./configure

2005-02-20  Ludovic Rousseau

	* [r1327] src/ccid_usb.c: add an "interface field" in _usbDevice.
	  This value is set in OpenUSB() and used in CloseUSB().
	  
	  The struct usb_device structure is half "corrupted" after the USB
	  device is removed and we wanted to use it when when closing the
	  driver after a reader removal. This caused a crash with libusb
	  0.1.10.
	* [r1326] README: add Kobil KAAN Base & KAAN Advanced readers in
	  the supported list
	* [r1325] src/ccid_usb.c: Bogus_firmwares[]: add Kobil KAAN Base &
	  KAAN Advanced readers
	* [r1324] readers/supported_readers.txt: add Kobil KAAN Base & KAAN
	  Advanced readers
	* [r1323] readers/KAAN_Advanced.txt, readers/KAAN_Base.txt:
	  firmware 0.37

2005-02-04  Ludovic Rousseau

	* [r1322] readers/ACR38.txt: new firmware (but still with version
	  1.0) with the wMaxPacketSize bug removed

2005-02-02  Ludovic Rousseau

	* [r1321] README: move the ACR 38 from Unsupported to Supported
	  list

2005-01-26  Ludovic Rousseau

	* [r1319] readers/Makefile.am: add the new or missing readers
	* [r1318] readers/CherryXX44.txt, readers/KAAN_Advanced.txt,
	  readers/KAAN_Base.txt: new readers descriptions

2005-01-20  Ludovic Rousseau

	* [r1317] README: add Cherry XX44 keyboard (SmartBoard G83-6744)
	* [r1316] readers/supported_readers.txt: add Cherry XX44
	  (SmartBoard G83-6744)

2005-01-13  Ludovic Rousseau

	* [r1314] README: move the SCM Micro readers from unsupported to
	  supported list and document how to upgrade the firmwares
	  
	  Thanks to Torsten Maykranz for his support
	* [r1313] readers/SCR335.txt: New model with firmware 5.14 (instead
	  of 4.16)
	* [r1312] src/ccid_usb.c: Bogus_firmwares[]: the 3 SMC readers had
	  the same (cut-n-paste) USB identification
	* [r1311] src/commands.c: CmdXfrBlockCHAR_T0(): move a variable
	  declaration at the beginning of the function since ISO C89
	  forbids mixed declarations and code
	* [r1310] src/commands.c: SecurePIN(): proprietary command to add
	  the PIN code in the APDU without any padding (this is not
	  possible with the CCID specs).
	  
	  Thanks to Martin Paljak for the patch.
	* [r1309] src/ccid.h: define SPR532 USB identification

2005-01-11  Ludovic Rousseau

	* [r1302] configure.in: typo: shat -> what

2005-01-09  Ludovic Rousseau

	* [r1301] src/commands.c: SecurePIN(), CCID_Transmit(),
	  SetParameters(): check that the user provided command is not too
	  large (avoid a possible buffer overflow)
	* [r1300] examples/scardcontrol.c: The APDU now comes _after_ the
	  CCID structure as described the CCID specifications.
	* [r1299] src/commands.c: SecurePIN(): directly use the user buffer
	  passed instead of reversing the APDU/CCID structure. It is now as
	  described in the CCID specifications.
	  
	  Thanks to Martin Paljak. I was wrong.

2004-12-19  Ludovic Rousseau

	* [r1298] src/ccid_usb.c: SPR 532 firmware previous to 5.04 is
	  bogus regarding min/max pin lengths
	* [r1297] readers/SPR532.txt: update with firmware 5.04

2004-10-27  Ludovic Rousseau

	* [r1292] src/ccid_serial.c: OpenSerialByName(): use %s instead of
	  %d for dev_name

2004-10-20  Ludovic Rousseau

	* [r1290] examples/scardcontrol.c: set wPINMaxExtraDigit: set max
	  to 8 (instead of 4) to differentiate it from min (set to 4)
	* [r1289] examples/scardcontrol.c: in wPINMaxExtraDigit the bytes
	  order is max,min and not min,max. The comments were wrong

2004-10-19  Ludovic Rousseau

	* [r1288] readers/supported_readers.txt: add Oz776
	* [r1287] src/Info.plist, src/ccid_ifdhandler.h, src/ccid_usb.c:
	  check firmware version to avoid firmwares with bugs. You can
	  still use a bigus firmware by setting
	  DRIVER_OPTION_USE_BOGUS_FIRMWARE in Info.plist
	* [r1286] src/commands.c, src/commands.h, src/openct/proto-t1.c,
	  src/towitoko/pps.c: Add support of character level communication
	  (CCID_CLASS_CHARACTER).
	  
	  Thanks to Jeffrey Dai

2004-10-14  Ludovic Rousseau

	* [r1285] readers/DellSCRK.txt: add idVendor & idProduct using the
	  new parse command

2004-10-07  Ludovic Rousseau

	* [r1284] readers/Makefile.am: reorganize the list and add
	  Oz776S.txt
	* [r1283] readers/Oz776S.txt: O2Micro Oz776S USB Hub smartcard
	  reader
	* [r1282] readers/SCR331-DI.txt, readers/SCR335.txt,
	  readers/SPR532.txt: add idVendor & idProduct using the new parse
	  command
	* [r1281] src/ccid_usb.c, src/ccid_usb.h: the first argument of
	  get_desc() is lun instead of channel and the function uses
	  LunToReaderIndex() to get the reader index
	* [r1280] src/parse.c: use lun instead of channel as first argument
	  to get_desc() and use the returned value to detect an error
	* [r1279] readers/SCR331.txt: add idVendor & idProduct using the
	  new parse command

2004-10-06  Ludovic Rousseau

	* [r1278] readers/ACR38.txt, readers/CardMan3121.txt,
	  readers/CherryXX33.txt, readers/DellSK-3106.txt,
	  readers/GemPC433_SL.txt, readers/GemPCKey.txt,
	  readers/GemPCTwin.txt, readers/LTC31.txt: add idVendor &
	  idProduct using the new parse command
	* [r1277] src/parse.c: display idVendor and idProduct
	* [r1276] src/parse.c: display USB bcdDevice field. Is it the
	  device firmware release?
	* [r1275] src/parse.c: add support of "Character level exchange"

2004-10-04  Ludovic Rousseau

	* [r1265] configure.in: do not redefine PKG_CONFIG_PATH when
	  checking the pcsc-lite version since the variable is already
	  defined a few lines above

2004-10-03  Ludovic Rousseau

	* [r1263] examples/scardcontrol.c: add "THIS PROGRAM IS NOT
	  DESIGNED AS A TESTING TOOL!

2004-09-30  Ludovic Rousseau

	* [r1261] src/ifdhandler.c: mask bStatus to get the ICC state since
	  bSatus may also indicate an error in b6-b7
	* [r1260] src/ccid.h: #define CCID_CLASS_CHARACTER
	* [r1259] src/ccid.h: define OZ776 USB identification
	* [r1258] src/ccid.h: define CCID_ICC_STATUS_MASK and status states
	* [r1257] src/commands.c: CmdGetSlotStatus(): card absent or mute
	  is not an communication error (even if the CCID command result
	  indicates a command failure)
	* [r1256] src/ccid_usb.c: get_ccid_usb_interface(): the O2Micro
	  OZ776S reader has a wrong USB descriptor. The extra[] field is
	  associated with the last endpoint instead of the main USB
	  descriptor.

2004-09-29  Ludovic Rousseau

	* [r1254] examples/Makefile.am, src/Makefile.am: use @AM_CPPFLAGS@
	  (defined by configure.in) instead of `pkg-config libpcsclite
	  --cflags` since PKG_CONFIG_PATH may not be correct here
	* [r1253] configure.in: define AM_CPPFLAGS=`pkg-config libpcsclite
	  --cflags` here since we also defined/exported a "valid"
	  PKG_CONFIG_PATH
	* [r1252] src/Makefile.am: do not define parse_CFLAGS since
	  AM_CPPFLAGS is already defined with the same value
	* [r1251] configure.in: try to find pkg-config files in
	  /usr/local/lib/pkgconfig since pcsc-lite installs them in this
	  directory by default

2004-09-08  Ludovic Rousseau

	* [r1228] src/ccid.c: ccid_open_hack(): do not use a null
	  terminated C string for the TPDU->APDU switch command since the
	  command is NOT a C string
	* [r1227] src/commands.c: CmdPowerOn(): do not use a null
	  terminated C string for the EMV->ISO switch command since the
	  command is NOT a C string
	* [r1226] src/commands.c: switch the Cherry xx33 reader in ISO mode
	  if power up in EMV mode fails. Thanks to St�phane Durand for the
	  bug report.
	* [r1225] src/ccid.h: #define CHERRYXX33 0x046A0005

2004-09-03  Ludovic Rousseau

	* [r1213] src/ifdhandler.c: IFDHSetProtocolParameters(): return the
	  result value of SetParameters() in case of error instead of
	  always IFD_COMMUNICATION_ERROR.
	  
	  This will allow to return IFD_NOT_SUPPORTED in some cases and
	  avoid a PTS negociation failure (and card ignored) in pcscd.
	* [r1212] src/commands.c: SetParameters(): returns
	  IFD_NOT_SUPPORTED if the CCID error is "command not supported".

2004-08-24  Ludovic Rousseau

	* [r1196] src/ifdhandler.c: IFDHSetProtocolParameters(): the
	  bmTCCKST bits shall be _set_ not cleared
	* [r1195] src/ifdhandler.c: IFDHSetProtocolParameters(): we shall
	  indicate the T=1 checksum used (LRC/CRC) in the SetParameters()
	  command
	* [r1194] src/openct/proto-t1.c: t1_negociate_ifsd: the frame size
	  is 5 only for LRC checksum. The correct size is (4 +
	  t1->rc_bytes)
	* [r1193] src/utils.c: ReleaseReaderIndex: return 0 since the
	  function is not void ()

2004-08-17  Ludovic Rousseau

	* [r1189] src/Info.plist: use the official doctype, public and
	  system ids. Thanks to Ville Skytt� and OpenCT

2004-08-15  Ludovic Rousseau

	* [r1186] README: release 0.9.2
	* [r1185] examples/Makefile.am, src/Makefile.am: use AM_CPPFLAGS =
	  `pkg-config libpcsclite --cflags`
	* [r1184] config.h.in: no need to define HAVE_PCSC_IFDHANDLER_H
	  (the check section changed in configure.in)
	* [r1183] configure.in: use `pkg-config libpcsclite --cflags` to
	  locate ifdhandler.h and do not use PCSC/ifdhandler.h but just
	  ifdhandler.h

2004-08-10  Ludovic Rousseau

	* [r1165] README: place the "Known problems" near the affected
	  reader and not in a independent section for clarification

2004-08-06  Ludovic Rousseau

	* [r1160] src/parse.c: try to IFDHCloseChannel() only if we opened
	  at least one reader
	* [r1157] src/ccid.c: ccid_open_hack(): update the hack for the
	  SCR331-DI contactless now we use multi-slots
	* [r1156] src/ifdhandler.c: IFDHICCPresence(): periodic debug
	  message indicating the card presence/absence
	* [r1155] src/ifdhandler.c: use a much cleaner way to check
	  presence of a contactless card with a multislot SCR331-DI reader
	* [r1154] src/ifdhandler.c: IFDHICCPresence(): call
	  get_ccid_descriptor() on reader_index instead of Lun
	* [r1153] src/ifdhandler.c: FDHGetCapabilities() tag
	  TAG_IFD_SLOT_THREAD_SAFE: Can NOT talk to multiple slots at the
	  same time (at least until it is fully validated)
	* [r1152] src/ifdhandler.c:
	  IFDHCreateChannel()/IFDHCreateChannelByName(): if the OpenPort()
	  call fails we ReleaseReaderIndex() and do not call
	  ccid_open_hack()
	* [r1151] src/ccid_usb.c: for multi-slots readers
	  IFDHCreateChannel*()/OpenUSB is called for each slot. If we are
	  opening a new slot of an already opened reader we reuse the same
	  data (same libusb structures) and share the same pbSeq.
	* [r1150] src/commands.c: use (*ccid_descriptor->pbSeq)++ instead
	  of ccid_descriptor->bSeq++
	* [r1149] src/ccid_serial.c, src/ccid_usb.c: use pbSeq instead of
	  bSeq
	* [r1148] src/ccid.h: replace "unsigned char bSeq" by "unsigned
	  char *pbSeq" so that two slots of a same reader can share the
	  same sequence number
	* [r1147] src/ccid_serial.c: use a dynamic timeout when reading the
	  serial port.
	  
	  The first timeout use when detecting the reader is 2 seconds to
	  not wait too long if no reader is connected. Later timeouts are
	  set to 1 minute to allow long time APDU.

2004-08-04  Ludovic Rousseau

	* [r1146] src/ccid.h, src/ccid_serial.c, src/ccid_usb.c,
	  src/ifdhandler.c: remove defaultFeatures management (was used for
	  SCR331-DI hack)
	* [r1145] src/Makefile.am: add "parse_CFLAGS = `pkg-config
	  libpcsclite --cflags`" so that parse.c can find and use
	  <ifdhandler.h>
	* [r1144] src/parse.c: do not use OpenUSB/CloseUSB but
	  IFDHCreateChannel/IFDHCloseChannel to use the ReaderIndex[]
	  mechanism
	* [r1143] src/utils.c: update copyright date (add 2004)
	* [r1142] src/utils.c: LunToReaderIndex(): debug message when Lun
	  is not found
	* [r1141] src/utils.c: GetNewReaderIndex(): debug message when
	  ReaderIndex[] is full
	* [r1140] src/utils.c: GetNewReaderIndex(): store Lun in the first
	  free ReaderIndex[] entry
	* [r1139] src/towitoko/pps.c: typo: Receivig -> Receiving
	* [r1138] src/towitoko/pps.c: PPS_Exchange(): do not recalculate
	  the PPS length from the received PPS but take it from the number
	  of bytes actually received (it may not be a PPS)

2004-07-28  Ludovic Rousseau

	* [r1107] src/ifdhandler.c: use reader_index instead of lun as
	  reader identification allocate (in IFDHCreateChannel*) and
	  release (in IFDHCloseChannel)
	* [r1106] src/ccid.c, src/ccid.h, src/ccid_ifdhandler.h,
	  src/ccid_serial.c, src/ccid_serial.h, src/ccid_usb.c,
	  src/ccid_usb.h, src/commands.c, src/commands.h: use reader_index
	  instead of lun as reader identification
	* [r1105] src/utils.c, src/utils.h: use a more complex Lun ->
	  reader transformation (Lun>>16) is not usable for multi-slots
	  readers

2004-07-27  Ludovic Rousseau

	* [r1103] src/openct/proto-t1.c: this code fails EMV test 1771-4
	  (should be a residue)

2004-07-26  Ludovic Rousseau

	* [r1102] src/openct/proto-t1.c: - debug some cases - add ISO
	  7816-3 rule number in comments
	* [r1101] src/ccid_serial.c, src/ccid_usb.c: initialise
	  ccid.defaultFeatures field

2004-07-22  Ludovic Rousseau

	* [r1096] configure.in: use pkg-config to test the release version
	  of pcsc-lite

2004-07-21  Ludovic Rousseau

	* [r1095] configure.in: version 0.9.2
	* [r1094] src/ifdhandler.c: hack to support the SCR331-DI
	  contactless interface
	* [r1093] src/ccid.c: ccid_open_hack(): detect and activate the
	  contactless interface of the SCR331-DI
	* [r1092] src/commands.c: use bCurrentSlotIndex as the slot number
	  in the CCID commands (instead of 0)
	* [r1091] src/ccid_serial.c, src/ccid_usb.c: initialise
	  bMaxSlotIndex and ccid.bCurrentSlotIndex fields
	* [r1090] src/ccid.h: add defaultFeatures field for multislot
	  readers with different dwFeatures for each slot.
	* [r1089] src/ccid.h: add SCR331DI identification
	* [r1088] src/ccid.h: add bMaxSlotIndex and bCurrentSlotIndex
	  fields to support multislot readers (one USB device with two or
	  more card readers)

2004-07-20  Ludovic Rousseau

	* [r1087] src/openct/proto-t1.c: remove "|| sent_length" in "if
	  (retries == 0 || sent_length)" since it is an OpenCT code that
	  should not be needed with the new automata.
	* [r1086] src/openct/proto-t1.c: update the copyright, add my name
	  to reflect the same change in OpenCT

2004-07-19  Ludovic Rousseau

	* [r1085] src/ifdhandler.c: update IFDHControl() prototype to
	  replace LPVOID by PUCHAR (prototype changed in
	  pcsc-lite-1.2.9-beta5)
	* [r1084] src/ifdhandler.c, src/openct/proto-t1.c,
	  src/openct/proto-t1.h: BUG: I forgot to initialise the t1.lun
	  field. It failed to work with more than one readers and a T=1
	  card in a TPDU reader.
	* [r1083] src/openct/proto-t1.c: in resync: we set retries = 1
	  since when we return in the loop we have retries--; Without this
	  retries goes negative and the test 'if (retries == 0)' will not
	  become true again before a looooong time.

2004-07-16  Ludovic Rousseau

	* [r1079] src/ccid_usb.c: OpenUSBByName(): use base 0 instead of 16
	  in strtoul() so that you can express the decimal value 15 as: 15
	  (decimal), 0xF (hex) or 017 (octal).
	  
	  It is not really needed since the reader descriptions in
	  Info.plist are all in hex.
	* [r1078] src/ifdhandler.c: init_driver(): use base 0 instead of 16
	  in strtoul() so that you can express the decimal value 15 as: 15
	  (decimal), 0xF (hex) or 017 (octal)
	* [r1077] src/ccid_ifdhandler.h, src/ccid_serial.c, src/ccid_usb.c,
	  src/ifdhandler.c, src/parse.c, src/utils.c: rename
	  PCSCLITE_MAX_READERS in CCID_DRIVER_MAX_READERS
	  
	  This value is not defined by pcsc-lite but is internal to the
	  CCID driver. By default pcsc-lite supports the same number of
	  readers (16).
	* [r1076] src/commands.c: BUG: CmdPowerOn(): use memmove() instead
	  of memcpy() to copy the ATR bytes since the source end
	  destination buffers (with a more than 10 bytes long ATR)
	  overlaps.
	  
	  Bug spotted by splint http://www.splint.org/

2004-07-15  Ludovic Rousseau

	* [r1075] src/openct/proto-t1.h: use "uint8_t *" instead of
	  "unsigned char *" in the prototype of t1_state_t.checksum field.
	* [r1074] src/tokenparser.l: initialise pcDesiredKey to NULL
	  instead of 0
	* [r1073] src/commands.c: BUG in CmdXfrBlockTPDU_T1(): the
	  t1_transceive() returned value was stored in an unsigned int and
	  tested if < 0 (error case). Of course the test was never true.
	* [r1071] src/openct/proto-t1.c: remove a useless break; after a
	  goto;
	* [r1070] src/openct/proto-t1.c, src/openct/proto-t1.h: in
	  t1_transceive() and t1_negociate_ifsd() dad argument is unsigned.
	* [r1069] src/openct/checksum.h: replace "unsigned char *" by
	  "uint8_t *" to use the exact same prototype as in the functions
	  definition
	* [r1068] src/commands.c, src/commands.h: i2dw() is not used
	  outside commands.c so declare it static
	* [r1067] examples/scardcontrol.c: allow splint to continue parsing
	  after use of type fd_set
	* [r1066] src/commands.c, src/commands.h: CmdXfrBlockTPDU_T0() and
	  CmdXfrBlockTPDU_T1() are internal functions so declare them
	  static
	* [r1065] src/towitoko/atr.c: atr tables are internal only so
	  declare them static
	* [r1064] src/openct/proto-t1.c: define internal functions as
	  static
	* [r1063] src/openct/buffer.c, src/openct/buffer.h: remove unused
	  functions

2004-07-10  Ludovic Rousseau

	* [r1062] src/openct/proto-t1.c: change "previous_block[1]" in
	  "previous_block[PCB]"
	* [r1061] src/openct/proto-t1.c: remove unused struct
	  ifd_protocol_ops
	* [r1060] src/openct/proto-t1.c, src/openct/proto-t1.h:
	  IFD_PROTOCOL_MORE -> IFD_PROTOCOL_T1_MORE IFD_PROTOCOL_STATE ->
	  IFD_PROTOCOL_T1_STATE renamed to be in line with OpenCT

2004-07-09  Ludovic Rousseau

	* [r1059] examples/scardcontrol.c, src/ifdhandler.c, src/parse.c:
	  explicitely cast the returned value as (void) if we don't use it
	* [r1058] src/ifdhandler.c: IFDHSetProtocolParameters(): test the
	  return value of SetParameters()
	* [r1057] src/parse.c: ccid_parse_interface_descriptor() is now
	  static
	* [r1056] src/parse.c: make channel variable (unsigned int) instead
	  of (int)
	* [r1055] src/parse.c: include <sys/types.h> so splint can parse
	  the file
	* [r1054] src/ccid_serial.c, src/ccid_usb.c, src/ccid_usb.h: mark
	  potentially null values as /*@null@*/ for splint
	* [r1053] src/ccid_serial.c, src/ccid_usb.c, src/ifdhandler.c,
	  src/openct/proto-t1.c, src/parse.c: mark unused arguments as
	  /*@unused@*/ for splint
	* [r1052] src/ccid_usb.c: include <sys/types.h> so splint can parse
	  the file
	* [r1051] src/ccid.c: the buffer var_text[] was, in fact, used
	  outside its declaration
	* [r1050] src/ccid_serial.c, src/ccid_serial.h: ReadChunk() and
	  get_bytes() are internal use in ccid_serial.c so declare them
	  static
	* [r1049] src/ccid_serial.c, src/ccid_usb.c: lun is (unsigned int)
	  so reader = LunToReaderIndex(lun) is also (unsigned int)
	* [r1048] src/ccid_serial.c: OpenSerialByName(): arguments of
	  CmdEscape() are unsigned
	* [r1047] src/ccid_serial.c: replace "121234" by "123456" to make
	  it more clear it is a memory reservation for 6 characters
	* [r1046] src/ccid_serial.c: remove a unneeded cast in (int)lun
	* [r1045] src/ccid_serial.c: allow splint to continue parsing after
	  use of type fd_set
	* [r1044] src/ccid_serial.c: ReadSerial(): the unknown card
	  movement byte is in "c" not "buffer[3]"
	* [r1043] src/ccid.c, src/ccid.h, src/ccid_ifdhandler.h,
	  src/ccid_serial.c, src/ccid_serial.h, src/ccid_usb.c,
	  src/ccid_usb.h, src/commands.c, src/commands.h, src/ifdhandler.c:
	  lun is (unsigned int) instead of (int)
	  
	  Avoid a warning by splint in #define LunToReaderIndex(Lun)
	  (Lun>>16) Left operand of >> may be negative (int): lun >> 16

2004-07-02  Ludovic Rousseau

	* [r1023] src/Info.plist, src/create_Info_plist.pl: replace VENDOR
	  pattern by MAGIC_VENDOR since we also have a VENDOR in
	  IOCTL_SMARTCARD_VENDOR_IFD_EXCHANGE and then a collision.
	  
	  same change for PRODUCT and FRIENDLYNAME to be homogenous.
	* [r1022] src/ccid_serial.c: OpenSerialByName(): perform a command
	  (get the reader firmware) to be sure a GemPC Twin (serial or
	  pcmcia) reader is connected
	* [r1021] src/openct/README: present where the files come from and
	  what I did

2004-07-01  Ludovic Rousseau

	* [r1019] configure.in: version 0.9.1
	* [r1018] README: release 0.9.1
	* [r1017] src/openct/proto-t1.h: #define IFD_PARITY_ERROR
	* [r1015] README: release 0.9.0

2004-06-30  Ludovic Rousseau

	* [r1014] examples/scardcontrol.c: correct a signedness issue
	* [r1013] src, src/.cvsignore: rename tokenparser_macosx.? in
	  tokenparser_fake.?
	* [r1012] ., .cvsignore: add build-stamp and configure-stamp
	* [r1011] examples, examples/.cvsignore: ignore temporary files
	* [r1010] src/towitoko/COPYING: LGPL licence
	* [r1009] configure.in: version 0.9.0
	* [r1008] src/towitoko/pps.c: PPS_Match() was wrong when the
	  confirmation is shorter than the request
	* [r1007] src/towitoko/pps.c, src/towitoko/pps.h: PPS_Exchange()
	  has a new argument (unsigned char *pps1) which is the PPS1
	  returned by the card (TA1 the card wants to use)
	* [r1006] src/towitoko/pps.c: CCID_Transmit() now uses a 4th
	  argument (unsigned char bBWI)
	* [r1005] src/towitoko/pps.c, src/towitoko/pps.h: move macros
	  PPS_HAS_PPS?() from pps.c to pps.h
	* [r1004] src/towitoko/atr.c, src/towitoko/atr.h: add
	  ATR_GetDefaultProtocol() function
	* [r1003] src/towitoko/atr.c, src/towitoko/atr.h: remove unused
	  functions
	* [r1002] src/towitoko/atr.c: the atr_f_table[] and atr_d_table[]
	  tables were partly wrong
	* [r1001] src/towitoko/README: - update the text - the function
	  ATR_GetDefaultProtocol() is mine (Ludovic Rousseau)
	* [r1000] src/towitoko/defines.h: remove MIN() and MAX()
	  definitions
	* [r999] src/ifdhandler.c: if DEBUG_LEVEL_PERIODIC is not set we
	  temporaily remove DEBUG_LEVEL_COMM in IFDHICCPresence() to avoid
	  having the low level debug every time pcscd test the card
	  presence
	* [r998] src/ifdhandler.c: - removed CardUp() and CardDown() - all
	  the reader initialisation/negotiation is now done in
	  IFDHSetProtocolParameters() (that's why you need
	  pcsc-lite-1.2.9beta3)
	* [r997] src/utils.c: pcsclite.h moved in PCSC/
	* [r996] src/defs.h: the t1 field in struct CCID_DESC changed from
	  Protocol_T1 (towitiko) to t1_state_t (openct)
	* [r995] src/debug.h: we do not need to have PACKAGE defined (I do
	  not remember what it was used for)
	* [r994] src/commands.c: CmdXfrBlockTPDU_T1(): use the T=1 TPDU
	  layer from opensc/ instead of towitoko/
	* [r993] src/commands.c: CCID_Receive() returns IFD_PARITY_ERROR if
	  the error returned by the reader is 0xFD (parity error) and
	  IFD_COMMUNICATION_ERROR otherwise (so that the T=1 TPDU layer can
	  recover the error)
	* [r992] src/commands.c, src/commands.h: CCID_Transmit() now has a
	  new "unsigned char bBWI" argument
	* [r991] src/commands.c: CmdPowerOn(): add a mechanism to allow
	  power on at 1.8V, 3V and then 5V as specified by ISO 7816. We
	  still use 5V for now to avoid problems with non ISO compliant
	  cards
	* [r990] src/commands.c: add __FUNCTION__ as argument to
	  ccid_error()
	* [r989] src/ccid.c, src/ccid.h: ccid_error() now also has a "char
	  *function" argument to log the name of the function in which the
	  error occured
	* [r988] src/Makefile.am: - rename protocol_t1/ in towitoko/ to
	  reflect the project the code comes from - remove the now useless
	  files from towitoko/ and add the files from openct/
	* [r987] src/towitoko/apdu.h, src/towitoko/protocol_t1.c,
	  src/towitoko/protocol_t1.h, src/towitoko/t1_block.c,
	  src/towitoko/t1_block.h: remove these files since I now use the
	  T=1 TPDU code from OpenCT
	* [r986] src/openct, src/openct/LICENSE, src/openct/buffer.c,
	  src/openct/buffer.h, src/openct/checksum.c,
	  src/openct/checksum.h, src/openct/proto-t1.c,
	  src/openct/proto-t1.h: use T=1 TPDU code from the OpenCT project
	  <http://www.opensc.org/>
	  
	  The state automata was greatly improved to manage "all" the
	  possible errors cases.
	* [r985] src/Info.plist: document the possible values for
	  ifdLogLevel and ifdDriverOptions

2004-06-23  Ludovic Rousseau

	* [r972] examples/scardcontrol.c: - send Select DF and Select EF
	  APDU before Verify PIN - read stdin (consume the "*" fake keys)
	  if the pinpad is on a keyboard
	* [r971] configure.in: check for the presence of PCSC/ifdhandler.h
	  instead of ifdhandler.h
	* [r970] config.h.in: HAVE_IFDHANDLER_H is renamed
	  HAVE_PCSC_IFDHANDLER_H
	* [r969] README: add info for: - Cherry XX33 keyboard - Dell
	  keyboard SK-3106 - Dell smart card reader keyboard
	  
	  Move some readers in "Unsupported or partly supported CCID
	  readers:" - C3PO LTC31 - SCM Micro SCR 331 - SCM Micro SCR 335 -
	  SCM Micro SPR 532

2004-06-22  Ludovic Rousseau

	* [r966] Makefile.am: ChangeLog is not a .PHONY target but a real
	  file

2004-06-13  Ludovic Rousseau

	* [r940] examples/scardcontrol.c: use SCARD_PROTOCOL_T0 |
	  SCARD_PROTOCOL_T1 instead of SCARD_PROTOCOL_ANY since it is not
	  defined in Micosoft PC/SC

2004-05-30  Ludovic Rousseau

	* [r910] configure.in: use 'pkg-config libpcsclite
	  --variable=usbdropdir' even if --prefix= is used. You should use
	  --enable-usbdropdir= and --enable-ccidtwindir= to set to
	  different values.

2004-05-26  Ludovic Rousseau

	* [r906] readers/DellSK-3106.txt: Dell keyboard SK-3106
	* [r905] src/commands.c: set *rx_length to 0 when a ReadPort()
	  error is returned. The problem was not solved by ccid_usb.c 1.25.
	* [r904] src/commands.c: bPINOperation is not passed in the user
	  command since the command is "PIN Verification" and nothing else
	* [r903] examples/scardcontrol.c: remove useless bPINOperation

2004-05-25  Ludovic Rousseau

	* [r900] examples/scardcontrol.c, src/ccid.h, src/ccid_serial.c,
	  src/ccid_usb.c, src/ifdhandler.c: add support for
	  SCardGetAttrib(.., IOCTL_SMARTCARD_VENDOR_VERIFY_PIN, ..) to know
	  if the reader supports SCardControl(..,
	  IOCTL_SMARTCARD_VENDOR_VERIFY_PIN, ..)
	* [r896] configure.in: add a --enable-pcsclite option (default yes)
	  so that the driver can be compiled for a different framework (one
	  needing tokenparser.l)
	* [r895] src/ccid_usb.c: set length to 0 when a usb_bulk_read()
	  error is returned
	* [r894] src/Makefile.am: install Info.plist before the lib. This
	  is for my convenience only because of my debug setup.
	* [r893] src/Makefile.am: rename tokenparser_macosx.l into
	  tokenparser_fake.l since it is not MacOSX specific.

2004-05-24  Ludovic Rousseau

	* [r892] examples/scardcontrol.c, src/ccid.c, src/ccid_serial.c,
	  src/ccid_serial.h, src/ccid_usb.c, src/ccid_usb.h,
	  src/commands.c, src/commands.h, src/debug.c, src/ifdhandler.c,
	  src/towitoko/atr.h, src/towitoko/protocol_t1.c: recompile using
	  gcc -pedantic and correct: - some C++ syntax comments - many
	  signedness "problems"
	* [r891] src/ccid_ifdhandler.h, src/commands.c, src/commands.h,
	  src/ifdhandler.c: add support for Secure PIN through
	  SCardControl() (see sample code in examples/)
	* [r890] src/ccid.c: - add some missing error codes - low error
	  values indicate the byte in error in the CCID frame
	* [r889] examples, examples/Makefile.am, examples/scardcontrol.c:
	  add examples for SCardControl IOCTL_SMARTCARD_VENDOR_IFD_EXCHANGE
	  and IOCTL_SMARTCARD_VENDOR_VERIFY_PIN
	* [r888] Makefile.am: add examples in SUBDIRS
	* [r887] configure.in: remove -fno-common from CFLAGS since it
	  is(?) gcc specific
	* [r886] readers/ACR38.txt, readers/supported_readers.txt: add
	  Advanced Card Systems ACR 38
	* [r885] readers/CherryXX33.txt, readers/supported_readers.txt: add
	  Cherry XX33

2004-05-18  Ludovic Rousseau

	* [r882] src/ifdhandler.c: in CardUp():SetParameters() the default
	  TA1 is 0x11

2004-05-17  Ludovic Rousseau

	* [r881] src/Info.plist: add default ifdDriverOptions set to 0x0000
	* [r880] src/ifdhandler.c: - add support of
	  IOCTL_SMARTCARD_VENDOR_IFD_EXCHANGE in IFDHControl() - read
	  ifdDriverOptions from Info.plist to limit the use of
	  IOCTL_SMARTCARD_VENDOR_IFD_EXCHANGE (idea from Peter Williams)
	* [r879] src/ccid.c, src/commands.c: redefined CmdEscape() to pass
	  the CCID message instead of just a tag
	* [r878] src/ccid_usb.c, src/ccid_usb.h: do not export
	  get_end_points() declaration and make the function static
	* [r877] src/Makefile.am, src/ccid_ifdhandler.h, src/ccid_serial.c,
	  src/commands.h, src/defs.h, src/parse.c, src/towitoko/atr.c,
	  src/towitoko/defines.h, src/towitoko/protocol_t1.c, src/utils.c:
	  reorganize header files
	* [r876] config.h.in, configure.in: check for pcsclite.h and
	  ifdhandler.h installed by recent pcsc-lite
	* [r875] src/pcscdefines.h: types and definitions are now in
	  <pcsclite.h>, "defs.h" and "ccid_ifdhandler.h"
	* [r874] src/winsmcrd.h: removed since pcsclite.h now defines
	  SCARD_ATTR_*
	* [r873] src/ccid_ifdhandler.h: use the ifdhandler.h provided by
	  pcsc-lite so remove a lot of lines

2004-05-14  Ludovic Rousseau

	* [r872] configure.in: check that pkg-config command is present
	  before using it
	* [r871] INSTALL, configure.in: use `pkg-config libpcsclite
	  --variable=usbdropdir` so you do not have to use
	  --enable-usbdropdir=DIR or --enable-ccidtwindir=DIR even if pcscd
	  does not use the default /usr/local/pcsc/drivers

2004-05-12  Ludovic Rousseau

	* [r863] README: document the libusb bug on MacOS X with
	  unplug/replug in a different USB socket
	* [r862] INSTALL, README: move debug configuration from INSTALL to
	  README since it is dynamic now
	* [r861] README: remove the "readers enumeration" part since this
	  problem is now solved by pcsc-lite-1.2.9
	* [r860] INSTALL: document the use of 'pkg-config libpcsclite
	  --variable=usbdropdir'

2004-05-10  Ludovic Rousseau

	* [r840] src/ifdhandler.c: in IFDHPowerICC() IFD_POWER_DOWN is just
	  power down without a power up. Changed to be compliant with IFD
	  Handler specifications.

2004-05-07  Ludovic Rousseau

	* [r837] src/towitoko/protocol_t1.c: in
	  Protocol_T1_Negociate_IFSD() rename sblock in block since the
	  same variable is used for sent and received block. This was not
	  clear and was the source of reported bug [ #300707 ] "Delete
	  block before using it in t1_protocol.c" which is not a bug in
	  fact.

2004-05-06  Ludovic Rousseau

	* [r836] INSTALL: add a "configuring the driver for the serial
	  reader (GemPC Twin)" part

2004-05-04  Ludovic Rousseau

	* [r825] readers/Makefile.am: add DellSCRK.txt
	* [r824] readers/DellSCRK.txt, readers/supported_readers.txt: add
	  Dell smart card reader keyboard

2004-04-19  Ludovic Rousseau

	* [r808] src/Makefile.am: add winsmcrd.h in COMMON
	* [r807] src/ifdhandler.c: reset ATR string (length = 0) when the
	  card is powered down or not present
	* [r806] src/defs.h: typo in a comment
	* [r805] src/winsmcrd.h: list of tags for SCardGetAttrib() like
	  SCARD_ATTR_ATR_STRING
	* [r804] src/ifdhandler.c: add SCARD_ATTR_ATR_STRING in addition to
	  TAG_IFD_ATR in IFDHGetCapabilities()

2004-04-16  Ludovic Rousseau

	* [r795] src/ifdhandler.c: new IFDHControl() API
	* [r794] src/ccid_ifdhandler.h: use a new version from pcsc-lite
	  with support of the new IFDHControl() API

2004-04-08  Ludovic Rousseau

	* [r781] src/ccid_usb.c: add support for the libusb naming scheme:
	  usb:%04x/%04x:libusb:%s
	* [r780] readers/SK-3106.txt, readers/SPR532.txt: parse bPINSupport
	  field
	* [r779] src/parse.c: parse bPINSupport field

2004-04-07  Ludovic Rousseau

	* [r778] readers/Makefile.am: also distribute SK-3106.txt

2004-04-06  Ludovic Rousseau

	* [r777] config.h.in, configure.in: remove --enable-debugcritical,
	  --enable-debuginfo, --enable-debugperiodic and --enable-debugcomm
	  options since the log level is now dynamically managed by
	  ifdLogLevel in Info.plist
	* [r776] src/Info.plist: define default ifdLogLevel at 3
	  (DEBUG_LEVEL_CRITICAL | DEBUG_LEVEL_INFO)
	* [r775] src/debug.c: remove now useless #ifdef DEBUG
	* [r774] src/ccid_serial.c, src/ccid_usb.c: add { } to avoid
	  ambiguities now that DEBUG_* are "if (x) y" constructions
	* [r773] src/ifdhandler.c: during the first IFDHCreateChannel*()
	  init_debug() is called to read the value of ifdLogLevel from the
	  Info.plist
	* [r772] src/debug.h: change the DEBUG_* macros from static
	  (compilation conditional) to dynamic (if ())
	* [r771] src/Makefile.am: debug.c is only needed by parse_SOURCES
	  not COMMON
	* [r770] src/ifdhandler.c: do not return before
	  pthread_mutex_unlock() in IFDHCreateChannelByName()
	* [r769] src/ifdhandler.c: also call ccid_open_hack() in
	  IFDHCreateChannelByName()
	* [r768] src/ifdhandler.c: T=1 context is initialized in CardUp(),
	  not in IFDHCreateChannel()
	* [r766] src/ifdhandler.c: revert to nearly previous version. -
	  IFD_POWER_DOWN is power down and power up (cold reset) -
	  IFD_RESET is power up (warm reset) - IFD_POWER_UP is power up

2004-04-05  Ludovic Rousseau

	* [r764] configure.in: version 0.4.2
	* [r763] readers/SK-3106.txt, readers/supported_readers.txt: add
	  support for the Dell keyboard SK-3106
	* [r762] src/ccid_usb.c: define ALLOW_PROPRIETARY_CLASS by default
	  
	  Proprietary USB Class (0xFF) are (or are not) accepted A
	  proprietary class is used for devices released before the final
	  CCID specifications were ready. We should not have problems with
	  non CCID devices becasue the Manufacturer and Product ID are also
	  used to identify the device */

2004-03-31  Ludovic Rousseau

	* [r755] src/Makefile.am: use $(srcdir) instead of ".". Thanks to
	  Dr Russel Winder for the patch.

2004-03-30  Ludovic Rousseau

	* [r738] src/ccid_usb.c: allow proprietary CCID Class byte but only
	  if ALLOW_PROPRIETARY_CLASS is defined. You should know what you
	  do. Only useful for pre-CCID devices.
	* [r737] src/parse.c: - use get_ccid_usb_interface() to also manage
	  USB composite devices (keyboards) - continue parsing even if
	  bDescriptorType == 0xFF (proprietary)
	* [r736] src/ccid_usb.h: define get_ccid_usb_interface() only if
	  __USB_H__ is defined (usb.h included)

2004-03-23  Ludovic Rousseau

	* [r723] reconf: move the "cp aclocal.m4 build/" after autoreconf

2004-03-22  Ludovic Rousseau

	* [r722] reconf: cp aclocal.m4 build/

2004-03-18  Ludovic Rousseau

	* [r716] src/ifdhandler.c: Reset action is power off and power on,
	  not just power on

2004-02-27  Ludovic Rousseau

	* [r709] README: add C3PO LTC32, SCM Micro SCR 333 and C3PO
	  TLTC2USB in the list of "Should work but untested by me" readers
	* [r708] README: alphabetical reordering of readers
	* [r707] readers/supported_readers.txt: add SCR 333

2004-02-24  Ludovic Rousseau

	* [r706] Makefile.am: use a shorter Perl script to convert
	  generate/convert ChangeLog

2004-02-14  Ludovic Rousseau

	* [r703] README: release 0.4.1
	* [r702] configure.in: version 0.4.1
	* [r701] readers/Makefile.am: distribute SCR331-DI.txt and
	  supported_readers.txt
	* [r700] src/Makefile.am: disribute create_Info_plist.pl

2004-02-13  Ludovic Rousseau

	* [r698] configure.in: version 0.4.0
	* [r697] README: release 0.4.0

2004-02-12  Ludovic Rousseau

	* [r696] src/ifdhandler.c: huge rework of CardUp()
	* [r695] src/towitoko/protocol_t1.c: return with a error if the
	  received bloc in less than 4 bytes (T=0 error response for
	  example)
	* [r694] src/ccid_serial.c, src/ccid_usb.c: fill dwDefaultClock and
	  dwMaxDataRate according to the reader descriptor
	* [r693] src/ccid.h: add dwDefaultClock and dwMaxDataRate fields

2004-02-11  Ludovic Rousseau

	* [r692] src/ifdhandler.c: Perform PPS and IFSD only if the reader
	  does not do it automatically
	* [r691] src/ccid.h: add CCID_CLASS_AUTO_BAUD and
	  CCID_CLASS_AUTO_IFSD
	* [r690] src/towitoko/protocol_t1.c: add return code tests in
	  Protocol_T1_Negociate_IFSD()
	* [r689] src/towitoko/pps.c, src/towitoko/pps.h: PPS_Exchange() now
	  uses 'int lun' instead of 'Protocol_T1 * t1'
	* [r688] src/towitoko/protocol_t1.c: remove debug message
	* [r687] src/ifdhandler.c: use Protocol_T1_Negociate_IFSD() in
	  CardUp()
	* [r686] src/towitoko/protocol_t1.c, src/towitoko/protocol_t1.h:
	  add Protocol_T1_Negociate_IFSD()
	* [r685] src/ccid.h: add CCID_CLASS_AUTO_CONF_ATR

2004-02-09  Ludovic Rousseau

	* [r683] src/ccid_usb.c: first bSeq is 0 (even if 1 works ok)
	* [r682] src/ccid_usb.c: usb_reset() the device before usb_close()

2004-02-05  Ludovic Rousseau

	* [r677] README: add Silitek SK-3105 keyboard URL

2004-02-04  Ludovic Rousseau

	* [r676] src/debug.h: DEBUG_COMM4 was named DEBUG_COMM3 due to
	  cut-n-paste

2004-02-03  Ludovic Rousseau

	* [r673] src/ccid_ifdhandler.h, src/ifdhandler.c: add CardUp() and
	  CardDown() for PowerOn and PowerOff actions
	* [r672] src/ccid.h, src/ccid_serial.c, src/ccid_usb.c: add
	  dwMaxIFSD field
	* [r671] src/debug.h: add DEBUG_COMM3()
	* [r670] src/towitoko/pps.c, src/towitoko/protocol_t1.c,
	  src/towitoko/t1_block.c: use my own debug routines
	* [r669] readers/SCR331-DI.txt: new file

2004-02-02  Ludovic Rousseau

	* [r668] src/towitoko/protocol_t1.c: do not restrict ifsc to
	  Towitoko
	* [r667] src/towitoko/protocol_t1.c: remove PPS hack
	* [r666] README: add SCR 331-DI in the "should work" list
	* [r665] readers/supported_readers.txt, src/Info.plist,
	  src/Makefile.am, src/create_Info_plist.pl: use
	  create_Info_plist.pl to generate the installed Info.plist from an
	  Info.plist template and a list of supported readers.

2004-01-29  Ludovic Rousseau

	* [r663] src/ifdhandler.c: removed useless function name in debug
	  messages since we use __FUNCTION__
	* [r662] src/ccid_usb.c: - remove device_name[] from struct
	  _usbDevice - use naming scheme usb:vendor/product - simplify (a
	  bit) the code
	* [r661] src/ccid_usb.h, src/parse.c: remore *device_name[]
	  argument from get_desc()
	* [r660] src/debug.h: add DEBUG_CRITICAL4

2004-01-27  Ludovic Rousseau

	* [r659] src/commands.c: set received size to 0 in case of error in
	  CmdXfrBlockTPDU_T1
	* [r658] src/commands.c: in case of error exits CCID_Receive()
	  without copying an nonexistent anwser
	* [r655] src/ccid_usb.c: use DEBUG_CRITICAL2() instead of
	  DEBUG_CRITICAL()
	* [r654] README: add the "Silitek SK-3105 keyboard" in the "Should
	  work but untested by me" list
	* [r653] ., .cvsignore, aclocal, aclocal/.cvsignore, build,
	  build/.cvsignore, readers, readers/.cvsignore: ignore some build
	  files
	* [r652] src, src/.cvsignore, src/towitoko,
	  src/towitoko/.cvsignore: ignore some build files
	* [r651] src/Info.plist: add Silitek SK-3105 keyboard
	* [r650] src/ccid_usb.c, src/ccid_usb.h: add support of USB devices
	  with multiple interfaces (like the Silitek SK-3105 keyboard)
	* [r649] src/ccid_serial.c, src/ccid_serial.h, src/ccid_usb.c,
	  src/ccid_usb.h, src/defs.h, src/ifdhandler.c: add support of
	  IFDHCreateChannelByName

2004-01-22  Ludovic Rousseau

	* [r641] src/Makefile.am: move rules for src/protocol_t1/ files in
	  src/Makefile.am to avoid building a (problematic) static library
	* [r640] src/towitoko/Makefile.am: removed since rules for
	  src/protocol_t1/ files are in src/Makefile.am

2004-01-15  Ludovic Rousseau

	* [r620] src/towitoko/apdu.h: define APDU_Cmd and APDU_Rsp
	* [r619] src/towitoko, src/towitoko/Makefile.am,
	  src/towitoko/README, src/towitoko/atr.c, src/towitoko/atr.h,
	  src/towitoko/defines.h, src/towitoko/pps.c, src/towitoko/pps.h,
	  src/towitoko/protocol_t1.c, src/towitoko/protocol_t1.h,
	  src/towitoko/t1_block.c, src/towitoko/t1_block.h: new files from
	  Carlos Prados towitoko-2.0.7 driver (with a bit of hacking)
	* [r618] src/Makefile.am: build protocol_t1 library
	* [r617] src/commands.c: add SetParameters() CCID command
	* [r616] src/ifdhandler.c: add support of T=1 in TPDU mode
	* [r615] src/defs.h: add CcidDesc.t1 field
	* [r614] src/commands.c, src/commands.h: replace CmdXfrBlockTPDU()
	  by CmdXfrBlockTPDU_T0() and CmdXfrBlockTPDU_T1()
	* [r613] src/commands.c: split CmdXfrBlockShortAPDU() in
	  CCID_Transmit() and CCID_Receive()
	* [r612] src/ccid_serial.c, src/ccid_usb.c, src/ifdhandler.c: call
	  ccid_open_hack() in IFDHCreateChannel() instead of in each
	  OpenPort()
	* [r611] src/ccid.c, src/commands.c, src/commands.h,
	  src/ifdhandler.c: use an (int *) instead of a PDWORD for
	  rx_length argument
	* [r610] aclocal, aclocal/Makefile.am, aclocal/acx_pthread.m4: new
	  files. add definition of ACX_PTHREAD macro
	* [r609] src/ccid_ifdhandler.h, src/ifdhandler.c: add
	  get_ccid_slot() function
	* [r608] src/ccid_serial.c, src/ccid_usb.c, src/ifdhandler.c:
	  remove function name from debug message since __FUNCTION__ is now
	  used in DEBUG_* macro definition
	* [r607] src/Info.plist: add ActivCard
	* [r606] README: created an "Should work but untested by me"
	  section and add SCM Micro SPR 532 and ActivCard USB reader 2.0

2004-01-08  Ludovic Rousseau

	* [r584] README: The crashes under MacOS X were not because of a
	  bug in libusb but because of a bug in pcscd MacOS X hotplug.

2004-01-06  Ludovic Rousseau

	* [r581] src/ccid_usb.c: the USB extra field length shall be
	  exactly 54 bytes to be CCID.

2004-01-05  Ludovic Rousseau

	* [r580] src/debug.h: also print the function name (__FUNCTION__)
	  in the debug messages
	* [r579] src/ccid_usb.c, src/parse.c: add a test on the USB extra
	  field length to avoid a crash and print an error message. This
	  occurs when the reader is _not_ CCID and the CCID driver is used
	  (wrong Info.plist for example).

2003-12-19  Ludovic Rousseau

	* [r578] INSTALL, src/Makefile.am: build but do not install the
	  serial ccidtwin driver by default since it is useless on
	  computers without a serial port or without this reader for
	  example.

2003-12-16  Ludovic Rousseau

	* [r570] src/ccid_usb.c: read and write timeouts are not symmetric.
	  write timout can be shorter since the reader and card is not
	  supposed to do anything before receiving (write) a command.

2003-12-12  Ludovic Rousseau

	* [r569] src/ifdhandler.c: return IFD_NOT_SUPPORTED instead of
	  IFD_SUCCESS in functions doing nothing (yet)
	  (IFDHSetCapabilities, IFDHSetProtocolParameters, IFDHControl);

2003-12-11  Ludovic Rousseau

	* [r568] src/ifdhandler.c: set the result buffer length to 0 in
	  IFDHControl()

2003-11-25  Ludovic Rousseau

	* [r565] configure.in: do not try to find usb.h and other libusb
	  files if --disable-libusb is used. Needed if you only want to
	  build the serial driver. Thanks to Niki Waibel for the patch.
	* [r564] INSTALL, configure.in, src/Makefile.am: add a
	  --enable-ccidtwindir argument to ./configure to specify the
	  serial GemPC Twin installation directory
	* [r563] Makefile.am, config.h.in, configure.in, reconf,
	  src/ifdhandler.c: use a updated version of acx_pthread.m4 needed
	  for FreeBSD

2003-11-06  Ludovic Rousseau

	* [r556] configure.in: check that the installed libusb implements
	  usb_get_string_simple()

2003-11-04  Ludovic Rousseau

	* [r553] README: add SPR 532 in "Supported CCID readers" list
	* [r552] README: release 0.3.2
	* [r551] configure.in: version 0.3.2
	* [r550] src/commands.c: comment out the automatic GET RESPONSE
	  part. I don't think it should be in the driver. Maybe in pcscd
	  instead?

2003-11-03  Ludovic Rousseau

	* [r547] readers/Makefile.am: also distribute SPR532.txt

2003-11-01  Ludovic Rousseau

	* [r545] Makefile.am: bootstrap is no more distributed (it is no
	  more in CVS either)
	* [r544] src/Makefile.am: $(CCID_BUNDLE) is a directory so use 'rm
	  -r' in uninstall_ccid: target

2003-10-31  Ludovic Rousseau

	* [r543] src/Makefile.am: modify the hack to compile under MacOSX.
	* [r542] reconf: config.guess, config.sub, depcomp and ltmain.sh
	  are in build/ so removed them there.
	* [r541] create_distrib.sh: useless since we have a 'make dist'
	  rule

2003-10-29  Ludovic Rousseau

	* [r531] src/Info.plist: add USB identification for SPR 532
	* [r530] readers/SPR532.txt: add SPR 532 description even if it is
	  not a "real" CCID reader.
	* [r529] src/parse.c: continue parsing even if bInterfaceSubClass
	  and bInterfaceProtocol are unsupported. This may be the case with
	  non "real" CCID readers.
	* [r528] src/parse.c: do not exit if the InterfaceClass is 0xFF
	  (proprietary). It is the case with old readers manufactured
	  before the final release of the CCID specs.

2003-10-28  Ludovic Rousseau

	* [r525] src/ccid_usb.c: correctly use the device name in a debug
	  message instead of a not yet initialised field.
	* [r524] bootstrap: removed since ./reconf is doing a correct job
	* [r523] README: move LTC31 reader from unsupported to supported
	  reader list. It was my fault since in used odd INS byte in my
	  test applet and odd INS bytes are forbidden by ISO 7816-4 ch.
	  5.4.2 Instruction byte. Thanks to Josep Mon�s Teixidor for
	  pointing the problem.
	* [r522] src/commands.c: correct a stupid bug that occurs with an
	  APDU with 2 bytes response.

2003-09-23  Ludovic Rousseau

	* [r467] README: release 0.3.1
	* [r466] MANIFEST: update file list
	* [r465] README: add a note about T=1 cards and readers in TPDU
	  mode

2003-09-22  Ludovic Rousseau

	* [r464] src/ccid_ifdhandler.h: define TAG_IFD_THREAD_SAFE
	  introduced in pcsclite-1.2.0-rc3
	* [r463] src/ifdhandler.c: add support of thread safe (APDU
	  multiplexing on different readers)
	* [r462] src/ccid_serial.c: ReadChunk() realy reads up to
	  min_length bytes. Add some debug messages in the state automata.
	* [r461] src/Makefile.am: modify install rules so that root can use
	  them even over NFS where root is nobody
	* [r460] config.h.in, configure.in: add --enable-multi-thread for
	  thread safe support
	* [r459] Makefile.am, reconf: add reconf file

2003-09-19  Ludovic Rousseau

	* [r453] src/ccid_serial.c, src/ccid_serial.h: complete
	  reimplementation of the Twin serial protocol using a finite state
	  automata (code much simpler)

2003-09-16  Ludovic Rousseau

	* [r448] configure.in: Put back AC_PROG_CPP, it has nothing to do
	  with C++ but with C preprocessor
	* [r445] src/ccid.c: Do not switch to APDU mode since it also
	  swicth in EMV mode and may not work with non EMV cards
	* [r444] src/Makefile.am: honor DESTDIR in install rules (closes [
	  #300110 ])
	* [r443] configure.in: remove useless AC_PROG_CPP (no C++ code in
	  ccid driver)
	* [r438] configure.in: version 0.3.1
	* [r437] INSTALL: document the use of --enable-libusb=PATH
	* [r436] configure.in: add --enable-libusb=PATH option

2003-09-10  Ludovic Rousseau

	* [r425] README: I forgot to add "support of "time request" from
	  the card."
	* [r423] README: release 0.3.0
	* [r422] INSTALL: document the use of ./configure script
	* [r421] Makefile.am: use ChangeLog instead of ChangeLog.cvs since
	  the dist Makefile target is looking at this file name.
	* [r420] src/config.h: config.h is now generated by ./configure
	* [r418] Makefile.am, configure.in, readers/Makefile.am: add
	  readers/ in generated .tar.gz archive
	* [r417] readers/CardMan3121.txt, readers/GemPC433_SL.txt,
	  readers/GemPCKey.txt, readers/GemPCTwin.txt, readers/LTC31.txt,
	  readers/SCR331.txt, readers/SCR335.txt: use new parse indentation
	  for more readability of supported features
	* [r415] config.h.in: new build process using autoconf/automake
	* [r414] src/ccid_serial.c, src/ccid_serial.h: manage serial
	  protocol used by the GemPC Twin. Thanks to Niki W. Waibel for a
	  working prototype.
	* [r413] src/ccid.c, src/ccid.h: contains common CCID feature for
	  USB and serial (was in ccid_usb before)
	* [r412] src/reader.conf.in: used to generate a correct reader.conf
	  with the real library name
	* [r411] src/ccid_ifdhandler.h: remove IFDSetEmv() definition. It
	  is now useless.
	* [r410] src/ifdhandler.c: use OpenPort instead of OpenUSB. move
	  the complex TPDU management in commands.c (and use it only if
	  reader does not support APDU mode)
	* [r409] src/defs.h: transport abstraction: define OpenPort,
	  ClosePort, etc. to OpenSerial or OpenUSB depending on TWIN_SERIAL
	  compilation option
	* [r408] src/debug.h: test for PACKAGE and not __CONFIG_H__ since
	  the config.h file is not generated by ./configure
	* [r407] src/commands.c, src/commands.h: - support auto voltage at
	  power on if reader support it - support Gemplus proprietary
	  command to switch reader from TPDU to APDU mode - use APDU mode
	  if reader support it. make it easy to support extended APDU but I
	  have no reader to test this.
	* [r406] src/ccid_usb.c, src/ccid_usb.h: redesign to separate
	  communication media and CCID protocol. call ccid_open_hack() upon
	  open to do some reader dependent magic.
	* [r405] src/parse.c: indent the output with one feature per line
	  (and not on the same line separated by ,)
	* [r404] Makefile, src/Makefile, src/check, src/ylwrap: new build
	  process using autoconf/automake
	* [r403] src/pcscdefines.h, src/utils.c: use PCSCLITE_MAX_READERS
	  instead of PCSCLITE_MAX_CHANNELS
	* [r402] Makefile.am, NEWS, bootstrap, build, build/ylwrap,
	  configure.in, src/Makefile.am: new build process using
	  autoconf/automake

2003-08-27  Ludovic Rousseau

	* [r343] MANIFEST, src/Makefile, src/capabilities.c: remove unused
	  capabilities.c file

2003-08-26  Ludovic Rousseau

	* [r342] README: release 0.2.0
	* [r341] create_distrib.sh: script to create the .tar.gz
	* [r340] README: add a note about libusb problem under *BSD
	* [r339] src/check: require pcsc-lite 1.2.0 instead of 1.1.2
	* [r326] README: the reader enumeration problem also exist under
	  GNU/Linux (is not MacOS specific)

2003-08-24  Ludovic Rousseau

	* [r322] MANIFEST: remove src/dep_stamp
	* [r321] README: add not about bugs/limitations under MacOS X

2003-08-21  Ludovic Rousseau

	* [r314] src/parse.c: do not print garbage if we can't get the
	  iManufacturer or iProduct fields

2003-08-20  Ludovic Rousseau

	* [r309] src/config.h: comment low level debug messages
	* [r308] src/Makefile: use ./ylwrap instead of ylwrap
	* [r306] src/check: do not define LDFLAGS since we get it from
	  outside
	* [r305] src/Makefile: add needed MacOS X frameworks to LDFLAGS
	  (for parse and check)
	* [r304] MANIFEST: add src/ylwrap
	* [r303] src/ylwrap: wrapper to call (f)lex
	* [r302] MANIFEST: src/parse shall not be distributed
	* [r301] src/ccid_usb.c: do not duplicate the Info.plist filename
	  but "calculate" it once
	* [r300] src/Makefile: Add support of MacOS X
	* [r299] src/Info.plist: use an <array></array> for the alias
	  enumeration

2003-08-14  Ludovic Rousseau

	* [r279] src/ccid_usb.c: use a 1 minute USB timeout instead of the
	  1 second used for debug
	* [r278] MANIFEST: include in CVS
	* [r277] src/Makefile: remove parse binary in clean target

2003-08-13  Ludovic Rousseau

	* [r276] src/Makefile: do not exit with failure if makedepend(1)
	  does not exist
	* [r275] INSTALL: Installation and check guide

2003-08-12  Ludovic Rousseau

	* [r273] README: release 0.1.0
	* [r269] ., AUTHORS, COPYING, Makefile, README, readers,
	  readers/CardMan3121.txt, readers/GemPC433_SL.txt,
	  readers/GemPCKey.txt, readers/GemPCTwin.txt, readers/LTC31.txt,
	  readers/SCR331.txt, readers/SCR335.txt, src, src/.dependencies,
	  src/Info.plist, src/Makefile, src/capabilities.c,
	  src/ccid_ifdhandler.h, src/ccid_usb.c, src/ccid_usb.h, src/check,
	  src/commands.c, src/commands.h, src/config.h, src/debug.c,
	  src/debug.h, src/defs.h, src/ifdhandler.c, src/parse.c,
	  src/parser.h, src/pcscdefines.h, src/tokenparser.l, src/utils.c,
	  src/utils.h: Initial revision

